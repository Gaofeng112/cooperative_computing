2024-07-29 19:38:47.465726: I tensorflow/core/util/port.cc:110] oneDNN custom operations are on. You may see slightly different numerical results due to floating-point round-off errors from different computation orders. To turn them off, set the environment variable `TF_ENABLE_ONEDNN_OPTS=0`.
2024-07-29 19:38:47.512491: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-07-29 19:38:47.878363: I tensorflow/tsl/cuda/cudart_stub.cc:28] Could not find cuda drivers on your machine, GPU will not be used.
2024-07-29 19:38:47.880144: I tensorflow/core/platform/cpu_feature_guard.cc:182] This TensorFlow binary is optimized to use available CPU instructions in performance-critical operations.
To enable the following instructions: AVX2 AVX_VNNI FMA, in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-07-29 19:38:48.792937: W tensorflow/compiler/tf2tensorrt/utils/py_utils.cc:38] TF-TRT Warning: Could not find TensorRT
../Compiler/sg/subgraphs_cpu/cpusubgraph0.onnx
Checking 0/1...
Unsqueeze /time_proj/Unsqueeze
2024-07-29 19:38:50.361641: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2024-07-29 19:38:50.361900: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1960] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
Mul /time_proj/Mul
Sin /time_proj/Sin
Cos /time_proj/Cos
Concat /time_proj/Concat
Slice /time_proj/Slice
Slice /time_proj/Slice_1
Concat /time_proj/Concat_1
Gemm /time_embedding/linear_1/Gemm
Sigmoid /time_embedding/act/Sigmoid
Mul /time_embedding/act/Mul
Gemm /time_embedding/linear_2/Gemm
Sigmoid /down_blocks.0/resnets.0/act_1/Sigmoid
Mul /down_blocks.0/resnets.0/act_1/Mul
Gemm /down_blocks.0/resnets.0/time_emb_proj/Gemm
Unsqueeze /down_blocks.0/resnets.0/Unsqueeze_1
Add /down_blocks.0/resnets.0/Add
(1, 320, 32, 32)
(1, 320, 1) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add/Add:0', description="created by layer 'tf.math.add'")
Reshape /down_blocks.0/resnets.0/norm2/Reshape
input_shape: (1, 320, 32, 32) total_elements: 327680
[ 0 32 -1] 32
final_shape: [1, 32, 10240] dynamic_dim_size: 10240
Final shape: [1, 32, 10240]
InstanceNormalization /down_blocks.0/resnets.0/norm2/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmpp83duwdq/assets
INFO:tensorflow:Assets written to: /tmp/tmpp83duwdq/assets
2024-07-29 19:38:50.994453: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:38:50.994496: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:38:50.994920: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpp83duwdq
2024-07-29 19:38:50.996935: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:38:50.997031: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpp83duwdq
2024-07-29 19:38:50.999991: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:375] MLIR V1 optimization pass is not enabled
2024-07-29 19:38:51.000573: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:38:51.029531: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpp83duwdq
2024-07-29 19:38:51.036095: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 41175 microseconds.
2024-07-29 19:38:51.059758: I tensorflow/compiler/mlir/tensorflow/utils/dump_mlir_util.cc:255] disabling MLIR crash reproducer, set env var `MLIR_CRASH_REPRODUCER_DIRECTORY` to enable.
2024-07-29 19:38:51.128590: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 6.068 M  ops, equivalently 3.034 M  MACs
INFO: Created TensorFlow Lite XNNPACK delegate for CPU.
INFO:converter running::tflite model elements' max error is 1.9073E-06, pass, tflite saved in ./tflite/cpusubgraph0.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph0.onnx to ./tflite/cpusubgraph0.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph1.onnx
Checking 0/1...
InstanceNormalization /down_blocks.0/resnets.0/norm1/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmpvw984vlq/assets
INFO:tensorflow:Assets written to: /tmp/tmpvw984vlq/assets
2024-07-29 19:38:51.607778: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:38:51.607824: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:38:51.608493: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpvw984vlq
2024-07-29 19:38:51.608813: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:38:51.608851: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpvw984vlq
2024-07-29 19:38:51.609431: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:38:51.613118: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpvw984vlq
2024-07-29 19:38:51.615845: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 7357 microseconds.
2024-07-29 19:38:51.629489: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.655 M  ops, equivalently 0.328 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph1.onnx to ./tflite/cpusubgraph1.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph10.onnx
Checking 0/1...
InstanceNormalization /down_blocks.2/resnets.0/norm1/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmp5_w6_ngb/assets
INFO:tensorflow:Assets written to: /tmp/tmp5_w6_ngb/assets
2024-07-29 19:38:51.794002: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:38:51.794065: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:38:51.794309: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp5_w6_ngb
2024-07-29 19:38:51.794635: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:38:51.794665: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp5_w6_ngb
2024-07-29 19:38:51.795512: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:38:51.798829: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp5_w6_ngb
2024-07-29 19:38:51.801497: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 7191 microseconds.
2024-07-29 19:38:51.814746: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.082 M  ops, equivalently 0.041 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph10.onnx to ./tflite/cpusubgraph10.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph11.onnx
Checking 0/1...
Gemm /down_blocks.2/resnets.0/time_emb_proj/Gemm
Unsqueeze /down_blocks.2/resnets.0/Unsqueeze_1
Add /down_blocks.2/resnets.0/Add
(1, 1280, 8, 8)
(1, 1280, 1) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 1280, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_1/Add:0', description="created by layer 'tf.math.add_1'")
Reshape /down_blocks.2/resnets.0/norm2/Reshape
input_shape: (1, 1280, 8, 8) total_elements: 81920
[ 0 32 -1] 32
final_shape: [1, 32, 2560] dynamic_dim_size: 2560
Final shape: [1, 32, 2560]
InstanceNormalization /down_blocks.2/resnets.0/norm2/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmp999ixfik/assets
INFO:tensorflow:Assets written to: /tmp/tmp999ixfik/assets
2024-07-29 19:38:52.186919: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:38:52.186964: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:38:52.187082: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp999ixfik
2024-07-29 19:38:52.187557: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:38:52.187593: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp999ixfik
2024-07-29 19:38:52.188549: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:38:52.200735: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp999ixfik
2024-07-29 19:38:52.204458: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 17377 microseconds.
2024-07-29 19:38:52.243933: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 3.524 M  ops, equivalently 1.762 M  MACs
INFO:converter running::tflite model elements' max error is 5.0068E-06, pass, tflite saved in ./tflite/cpusubgraph11.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph11.onnx to ./tflite/cpusubgraph11.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph12.onnx
Checking 0/1...
InstanceNormalization /down_blocks.2/attentions.0/norm/InstanceNormalization
Reshape /down_blocks.2/attentions.0/norm/Reshape_1
input_shape: (1, 32, 2560) total_elements: 81920
[   1 1280    8    8] 81920
Final shape: [   1 1280    8    8]
INFO:tensorflow:Assets written to: /tmp/tmplgutzcfa/assets
INFO:tensorflow:Assets written to: /tmp/tmplgutzcfa/assets
2024-07-29 19:38:52.626666: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:38:52.626719: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:38:52.627008: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmplgutzcfa
2024-07-29 19:38:52.627363: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:38:52.627401: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmplgutzcfa
2024-07-29 19:38:52.628142: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:38:52.633605: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmplgutzcfa
2024-07-29 19:38:52.636490: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 9486 microseconds.
2024-07-29 19:38:52.651313: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.164 M  ops, equivalently 0.082 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph12.onnx to ./tflite/cpusubgraph12.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph13.onnx
Checking 0/1...
Transpose /down_blocks.2/attentions.0/Transpose
Reshape /down_blocks.2/attentions.0/Reshape
input_shape: (1, 8, 8, 1280) total_elements: 81920
[   1   64 1280] 81920
Final shape: [   1   64 1280]
ReduceMean /down_blocks.2/attentions.0/transformer_blocks.0/norm1/ReduceMean
Sub /down_blocks.2/attentions.0/transformer_blocks.0/norm1/Sub
Pow /down_blocks.2/attentions.0/transformer_blocks.0/norm1/Pow
ReduceMean /down_blocks.2/attentions.0/transformer_blocks.0/norm1/ReduceMean_1
Add /down_blocks.2/attentions.0/transformer_blocks.0/norm1/Add
(1, 64, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1), dtype=tf.float32, name=None), name='tf.math.add_2/Add:0', description="created by layer 'tf.math.add_2'")
Sqrt /down_blocks.2/attentions.0/transformer_blocks.0/norm1/Sqrt
Div /down_blocks.2/attentions.0/transformer_blocks.0/norm1/Div
Mul /down_blocks.2/attentions.0/transformer_blocks.0/norm1/Mul
Add /down_blocks.2/attentions.0/transformer_blocks.0/norm1/Add_1
(1, 64, 1280)
(1280,) 1
[1, 64, 1]
1 1
1
64 1
64
1280 1280
1
tf.Tensor(
[[[ 0.00623223 -0.01760116  0.0005221  ... -0.00697825 -0.00407918
    0.03333687]
  [ 0.00623223 -0.01760116  0.0005221  ... -0.00697825 -0.00407918
    0.03333687]
  [ 0.00623223 -0.01760116  0.0005221  ... -0.00697825 -0.00407918
    0.03333687]
  ...
  [ 0.00623223 -0.01760116  0.0005221  ... -0.00697825 -0.00407918
    0.03333687]
  [ 0.00623223 -0.01760116  0.0005221  ... -0.00697825 -0.00407918
    0.03333687]
  [ 0.00623223 -0.01760116  0.0005221  ... -0.00697825 -0.00407918
    0.03333687]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_3/Add:0', description="created by layer 'tf.math.add_3'")
MatMul
Split
Reshape /down_blocks.2/attentions.0/transformer_blocks.0/attn1/Reshape
input_shape: (1, 64, 1280) total_elements: 81920
[  1  -1   8 160] 1280
final_shape: [1, 64, 8, 160] dynamic_dim_size: 64
Final shape: [1, 64, 8, 160]
Transpose /down_blocks.2/attentions.0/transformer_blocks.0/attn1/Transpose
Reshape /down_blocks.2/attentions.0/transformer_blocks.0/attn1/Reshape_1
input_shape: (1, 64, 1280) total_elements: 81920
[  1  -1   8 160] 1280
final_shape: [1, 64, 8, 160] dynamic_dim_size: 64
Final shape: [1, 64, 8, 160]
Reshape /down_blocks.2/attentions.0/transformer_blocks.0/attn1/Reshape_2
input_shape: (1, 64, 1280) total_elements: 81920
[  1  -1   8 160] 1280
final_shape: [1, 64, 8, 160] dynamic_dim_size: 64
Final shape: [1, 64, 8, 160]
Transpose /down_blocks.2/attentions.0/transformer_blocks.0/attn1/Transpose_1
Transpose /down_blocks.2/attentions.0/transformer_blocks.0/attn1/Transpose_2
Mul /down_blocks.2/attentions.0/transformer_blocks.0/attn1/Mul
Mul /down_blocks.2/attentions.0/transformer_blocks.0/attn1/Mul_1
MatMul /down_blocks.2/attentions.0/transformer_blocks.0/attn1/MatMul
Softmax /down_blocks.2/attentions.0/transformer_blocks.0/attn1/Softmax
MatMul /down_blocks.2/attentions.0/transformer_blocks.0/attn1/MatMul_1
Transpose /down_blocks.2/attentions.0/transformer_blocks.0/attn1/Transpose_3
Reshape /down_blocks.2/attentions.0/transformer_blocks.0/attn1/Reshape_3
input_shape: (1, 64, 8, 160) total_elements: 81920
[   1   -1 1280] 1280
final_shape: [1, 64, 1280] dynamic_dim_size: 64
Final shape: [1, 64, 1280]
MatMul /down_blocks.2/attentions.0/transformer_blocks.0/attn1/to_out.0/MatMul
Add /down_blocks.2/attentions.0/transformer_blocks.0/attn1/to_out.0/Add
(1280,)
(1, 64, 1280) 3
[1, 64, 1]
tf.Tensor(
[[[ 0.04663774 -0.03519822  0.02264747 ...  0.01116844  0.02656523
   -0.01776707]
  [ 0.04663774 -0.03519822  0.02264747 ...  0.01116844  0.02656523
   -0.01776707]
  [ 0.04663774 -0.03519822  0.02264747 ...  0.01116844  0.02656523
   -0.01776707]
  ...
  [ 0.04663774 -0.03519822  0.02264747 ...  0.01116844  0.02656523
   -0.01776707]
  [ 0.04663774 -0.03519822  0.02264747 ...  0.01116844  0.02656523
   -0.01776707]
  [ 0.04663774 -0.03519822  0.02264747 ...  0.01116844  0.02656523
   -0.01776707]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_4/Add:0', description="created by layer 'tf.math.add_4'")
Add /down_blocks.2/attentions.0/transformer_blocks.0/Add
(1, 64, 1280)
(1, 64, 1280) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_5/Add:0', description="created by layer 'tf.math.add_5'")
ReduceMean /down_blocks.2/attentions.0/transformer_blocks.0/norm2/ReduceMean
Sub /down_blocks.2/attentions.0/transformer_blocks.0/norm2/Sub
Pow /down_blocks.2/attentions.0/transformer_blocks.0/norm2/Pow
ReduceMean /down_blocks.2/attentions.0/transformer_blocks.0/norm2/ReduceMean_1
Add /down_blocks.2/attentions.0/transformer_blocks.0/norm2/Add
(1, 64, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1), dtype=tf.float32, name=None), name='tf.math.add_6/Add:0', description="created by layer 'tf.math.add_6'")
Sqrt /down_blocks.2/attentions.0/transformer_blocks.0/norm2/Sqrt
Div /down_blocks.2/attentions.0/transformer_blocks.0/norm2/Div
Mul /down_blocks.2/attentions.0/transformer_blocks.0/norm2/Mul
Add /down_blocks.2/attentions.0/transformer_blocks.0/norm2/Add_1
(1, 64, 1280)
(1280,) 1
[1, 64, 1]
1 1
1
64 1
64
1280 1280
1
tf.Tensor(
[[[ 0.00804778 -0.09591751  0.01550706 ... -0.04273857 -0.10658184
   -0.04009322]
  [ 0.00804778 -0.09591751  0.01550706 ... -0.04273857 -0.10658184
   -0.04009322]
  [ 0.00804778 -0.09591751  0.01550706 ... -0.04273857 -0.10658184
   -0.04009322]
  ...
  [ 0.00804778 -0.09591751  0.01550706 ... -0.04273857 -0.10658184
   -0.04009322]
  [ 0.00804778 -0.09591751  0.01550706 ... -0.04273857 -0.10658184
   -0.04009322]
  [ 0.00804778 -0.09591751  0.01550706 ... -0.04273857 -0.10658184
   -0.04009322]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_7/Add:0', description="created by layer 'tf.math.add_7'")
MatMul /down_blocks.2/attentions.0/transformer_blocks.0/attn2/to_q/MatMul
MatMul /down_blocks.2/attentions.0/transformer_blocks.0/attn2/to_k/MatMul
MatMul /down_blocks.2/attentions.0/transformer_blocks.0/attn2/to_v/MatMul
Reshape /down_blocks.2/attentions.0/transformer_blocks.0/attn2/Reshape
input_shape: (1, 64, 1280) total_elements: 81920
[  1  -1   8 160] 1280
final_shape: [1, 64, 8, 160] dynamic_dim_size: 64
Final shape: [1, 64, 8, 160]
Transpose /down_blocks.2/attentions.0/transformer_blocks.0/attn2/Transpose
Reshape /down_blocks.2/attentions.0/transformer_blocks.0/attn2/Reshape_1
input_shape: (1, 77, 1280) total_elements: 98560
[  1  -1   8 160] 1280
final_shape: [1, 77, 8, 160] dynamic_dim_size: 77
Final shape: [1, 77, 8, 160]
Reshape /down_blocks.2/attentions.0/transformer_blocks.0/attn2/Reshape_2
input_shape: (1, 77, 1280) total_elements: 98560
[  1  -1   8 160] 1280
final_shape: [1, 77, 8, 160] dynamic_dim_size: 77
Final shape: [1, 77, 8, 160]
Transpose /down_blocks.2/attentions.0/transformer_blocks.0/attn2/Transpose_1
Transpose /down_blocks.2/attentions.0/transformer_blocks.0/attn2/Transpose_2
Mul /down_blocks.2/attentions.0/transformer_blocks.0/attn2/Mul
Mul /down_blocks.2/attentions.0/transformer_blocks.0/attn2/Mul_1
MatMul /down_blocks.2/attentions.0/transformer_blocks.0/attn2/MatMul
Softmax /down_blocks.2/attentions.0/transformer_blocks.0/attn2/Softmax
MatMul /down_blocks.2/attentions.0/transformer_blocks.0/attn2/MatMul_1
Transpose /down_blocks.2/attentions.0/transformer_blocks.0/attn2/Transpose_3
Reshape /down_blocks.2/attentions.0/transformer_blocks.0/attn2/Reshape_3
input_shape: (1, 64, 8, 160) total_elements: 81920
[   1   -1 1280] 1280
final_shape: [1, 64, 1280] dynamic_dim_size: 64
Final shape: [1, 64, 1280]
MatMul /down_blocks.2/attentions.0/transformer_blocks.0/attn2/to_out.0/MatMul
Add /down_blocks.2/attentions.0/transformer_blocks.0/attn2/to_out.0/Add
(1280,)
(1, 64, 1280) 3
[1, 64, 1]
tf.Tensor(
[[[ 0.0330342  -0.02639028  0.0254348  ...  0.01986559  0.02910794
   -0.00072039]
  [ 0.0330342  -0.02639028  0.0254348  ...  0.01986559  0.02910794
   -0.00072039]
  [ 0.0330342  -0.02639028  0.0254348  ...  0.01986559  0.02910794
   -0.00072039]
  ...
  [ 0.0330342  -0.02639028  0.0254348  ...  0.01986559  0.02910794
   -0.00072039]
  [ 0.0330342  -0.02639028  0.0254348  ...  0.01986559  0.02910794
   -0.00072039]
  [ 0.0330342  -0.02639028  0.0254348  ...  0.01986559  0.02910794
   -0.00072039]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_8/Add:0', description="created by layer 'tf.math.add_8'")
Add /down_blocks.2/attentions.0/transformer_blocks.0/Add_1
(1, 64, 1280)
(1, 64, 1280) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_9/Add:0', description="created by layer 'tf.math.add_9'")
ReduceMean /down_blocks.2/attentions.0/transformer_blocks.0/norm3/ReduceMean
Sub /down_blocks.2/attentions.0/transformer_blocks.0/norm3/Sub
Pow /down_blocks.2/attentions.0/transformer_blocks.0/norm3/Pow
ReduceMean /down_blocks.2/attentions.0/transformer_blocks.0/norm3/ReduceMean_1
Add /down_blocks.2/attentions.0/transformer_blocks.0/norm3/Add
(1, 64, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1), dtype=tf.float32, name=None), name='tf.math.add_10/Add:0', description="created by layer 'tf.math.add_10'")
Sqrt /down_blocks.2/attentions.0/transformer_blocks.0/norm3/Sqrt
Div /down_blocks.2/attentions.0/transformer_blocks.0/norm3/Div
Mul /down_blocks.2/attentions.0/transformer_blocks.0/norm3/Mul
Add /down_blocks.2/attentions.0/transformer_blocks.0/norm3/Add_1
(1, 64, 1280)
(1280,) 1
[1, 64, 1]
1 1
1
64 1
64
1280 1280
1
tf.Tensor(
[[[-0.0360132   0.00157609 -0.00331429 ... -0.03739063 -0.05166382
    0.01859364]
  [-0.0360132   0.00157609 -0.00331429 ... -0.03739063 -0.05166382
    0.01859364]
  [-0.0360132   0.00157609 -0.00331429 ... -0.03739063 -0.05166382
    0.01859364]
  ...
  [-0.0360132   0.00157609 -0.00331429 ... -0.03739063 -0.05166382
    0.01859364]
  [-0.0360132   0.00157609 -0.00331429 ... -0.03739063 -0.05166382
    0.01859364]
  [-0.0360132   0.00157609 -0.00331429 ... -0.03739063 -0.05166382
    0.01859364]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_11/Add:0', description="created by layer 'tf.math.add_11'")
MatMul /down_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/proj/MatMul
Add /down_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/proj/Add
(10240,)
(1, 64, 10240) 3
[1, 64, 1]
tf.Tensor(
[[[ 0.00979627 -0.02203473  0.00558569 ... -0.26518482 -0.0527331
    0.05061853]
  [ 0.00979627 -0.02203473  0.00558569 ... -0.26518482 -0.0527331
    0.05061853]
  [ 0.00979627 -0.02203473  0.00558569 ... -0.26518482 -0.0527331
    0.05061853]
  ...
  [ 0.00979627 -0.02203473  0.00558569 ... -0.26518482 -0.0527331
    0.05061853]
  [ 0.00979627 -0.02203473  0.00558569 ... -0.26518482 -0.0527331
    0.05061853]
  [ 0.00979627 -0.02203473  0.00558569 ... -0.26518482 -0.0527331
    0.05061853]]], shape=(1, 64, 10240), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 10240), dtype=tf.float32, name=None), name='tf.math.add_12/Add:0', description="created by layer 'tf.math.add_12'")
Slice /down_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Slice
Slice /down_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Slice_1
Div /down_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Div_1
Erf /down_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Erf
Add /down_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Add_1
(1, 64, 5120)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 5120), dtype=tf.float32, name=None), name='tf.math.add_13/Add:0', description="created by layer 'tf.math.add_13'")
Mul /down_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Mul_2
Mul /down_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Mul_3
Mul /down_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Mul_4
MatMul /down_blocks.2/attentions.0/transformer_blocks.0/ff/net.2/MatMul
Add /down_blocks.2/attentions.0/transformer_blocks.0/ff/net.2/Add
(1280,)
(1, 64, 1280) 3
[1, 64, 1]
tf.Tensor(
[[[-0.00285217 -0.00736646  0.00639354 ... -0.025811   -0.01556939
   -0.00341728]
  [-0.00285217 -0.00736646  0.00639354 ... -0.025811   -0.01556939
   -0.00341728]
  [-0.00285217 -0.00736646  0.00639354 ... -0.025811   -0.01556939
   -0.00341728]
  ...
  [-0.00285217 -0.00736646  0.00639354 ... -0.025811   -0.01556939
   -0.00341728]
  [-0.00285217 -0.00736646  0.00639354 ... -0.025811   -0.01556939
   -0.00341728]
  [-0.00285217 -0.00736646  0.00639354 ... -0.025811   -0.01556939
   -0.00341728]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_14/Add:0', description="created by layer 'tf.math.add_14'")
Add /down_blocks.2/attentions.0/transformer_blocks.0/Add_2
(1, 64, 1280)
(1, 64, 1280) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_15/Add:0', description="created by layer 'tf.math.add_15'")
Reshape /down_blocks.2/attentions.0/Reshape_1
input_shape: (1, 64, 1280) total_elements: 81920
[   1    8    8 1280] 81920
Final shape: [   1    8    8 1280]
Transpose /down_blocks.2/attentions.0/Transpose_1
INFO:tensorflow:Assets written to: /tmp/tmp4mm9ig9k/assets
INFO:tensorflow:Assets written to: /tmp/tmp4mm9ig9k/assets
2024-07-29 19:38:58.703519: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:38:58.703587: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:38:58.703821: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp4mm9ig9k
2024-07-29 19:38:58.706693: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:38:58.706737: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp4mm9ig9k
2024-07-29 19:38:58.712887: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:38:58.776997: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp4mm9ig9k
2024-07-29 19:38:58.787868: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 84051 microseconds.
2024-07-29 19:38:59.103364: W tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2073] TFLite interpreter needs to link Flex delegate in order to run the model since it contains the following Select TFop(s):
Flex ops: FlexErf
Details:
        tf.Erf(tensor<1x64x5120xf32>) -> (tensor<1x64x5120xf32>) : {device = ""}
See instructions: https://www.tensorflow.org/lite/guide/ops_select
2024-07-29 19:38:59.103453: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 4.133 G  ops, equivalently 2.066 G  MACs
INFO: Created TensorFlow Lite delegate for select TF ops.
2024-07-29 19:39:00.376317: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2024-07-29 19:39:00.376364: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1960] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
INFO: TfLiteFlexDelegate delegate: 1 nodes delegated out of 199 nodes with 1 partitions.

INFO:converter running::tflite model elements' max error is 1.2398E-05, pass, tflite saved in ./tflite/cpusubgraph13.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph13.onnx to ./tflite/cpusubgraph13.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph14.onnx
Checking 0/1...
Add /down_blocks.2/attentions.0/Add
(1, 1280, 8, 8)
(1, 1280, 8, 8) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 1280, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_16/Add:0', description="created by layer 'tf.math.add_16'")
Concat /up_blocks.0/Concat
Reshape /up_blocks.0/resnets.0/norm1/Reshape
input_shape: (1, 2560, 8, 8) total_elements: 163840
[ 0 32 -1] 32
final_shape: [1, 32, 5120] dynamic_dim_size: 5120
Final shape: [1, 32, 5120]
InstanceNormalization /up_blocks.0/resnets.0/norm1/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmpoin56i3k/assets
INFO:tensorflow:Assets written to: /tmp/tmpoin56i3k/assets
2024-07-29 19:39:03.345705: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:03.345751: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:03.345871: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpoin56i3k
2024-07-29 19:39:03.346153: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:03.346177: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpoin56i3k
2024-07-29 19:39:03.346817: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:03.350719: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpoin56i3k
2024-07-29 19:39:03.353363: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 7493 microseconds.
2024-07-29 19:39:03.367934: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.410 M  ops, equivalently 0.205 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph14.onnx to ./tflite/cpusubgraph14.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph15.onnx
Checking 0/1...
Gemm /up_blocks.0/resnets.0/time_emb_proj/Gemm
Unsqueeze /up_blocks.0/resnets.0/Unsqueeze_1
Add /up_blocks.0/resnets.0/Add
(1, 1280, 8, 8)
(1, 1280, 1) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 1280, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_17/Add:0', description="created by layer 'tf.math.add_17'")
Reshape /up_blocks.0/resnets.0/norm2/Reshape
input_shape: (1, 1280, 8, 8) total_elements: 81920
[ 0 32 -1] 32
final_shape: [1, 32, 2560] dynamic_dim_size: 2560
Final shape: [1, 32, 2560]
InstanceNormalization /up_blocks.0/resnets.0/norm2/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmpqvje5p0d/assets
INFO:tensorflow:Assets written to: /tmp/tmpqvje5p0d/assets
2024-07-29 19:39:03.685459: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:03.685509: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:03.685645: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpqvje5p0d
2024-07-29 19:39:03.686097: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:03.686133: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpqvje5p0d
2024-07-29 19:39:03.687411: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:03.696927: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpqvje5p0d
2024-07-29 19:39:03.700357: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 14712 microseconds.
2024-07-29 19:39:03.732490: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 3.524 M  ops, equivalently 1.762 M  MACs
INFO:converter running::tflite model elements' max error is 4.6492E-06, pass, tflite saved in ./tflite/cpusubgraph15.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph15.onnx to ./tflite/cpusubgraph15.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph16.onnx
Checking 0/1...
InstanceNormalization /up_blocks.0/attentions.0/norm/InstanceNormalization
Reshape /up_blocks.0/attentions.0/norm/Reshape_1
input_shape: (1, 32, 2560) total_elements: 81920
[   1 1280    8    8] 81920
Final shape: [   1 1280    8    8]
INFO:tensorflow:Assets written to: /tmp/tmp7yh852sw/assets
INFO:tensorflow:Assets written to: /tmp/tmp7yh852sw/assets
2024-07-29 19:39:04.083317: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:04.083368: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:04.083486: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp7yh852sw
2024-07-29 19:39:04.083724: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:04.083746: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp7yh852sw
2024-07-29 19:39:04.084290: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:04.087681: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp7yh852sw
2024-07-29 19:39:04.090995: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 7508 microseconds.
2024-07-29 19:39:04.104782: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.164 M  ops, equivalently 0.082 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph16.onnx to ./tflite/cpusubgraph16.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph17.onnx
Checking 0/1...
Transpose /up_blocks.0/attentions.0/Transpose
Reshape /up_blocks.0/attentions.0/Reshape
input_shape: (1, 8, 8, 1280) total_elements: 81920
[   1   64 1280] 81920
Final shape: [   1   64 1280]
ReduceMean /up_blocks.0/attentions.0/transformer_blocks.0/norm1/ReduceMean
Sub /up_blocks.0/attentions.0/transformer_blocks.0/norm1/Sub
Pow /up_blocks.0/attentions.0/transformer_blocks.0/norm1/Pow
ReduceMean /up_blocks.0/attentions.0/transformer_blocks.0/norm1/ReduceMean_1
Add /up_blocks.0/attentions.0/transformer_blocks.0/norm1/Add
(1, 64, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1), dtype=tf.float32, name=None), name='tf.math.add_18/Add:0', description="created by layer 'tf.math.add_18'")
Sqrt /up_blocks.0/attentions.0/transformer_blocks.0/norm1/Sqrt
Div /up_blocks.0/attentions.0/transformer_blocks.0/norm1/Div
Mul /up_blocks.0/attentions.0/transformer_blocks.0/norm1/Mul
Add /up_blocks.0/attentions.0/transformer_blocks.0/norm1/Add_1
(1, 64, 1280)
(1280,) 1
[1, 64, 1]
1 1
1
64 1
64
1280 1280
1
tf.Tensor(
[[[-0.02776456 -0.00861928  0.05859809 ... -0.00861499  0.06732855
    0.02168178]
  [-0.02776456 -0.00861928  0.05859809 ... -0.00861499  0.06732855
    0.02168178]
  [-0.02776456 -0.00861928  0.05859809 ... -0.00861499  0.06732855
    0.02168178]
  ...
  [-0.02776456 -0.00861928  0.05859809 ... -0.00861499  0.06732855
    0.02168178]
  [-0.02776456 -0.00861928  0.05859809 ... -0.00861499  0.06732855
    0.02168178]
  [-0.02776456 -0.00861928  0.05859809 ... -0.00861499  0.06732855
    0.02168178]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_19/Add:0', description="created by layer 'tf.math.add_19'")
MatMul
Split
Reshape /up_blocks.0/attentions.0/transformer_blocks.0/attn1/Reshape
input_shape: (1, 64, 1280) total_elements: 81920
[  1  -1   8 160] 1280
final_shape: [1, 64, 8, 160] dynamic_dim_size: 64
Final shape: [1, 64, 8, 160]
Transpose /up_blocks.0/attentions.0/transformer_blocks.0/attn1/Transpose
Reshape /up_blocks.0/attentions.0/transformer_blocks.0/attn1/Reshape_1
input_shape: (1, 64, 1280) total_elements: 81920
[  1  -1   8 160] 1280
final_shape: [1, 64, 8, 160] dynamic_dim_size: 64
Final shape: [1, 64, 8, 160]
Reshape /up_blocks.0/attentions.0/transformer_blocks.0/attn1/Reshape_2
input_shape: (1, 64, 1280) total_elements: 81920
[  1  -1   8 160] 1280
final_shape: [1, 64, 8, 160] dynamic_dim_size: 64
Final shape: [1, 64, 8, 160]
Transpose /up_blocks.0/attentions.0/transformer_blocks.0/attn1/Transpose_1
Transpose /up_blocks.0/attentions.0/transformer_blocks.0/attn1/Transpose_2
Mul /up_blocks.0/attentions.0/transformer_blocks.0/attn1/Mul
Mul /up_blocks.0/attentions.0/transformer_blocks.0/attn1/Mul_1
MatMul /up_blocks.0/attentions.0/transformer_blocks.0/attn1/MatMul
Softmax /up_blocks.0/attentions.0/transformer_blocks.0/attn1/Softmax
MatMul /up_blocks.0/attentions.0/transformer_blocks.0/attn1/MatMul_1
Transpose /up_blocks.0/attentions.0/transformer_blocks.0/attn1/Transpose_3
Reshape /up_blocks.0/attentions.0/transformer_blocks.0/attn1/Reshape_3
input_shape: (1, 64, 8, 160) total_elements: 81920
[   1   -1 1280] 1280
final_shape: [1, 64, 1280] dynamic_dim_size: 64
Final shape: [1, 64, 1280]
MatMul /up_blocks.0/attentions.0/transformer_blocks.0/attn1/to_out.0/MatMul
Add /up_blocks.0/attentions.0/transformer_blocks.0/attn1/to_out.0/Add
(1280,)
(1, 64, 1280) 3
[1, 64, 1]
tf.Tensor(
[[[-0.00120803  0.03892357 -0.10272405 ...  0.06414568 -0.0022015
   -0.03248331]
  [-0.00120803  0.03892357 -0.10272405 ...  0.06414568 -0.0022015
   -0.03248331]
  [-0.00120803  0.03892357 -0.10272405 ...  0.06414568 -0.0022015
   -0.03248331]
  ...
  [-0.00120803  0.03892357 -0.10272405 ...  0.06414568 -0.0022015
   -0.03248331]
  [-0.00120803  0.03892357 -0.10272405 ...  0.06414568 -0.0022015
   -0.03248331]
  [-0.00120803  0.03892357 -0.10272405 ...  0.06414568 -0.0022015
   -0.03248331]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_20/Add:0', description="created by layer 'tf.math.add_20'")
Add /up_blocks.0/attentions.0/transformer_blocks.0/Add
(1, 64, 1280)
(1, 64, 1280) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_21/Add:0', description="created by layer 'tf.math.add_21'")
ReduceMean /up_blocks.0/attentions.0/transformer_blocks.0/norm2/ReduceMean
Sub /up_blocks.0/attentions.0/transformer_blocks.0/norm2/Sub
Pow /up_blocks.0/attentions.0/transformer_blocks.0/norm2/Pow
ReduceMean /up_blocks.0/attentions.0/transformer_blocks.0/norm2/ReduceMean_1
Add /up_blocks.0/attentions.0/transformer_blocks.0/norm2/Add
(1, 64, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1), dtype=tf.float32, name=None), name='tf.math.add_22/Add:0', description="created by layer 'tf.math.add_22'")
Sqrt /up_blocks.0/attentions.0/transformer_blocks.0/norm2/Sqrt
Div /up_blocks.0/attentions.0/transformer_blocks.0/norm2/Div
Mul /up_blocks.0/attentions.0/transformer_blocks.0/norm2/Mul
Add /up_blocks.0/attentions.0/transformer_blocks.0/norm2/Add_1
(1, 64, 1280)
(1280,) 1
[1, 64, 1]
1 1
1
64 1
64
1280 1280
1
tf.Tensor(
[[[ 0.02078352  0.01861115  0.21561791 ...  0.08473241 -0.05999594
    0.11842605]
  [ 0.02078352  0.01861115  0.21561791 ...  0.08473241 -0.05999594
    0.11842605]
  [ 0.02078352  0.01861115  0.21561791 ...  0.08473241 -0.05999594
    0.11842605]
  ...
  [ 0.02078352  0.01861115  0.21561791 ...  0.08473241 -0.05999594
    0.11842605]
  [ 0.02078352  0.01861115  0.21561791 ...  0.08473241 -0.05999594
    0.11842605]
  [ 0.02078352  0.01861115  0.21561791 ...  0.08473241 -0.05999594
    0.11842605]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_23/Add:0', description="created by layer 'tf.math.add_23'")
MatMul /up_blocks.0/attentions.0/transformer_blocks.0/attn2/to_q/MatMul
MatMul /up_blocks.0/attentions.0/transformer_blocks.0/attn2/to_k/MatMul
MatMul /up_blocks.0/attentions.0/transformer_blocks.0/attn2/to_v/MatMul
Reshape /up_blocks.0/attentions.0/transformer_blocks.0/attn2/Reshape
input_shape: (1, 64, 1280) total_elements: 81920
[  1  -1   8 160] 1280
final_shape: [1, 64, 8, 160] dynamic_dim_size: 64
Final shape: [1, 64, 8, 160]
Transpose /up_blocks.0/attentions.0/transformer_blocks.0/attn2/Transpose
Reshape /up_blocks.0/attentions.0/transformer_blocks.0/attn2/Reshape_1
input_shape: (1, 77, 1280) total_elements: 98560
[  1  -1   8 160] 1280
final_shape: [1, 77, 8, 160] dynamic_dim_size: 77
Final shape: [1, 77, 8, 160]
Reshape /up_blocks.0/attentions.0/transformer_blocks.0/attn2/Reshape_2
input_shape: (1, 77, 1280) total_elements: 98560
[  1  -1   8 160] 1280
final_shape: [1, 77, 8, 160] dynamic_dim_size: 77
Final shape: [1, 77, 8, 160]
Transpose /up_blocks.0/attentions.0/transformer_blocks.0/attn2/Transpose_1
Transpose /up_blocks.0/attentions.0/transformer_blocks.0/attn2/Transpose_2
Mul /up_blocks.0/attentions.0/transformer_blocks.0/attn2/Mul
Mul /up_blocks.0/attentions.0/transformer_blocks.0/attn2/Mul_1
MatMul /up_blocks.0/attentions.0/transformer_blocks.0/attn2/MatMul
Softmax /up_blocks.0/attentions.0/transformer_blocks.0/attn2/Softmax
MatMul /up_blocks.0/attentions.0/transformer_blocks.0/attn2/MatMul_1
Transpose /up_blocks.0/attentions.0/transformer_blocks.0/attn2/Transpose_3
Reshape /up_blocks.0/attentions.0/transformer_blocks.0/attn2/Reshape_3
input_shape: (1, 64, 8, 160) total_elements: 81920
[   1   -1 1280] 1280
final_shape: [1, 64, 1280] dynamic_dim_size: 64
Final shape: [1, 64, 1280]
MatMul /up_blocks.0/attentions.0/transformer_blocks.0/attn2/to_out.0/MatMul
Add /up_blocks.0/attentions.0/transformer_blocks.0/attn2/to_out.0/Add
(1280,)
(1, 64, 1280) 3
[1, 64, 1]
tf.Tensor(
[[[ 0.0019872   0.03102794 -0.13602437 ...  0.0652818   0.03830206
   -0.06349683]
  [ 0.0019872   0.03102794 -0.13602437 ...  0.0652818   0.03830206
   -0.06349683]
  [ 0.0019872   0.03102794 -0.13602437 ...  0.0652818   0.03830206
   -0.06349683]
  ...
  [ 0.0019872   0.03102794 -0.13602437 ...  0.0652818   0.03830206
   -0.06349683]
  [ 0.0019872   0.03102794 -0.13602437 ...  0.0652818   0.03830206
   -0.06349683]
  [ 0.0019872   0.03102794 -0.13602437 ...  0.0652818   0.03830206
   -0.06349683]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_24/Add:0', description="created by layer 'tf.math.add_24'")
Add /up_blocks.0/attentions.0/transformer_blocks.0/Add_1
(1, 64, 1280)
(1, 64, 1280) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_25/Add:0', description="created by layer 'tf.math.add_25'")
ReduceMean /up_blocks.0/attentions.0/transformer_blocks.0/norm3/ReduceMean
Sub /up_blocks.0/attentions.0/transformer_blocks.0/norm3/Sub
Pow /up_blocks.0/attentions.0/transformer_blocks.0/norm3/Pow
ReduceMean /up_blocks.0/attentions.0/transformer_blocks.0/norm3/ReduceMean_1
Add /up_blocks.0/attentions.0/transformer_blocks.0/norm3/Add
(1, 64, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1), dtype=tf.float32, name=None), name='tf.math.add_26/Add:0', description="created by layer 'tf.math.add_26'")
Sqrt /up_blocks.0/attentions.0/transformer_blocks.0/norm3/Sqrt
Div /up_blocks.0/attentions.0/transformer_blocks.0/norm3/Div
Mul /up_blocks.0/attentions.0/transformer_blocks.0/norm3/Mul
Add /up_blocks.0/attentions.0/transformer_blocks.0/norm3/Add_1
(1, 64, 1280)
(1280,) 1
[1, 64, 1]
1 1
1
64 1
64
1280 1280
1
tf.Tensor(
[[[-0.01784037  0.0157343   0.16917853 ... -0.02094588  0.05634449
    0.07507945]
  [-0.01784037  0.0157343   0.16917853 ... -0.02094588  0.05634449
    0.07507945]
  [-0.01784037  0.0157343   0.16917853 ... -0.02094588  0.05634449
    0.07507945]
  ...
  [-0.01784037  0.0157343   0.16917853 ... -0.02094588  0.05634449
    0.07507945]
  [-0.01784037  0.0157343   0.16917853 ... -0.02094588  0.05634449
    0.07507945]
  [-0.01784037  0.0157343   0.16917853 ... -0.02094588  0.05634449
    0.07507945]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_27/Add:0', description="created by layer 'tf.math.add_27'")
MatMul /up_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/proj/MatMul
Add /up_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/proj/Add
(10240,)
(1, 64, 10240) 3
[1, 64, 1]
tf.Tensor(
[[[ 0.00182002  0.01367731  0.03233207 ... -0.03951032 -0.06305661
   -0.03878781]
  [ 0.00182002  0.01367731  0.03233207 ... -0.03951032 -0.06305661
   -0.03878781]
  [ 0.00182002  0.01367731  0.03233207 ... -0.03951032 -0.06305661
   -0.03878781]
  ...
  [ 0.00182002  0.01367731  0.03233207 ... -0.03951032 -0.06305661
   -0.03878781]
  [ 0.00182002  0.01367731  0.03233207 ... -0.03951032 -0.06305661
   -0.03878781]
  [ 0.00182002  0.01367731  0.03233207 ... -0.03951032 -0.06305661
   -0.03878781]]], shape=(1, 64, 10240), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 10240), dtype=tf.float32, name=None), name='tf.math.add_28/Add:0', description="created by layer 'tf.math.add_28'")
Slice /up_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Slice
Slice /up_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Slice_1
Div /up_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Div_1
Erf /up_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Erf
Add /up_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Add_1
(1, 64, 5120)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 5120), dtype=tf.float32, name=None), name='tf.math.add_29/Add:0', description="created by layer 'tf.math.add_29'")
Mul /up_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Mul_2
Mul /up_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Mul_3
Mul /up_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Mul_4
MatMul /up_blocks.0/attentions.0/transformer_blocks.0/ff/net.2/MatMul
Add /up_blocks.0/attentions.0/transformer_blocks.0/ff/net.2/Add
(1280,)
(1, 64, 1280) 3
[1, 64, 1]
tf.Tensor(
[[[ 0.01476233  0.03895779 -0.01495736 ...  0.02620897 -0.02227247
   -0.00795647]
  [ 0.01476233  0.03895779 -0.01495736 ...  0.02620897 -0.02227247
   -0.00795647]
  [ 0.01476233  0.03895779 -0.01495736 ...  0.02620897 -0.02227247
   -0.00795647]
  ...
  [ 0.01476233  0.03895779 -0.01495736 ...  0.02620897 -0.02227247
   -0.00795647]
  [ 0.01476233  0.03895779 -0.01495736 ...  0.02620897 -0.02227247
   -0.00795647]
  [ 0.01476233  0.03895779 -0.01495736 ...  0.02620897 -0.02227247
   -0.00795647]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_30/Add:0', description="created by layer 'tf.math.add_30'")
Add /up_blocks.0/attentions.0/transformer_blocks.0/Add_2
(1, 64, 1280)
(1, 64, 1280) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_31/Add:0', description="created by layer 'tf.math.add_31'")
Reshape /up_blocks.0/attentions.0/Reshape_1
input_shape: (1, 64, 1280) total_elements: 81920
[   1    8    8 1280] 81920
Final shape: [   1    8    8 1280]
Transpose /up_blocks.0/attentions.0/Transpose_1
INFO:tensorflow:Assets written to: /tmp/tmpyd2zk831/assets
INFO:tensorflow:Assets written to: /tmp/tmpyd2zk831/assets
2024-07-29 19:39:09.977481: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:09.977543: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:09.977720: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpyd2zk831
2024-07-29 19:39:09.979641: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:09.979677: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpyd2zk831
2024-07-29 19:39:09.984702: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:10.044487: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpyd2zk831
2024-07-29 19:39:10.055463: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 77743 microseconds.
2024-07-29 19:39:10.351163: W tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2073] TFLite interpreter needs to link Flex delegate in order to run the model since it contains the following Select TFop(s):
Flex ops: FlexErf
Details:
        tf.Erf(tensor<1x64x5120xf32>) -> (tensor<1x64x5120xf32>) : {device = ""}
See instructions: https://www.tensorflow.org/lite/guide/ops_select
2024-07-29 19:39:10.351240: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 4.133 G  ops, equivalently 2.066 G  MACs
2024-07-29 19:39:11.674341: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2024-07-29 19:39:11.674387: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1960] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
INFO:converter running::tflite model elements' max error is 3.0518E-05, pass, tflite saved in ./tflite/cpusubgraph17.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph17.onnx to ./tflite/cpusubgraph17.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph18.onnx
Checking 0/1...
Add /up_blocks.0/attentions.0/Add
(1, 1280, 8, 8)
(1, 1280, 8, 8) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 1280, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_32/Add:0', description="created by layer 'tf.math.add_32'")
Concat /up_blocks.0/Concat_1
Reshape /up_blocks.0/resnets.1/norm1/Reshape
input_shape: (1, 1920, 8, 8) total_elements: 122880
[ 0 32 -1] 32
final_shape: [1, 32, 3840] dynamic_dim_size: 3840
Final shape: [1, 32, 3840]
InstanceNormalization /up_blocks.0/resnets.1/norm1/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmprsn5t2n8/assets
INFO:tensorflow:Assets written to: /tmp/tmprsn5t2n8/assets
2024-07-29 19:39:14.790227: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:14.790274: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:14.790396: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmprsn5t2n8
2024-07-29 19:39:14.790686: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:14.790714: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmprsn5t2n8
2024-07-29 19:39:14.791433: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:14.795404: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmprsn5t2n8
2024-07-29 19:39:14.799540: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 9144 microseconds.
2024-07-29 19:39:14.817128: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.328 M  ops, equivalently 0.164 M  MACs
INFO:converter running::tflite model elements' max error is 7.0333E-06, pass, tflite saved in ./tflite/cpusubgraph18.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph18.onnx to ./tflite/cpusubgraph18.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph19.onnx
Checking 0/1...
Gemm /up_blocks.0/resnets.1/time_emb_proj/Gemm
Unsqueeze /up_blocks.0/resnets.1/Unsqueeze_1
Add /up_blocks.0/resnets.1/Add
(1, 1280, 8, 8)
(1, 1280, 1) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 1280, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_33/Add:0', description="created by layer 'tf.math.add_33'")
Reshape /up_blocks.0/resnets.1/norm2/Reshape
input_shape: (1, 1280, 8, 8) total_elements: 81920
[ 0 32 -1] 32
final_shape: [1, 32, 2560] dynamic_dim_size: 2560
Final shape: [1, 32, 2560]
InstanceNormalization /up_blocks.0/resnets.1/norm2/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmpyx5pqnw8/assets
INFO:tensorflow:Assets written to: /tmp/tmpyx5pqnw8/assets
2024-07-29 19:39:15.168888: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:15.168935: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:15.169070: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpyx5pqnw8
2024-07-29 19:39:15.169663: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:15.169711: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpyx5pqnw8
2024-07-29 19:39:15.170871: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:15.183130: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpyx5pqnw8
2024-07-29 19:39:15.186490: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 17420 microseconds.
2024-07-29 19:39:15.225796: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 3.524 M  ops, equivalently 1.762 M  MACs
INFO:converter running::tflite model elements' max error is 5.0068E-06, pass, tflite saved in ./tflite/cpusubgraph19.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph19.onnx to ./tflite/cpusubgraph19.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph2.onnx
Checking 0/1...
Add /down_blocks.0/resnets.0/Add_1
(1, 320, 32, 32)
(1, 320, 32, 32) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_34/Add:0', description="created by layer 'tf.math.add_34'")
Reshape /down_blocks.0/attentions.0/norm/Reshape
input_shape: (1, 320, 32, 32) total_elements: 327680
[ 0 32 -1] 32
final_shape: [1, 32, 10240] dynamic_dim_size: 10240
Final shape: [1, 32, 10240]
InstanceNormalization /down_blocks.0/attentions.0/norm/InstanceNormalization
Reshape /down_blocks.0/attentions.0/norm/Reshape_1
input_shape: (1, 32, 10240) total_elements: 327680
[  1 320  32  32] 327680
Final shape: [  1 320  32  32]
INFO:tensorflow:Assets written to: /tmp/tmptnowpzlg/assets
INFO:tensorflow:Assets written to: /tmp/tmptnowpzlg/assets
2024-07-29 19:39:15.638017: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:15.638068: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:15.638203: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmptnowpzlg
2024-07-29 19:39:15.638697: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:15.638736: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmptnowpzlg
2024-07-29 19:39:15.639565: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:15.644700: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmptnowpzlg
2024-07-29 19:39:15.647570: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 9368 microseconds.
2024-07-29 19:39:15.663884: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.983 M  ops, equivalently 0.492 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph2.onnx to ./tflite/cpusubgraph2.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph20.onnx
Checking 0/1...
InstanceNormalization /up_blocks.0/attentions.1/norm/InstanceNormalization
Reshape /up_blocks.0/attentions.1/norm/Reshape_1
input_shape: (1, 32, 2560) total_elements: 81920
[   1 1280    8    8] 81920
Final shape: [   1 1280    8    8]
INFO:tensorflow:Assets written to: /tmp/tmpdol5qf9n/assets
INFO:tensorflow:Assets written to: /tmp/tmpdol5qf9n/assets
2024-07-29 19:39:15.842576: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:15.842638: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:15.842810: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpdol5qf9n
2024-07-29 19:39:15.843228: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:15.843257: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpdol5qf9n
2024-07-29 19:39:15.844041: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:15.848468: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpdol5qf9n
2024-07-29 19:39:15.851230: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 8422 microseconds.
2024-07-29 19:39:15.866714: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.164 M  ops, equivalently 0.082 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph20.onnx to ./tflite/cpusubgraph20.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph21.onnx
Checking 0/1...
Transpose /up_blocks.0/attentions.1/Transpose
Reshape /up_blocks.0/attentions.1/Reshape
input_shape: (1, 8, 8, 1280) total_elements: 81920
[   1   64 1280] 81920
Final shape: [   1   64 1280]
ReduceMean /up_blocks.0/attentions.1/transformer_blocks.0/norm1/ReduceMean
Sub /up_blocks.0/attentions.1/transformer_blocks.0/norm1/Sub
Pow /up_blocks.0/attentions.1/transformer_blocks.0/norm1/Pow
ReduceMean /up_blocks.0/attentions.1/transformer_blocks.0/norm1/ReduceMean_1
Add /up_blocks.0/attentions.1/transformer_blocks.0/norm1/Add
(1, 64, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1), dtype=tf.float32, name=None), name='tf.math.add_35/Add:0', description="created by layer 'tf.math.add_35'")
Sqrt /up_blocks.0/attentions.1/transformer_blocks.0/norm1/Sqrt
Div /up_blocks.0/attentions.1/transformer_blocks.0/norm1/Div
Mul /up_blocks.0/attentions.1/transformer_blocks.0/norm1/Mul
Add /up_blocks.0/attentions.1/transformer_blocks.0/norm1/Add_1
(1, 64, 1280)
(1280,) 1
[1, 64, 1]
1 1
1
64 1
64
1280 1280
1
tf.Tensor(
[[[-0.01248041  0.00416579  0.01898938 ... -0.00138762 -0.00654663
    0.01234647]
  [-0.01248041  0.00416579  0.01898938 ... -0.00138762 -0.00654663
    0.01234647]
  [-0.01248041  0.00416579  0.01898938 ... -0.00138762 -0.00654663
    0.01234647]
  ...
  [-0.01248041  0.00416579  0.01898938 ... -0.00138762 -0.00654663
    0.01234647]
  [-0.01248041  0.00416579  0.01898938 ... -0.00138762 -0.00654663
    0.01234647]
  [-0.01248041  0.00416579  0.01898938 ... -0.00138762 -0.00654663
    0.01234647]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_36/Add:0', description="created by layer 'tf.math.add_36'")
MatMul
Split
Reshape /up_blocks.0/attentions.1/transformer_blocks.0/attn1/Reshape
input_shape: (1, 64, 1280) total_elements: 81920
[  1  -1   8 160] 1280
final_shape: [1, 64, 8, 160] dynamic_dim_size: 64
Final shape: [1, 64, 8, 160]
Transpose /up_blocks.0/attentions.1/transformer_blocks.0/attn1/Transpose
Reshape /up_blocks.0/attentions.1/transformer_blocks.0/attn1/Reshape_1
input_shape: (1, 64, 1280) total_elements: 81920
[  1  -1   8 160] 1280
final_shape: [1, 64, 8, 160] dynamic_dim_size: 64
Final shape: [1, 64, 8, 160]
Reshape /up_blocks.0/attentions.1/transformer_blocks.0/attn1/Reshape_2
input_shape: (1, 64, 1280) total_elements: 81920
[  1  -1   8 160] 1280
final_shape: [1, 64, 8, 160] dynamic_dim_size: 64
Final shape: [1, 64, 8, 160]
Transpose /up_blocks.0/attentions.1/transformer_blocks.0/attn1/Transpose_1
Transpose /up_blocks.0/attentions.1/transformer_blocks.0/attn1/Transpose_2
Mul /up_blocks.0/attentions.1/transformer_blocks.0/attn1/Mul
Mul /up_blocks.0/attentions.1/transformer_blocks.0/attn1/Mul_1
MatMul /up_blocks.0/attentions.1/transformer_blocks.0/attn1/MatMul
Softmax /up_blocks.0/attentions.1/transformer_blocks.0/attn1/Softmax
MatMul /up_blocks.0/attentions.1/transformer_blocks.0/attn1/MatMul_1
Transpose /up_blocks.0/attentions.1/transformer_blocks.0/attn1/Transpose_3
Reshape /up_blocks.0/attentions.1/transformer_blocks.0/attn1/Reshape_3
input_shape: (1, 64, 8, 160) total_elements: 81920
[   1   -1 1280] 1280
final_shape: [1, 64, 1280] dynamic_dim_size: 64
Final shape: [1, 64, 1280]
MatMul /up_blocks.0/attentions.1/transformer_blocks.0/attn1/to_out.0/MatMul
Add /up_blocks.0/attentions.1/transformer_blocks.0/attn1/to_out.0/Add
(1280,)
(1, 64, 1280) 3
[1, 64, 1]
tf.Tensor(
[[[-0.00421104  0.0393961   0.04729574 ... -0.01858947 -0.00688716
    0.03722136]
  [-0.00421104  0.0393961   0.04729574 ... -0.01858947 -0.00688716
    0.03722136]
  [-0.00421104  0.0393961   0.04729574 ... -0.01858947 -0.00688716
    0.03722136]
  ...
  [-0.00421104  0.0393961   0.04729574 ... -0.01858947 -0.00688716
    0.03722136]
  [-0.00421104  0.0393961   0.04729574 ... -0.01858947 -0.00688716
    0.03722136]
  [-0.00421104  0.0393961   0.04729574 ... -0.01858947 -0.00688716
    0.03722136]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_37/Add:0', description="created by layer 'tf.math.add_37'")
Add /up_blocks.0/attentions.1/transformer_blocks.0/Add
(1, 64, 1280)
(1, 64, 1280) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_38/Add:0', description="created by layer 'tf.math.add_38'")
ReduceMean /up_blocks.0/attentions.1/transformer_blocks.0/norm2/ReduceMean
Sub /up_blocks.0/attentions.1/transformer_blocks.0/norm2/Sub
Pow /up_blocks.0/attentions.1/transformer_blocks.0/norm2/Pow
ReduceMean /up_blocks.0/attentions.1/transformer_blocks.0/norm2/ReduceMean_1
Add /up_blocks.0/attentions.1/transformer_blocks.0/norm2/Add
(1, 64, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1), dtype=tf.float32, name=None), name='tf.math.add_39/Add:0', description="created by layer 'tf.math.add_39'")
Sqrt /up_blocks.0/attentions.1/transformer_blocks.0/norm2/Sqrt
Div /up_blocks.0/attentions.1/transformer_blocks.0/norm2/Div
Mul /up_blocks.0/attentions.1/transformer_blocks.0/norm2/Mul
Add /up_blocks.0/attentions.1/transformer_blocks.0/norm2/Add_1
(1, 64, 1280)
(1280,) 1
[1, 64, 1]
1 1
1
64 1
64
1280 1280
1
tf.Tensor(
[[[-0.02108927  0.07757986 -0.06979878 ...  0.11166633  0.07296196
    0.10847372]
  [-0.02108927  0.07757986 -0.06979878 ...  0.11166633  0.07296196
    0.10847372]
  [-0.02108927  0.07757986 -0.06979878 ...  0.11166633  0.07296196
    0.10847372]
  ...
  [-0.02108927  0.07757986 -0.06979878 ...  0.11166633  0.07296196
    0.10847372]
  [-0.02108927  0.07757986 -0.06979878 ...  0.11166633  0.07296196
    0.10847372]
  [-0.02108927  0.07757986 -0.06979878 ...  0.11166633  0.07296196
    0.10847372]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_40/Add:0', description="created by layer 'tf.math.add_40'")
MatMul /up_blocks.0/attentions.1/transformer_blocks.0/attn2/to_q/MatMul
MatMul /up_blocks.0/attentions.1/transformer_blocks.0/attn2/to_k/MatMul
MatMul /up_blocks.0/attentions.1/transformer_blocks.0/attn2/to_v/MatMul
Reshape /up_blocks.0/attentions.1/transformer_blocks.0/attn2/Reshape
input_shape: (1, 64, 1280) total_elements: 81920
[  1  -1   8 160] 1280
final_shape: [1, 64, 8, 160] dynamic_dim_size: 64
Final shape: [1, 64, 8, 160]
Transpose /up_blocks.0/attentions.1/transformer_blocks.0/attn2/Transpose
Reshape /up_blocks.0/attentions.1/transformer_blocks.0/attn2/Reshape_1
input_shape: (1, 77, 1280) total_elements: 98560
[  1  -1   8 160] 1280
final_shape: [1, 77, 8, 160] dynamic_dim_size: 77
Final shape: [1, 77, 8, 160]
Reshape /up_blocks.0/attentions.1/transformer_blocks.0/attn2/Reshape_2
input_shape: (1, 77, 1280) total_elements: 98560
[  1  -1   8 160] 1280
final_shape: [1, 77, 8, 160] dynamic_dim_size: 77
Final shape: [1, 77, 8, 160]
Transpose /up_blocks.0/attentions.1/transformer_blocks.0/attn2/Transpose_1
Transpose /up_blocks.0/attentions.1/transformer_blocks.0/attn2/Transpose_2
Mul /up_blocks.0/attentions.1/transformer_blocks.0/attn2/Mul
Mul /up_blocks.0/attentions.1/transformer_blocks.0/attn2/Mul_1
MatMul /up_blocks.0/attentions.1/transformer_blocks.0/attn2/MatMul
Softmax /up_blocks.0/attentions.1/transformer_blocks.0/attn2/Softmax
MatMul /up_blocks.0/attentions.1/transformer_blocks.0/attn2/MatMul_1
Transpose /up_blocks.0/attentions.1/transformer_blocks.0/attn2/Transpose_3
Reshape /up_blocks.0/attentions.1/transformer_blocks.0/attn2/Reshape_3
input_shape: (1, 64, 8, 160) total_elements: 81920
[   1   -1 1280] 1280
final_shape: [1, 64, 1280] dynamic_dim_size: 64
Final shape: [1, 64, 1280]
MatMul /up_blocks.0/attentions.1/transformer_blocks.0/attn2/to_out.0/MatMul
Add /up_blocks.0/attentions.1/transformer_blocks.0/attn2/to_out.0/Add
(1280,)
(1, 64, 1280) 3
[1, 64, 1]
tf.Tensor(
[[[ 0.00102313  0.04024259  0.05608121 ... -0.035285   -0.00817594
    0.02867816]
  [ 0.00102313  0.04024259  0.05608121 ... -0.035285   -0.00817594
    0.02867816]
  [ 0.00102313  0.04024259  0.05608121 ... -0.035285   -0.00817594
    0.02867816]
  ...
  [ 0.00102313  0.04024259  0.05608121 ... -0.035285   -0.00817594
    0.02867816]
  [ 0.00102313  0.04024259  0.05608121 ... -0.035285   -0.00817594
    0.02867816]
  [ 0.00102313  0.04024259  0.05608121 ... -0.035285   -0.00817594
    0.02867816]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_41/Add:0', description="created by layer 'tf.math.add_41'")
Add /up_blocks.0/attentions.1/transformer_blocks.0/Add_1
(1, 64, 1280)
(1, 64, 1280) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_42/Add:0', description="created by layer 'tf.math.add_42'")
ReduceMean /up_blocks.0/attentions.1/transformer_blocks.0/norm3/ReduceMean
Sub /up_blocks.0/attentions.1/transformer_blocks.0/norm3/Sub
Pow /up_blocks.0/attentions.1/transformer_blocks.0/norm3/Pow
ReduceMean /up_blocks.0/attentions.1/transformer_blocks.0/norm3/ReduceMean_1
Add /up_blocks.0/attentions.1/transformer_blocks.0/norm3/Add
(1, 64, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1), dtype=tf.float32, name=None), name='tf.math.add_43/Add:0', description="created by layer 'tf.math.add_43'")
Sqrt /up_blocks.0/attentions.1/transformer_blocks.0/norm3/Sqrt
Div /up_blocks.0/attentions.1/transformer_blocks.0/norm3/Div
Mul /up_blocks.0/attentions.1/transformer_blocks.0/norm3/Mul
Add /up_blocks.0/attentions.1/transformer_blocks.0/norm3/Add_1
(1, 64, 1280)
(1280,) 1
[1, 64, 1]
1 1
1
64 1
64
1280 1280
1
tf.Tensor(
[[[ 0.05548452 -0.02559173 -0.07000685 ...  0.04776877 -0.02460399
   -0.0249457 ]
  [ 0.05548452 -0.02559173 -0.07000685 ...  0.04776877 -0.02460399
   -0.0249457 ]
  [ 0.05548452 -0.02559173 -0.07000685 ...  0.04776877 -0.02460399
   -0.0249457 ]
  ...
  [ 0.05548452 -0.02559173 -0.07000685 ...  0.04776877 -0.02460399
   -0.0249457 ]
  [ 0.05548452 -0.02559173 -0.07000685 ...  0.04776877 -0.02460399
   -0.0249457 ]
  [ 0.05548452 -0.02559173 -0.07000685 ...  0.04776877 -0.02460399
   -0.0249457 ]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_44/Add:0', description="created by layer 'tf.math.add_44'")
MatMul /up_blocks.0/attentions.1/transformer_blocks.0/ff/net.0/proj/MatMul
Add /up_blocks.0/attentions.1/transformer_blocks.0/ff/net.0/proj/Add
(10240,)
(1, 64, 10240) 3
[1, 64, 1]
tf.Tensor(
[[[ 0.01740025 -0.00361111  0.0120011  ... -0.06422418 -0.00062679
   -0.06703145]
  [ 0.01740025 -0.00361111  0.0120011  ... -0.06422418 -0.00062679
   -0.06703145]
  [ 0.01740025 -0.00361111  0.0120011  ... -0.06422418 -0.00062679
   -0.06703145]
  ...
  [ 0.01740025 -0.00361111  0.0120011  ... -0.06422418 -0.00062679
   -0.06703145]
  [ 0.01740025 -0.00361111  0.0120011  ... -0.06422418 -0.00062679
   -0.06703145]
  [ 0.01740025 -0.00361111  0.0120011  ... -0.06422418 -0.00062679
   -0.06703145]]], shape=(1, 64, 10240), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 10240), dtype=tf.float32, name=None), name='tf.math.add_45/Add:0', description="created by layer 'tf.math.add_45'")
Slice /up_blocks.0/attentions.1/transformer_blocks.0/ff/net.0/Slice
Slice /up_blocks.0/attentions.1/transformer_blocks.0/ff/net.0/Slice_1
Div /up_blocks.0/attentions.1/transformer_blocks.0/ff/net.0/Div_1
Erf /up_blocks.0/attentions.1/transformer_blocks.0/ff/net.0/Erf
Add /up_blocks.0/attentions.1/transformer_blocks.0/ff/net.0/Add_1
(1, 64, 5120)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 5120), dtype=tf.float32, name=None), name='tf.math.add_46/Add:0', description="created by layer 'tf.math.add_46'")
Mul /up_blocks.0/attentions.1/transformer_blocks.0/ff/net.0/Mul_2
Mul /up_blocks.0/attentions.1/transformer_blocks.0/ff/net.0/Mul_3
Mul /up_blocks.0/attentions.1/transformer_blocks.0/ff/net.0/Mul_4
MatMul /up_blocks.0/attentions.1/transformer_blocks.0/ff/net.2/MatMul
Add /up_blocks.0/attentions.1/transformer_blocks.0/ff/net.2/Add
(1280,)
(1, 64, 1280) 3
[1, 64, 1]
tf.Tensor(
[[[-0.00025266 -0.02822213 -0.01228393 ...  0.00846115  0.01014209
   -0.00705874]
  [-0.00025266 -0.02822213 -0.01228393 ...  0.00846115  0.01014209
   -0.00705874]
  [-0.00025266 -0.02822213 -0.01228393 ...  0.00846115  0.01014209
   -0.00705874]
  ...
  [-0.00025266 -0.02822213 -0.01228393 ...  0.00846115  0.01014209
   -0.00705874]
  [-0.00025266 -0.02822213 -0.01228393 ...  0.00846115  0.01014209
   -0.00705874]
  [-0.00025266 -0.02822213 -0.01228393 ...  0.00846115  0.01014209
   -0.00705874]]], shape=(1, 64, 1280), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_47/Add:0', description="created by layer 'tf.math.add_47'")
Add /up_blocks.0/attentions.1/transformer_blocks.0/Add_2
(1, 64, 1280)
(1, 64, 1280) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 64, 1280), dtype=tf.float32, name=None), name='tf.math.add_48/Add:0', description="created by layer 'tf.math.add_48'")
Reshape /up_blocks.0/attentions.1/Reshape_1
input_shape: (1, 64, 1280) total_elements: 81920
[   1    8    8 1280] 81920
Final shape: [   1    8    8 1280]
Transpose /up_blocks.0/attentions.1/Transpose_1
INFO:tensorflow:Assets written to: /tmp/tmpz1fdkcra/assets
INFO:tensorflow:Assets written to: /tmp/tmpz1fdkcra/assets
2024-07-29 19:39:22.182428: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:22.182481: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:22.182633: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpz1fdkcra
2024-07-29 19:39:22.185504: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:22.185540: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpz1fdkcra
2024-07-29 19:39:22.191073: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:22.248225: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpz1fdkcra
2024-07-29 19:39:22.261815: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 79181 microseconds.
2024-07-29 19:39:22.531328: W tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2073] TFLite interpreter needs to link Flex delegate in order to run the model since it contains the following Select TFop(s):
Flex ops: FlexErf
Details:
        tf.Erf(tensor<1x64x5120xf32>) -> (tensor<1x64x5120xf32>) : {device = ""}
See instructions: https://www.tensorflow.org/lite/guide/ops_select
2024-07-29 19:39:22.531400: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 4.133 G  ops, equivalently 2.066 G  MACs
2024-07-29 19:39:23.753621: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2024-07-29 19:39:23.753737: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1960] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
INFO:converter running::tflite model elements' max error is 2.2888E-05, pass, tflite saved in ./tflite/cpusubgraph21.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph21.onnx to ./tflite/cpusubgraph21.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph22.onnx
Checking 0/1...
Add /up_blocks.0/attentions.1/Add
(1, 1280, 8, 8)
(1, 1280, 8, 8) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 1280, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_49/Add:0', description="created by layer 'tf.math.add_49'")
Resize /up_blocks.0/upsamplers.0/Resize
1.0 1.0 2.0 2.0
KerasTensor(type_spec=TensorSpec(shape=(1, 8, 8, 1280), dtype=tf.float32, name=None), name='tf.compat.v1.transpose_30/transpose:0', description="created by layer 'tf.compat.v1.transpose_30'")
(16, 16)
nearest
INFO:tensorflow:Assets written to: /tmp/tmp_2sj_hgm/assets
INFO:tensorflow:Assets written to: /tmp/tmp_2sj_hgm/assets
2024-07-29 19:39:26.518729: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:26.518777: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:26.518894: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp_2sj_hgm
2024-07-29 19:39:26.519104: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:26.519127: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp_2sj_hgm
2024-07-29 19:39:26.519601: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:26.522720: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp_2sj_hgm
2024-07-29 19:39:26.525051: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 6158 microseconds.
2024-07-29 19:39:26.539344: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.082 M  ops, equivalently 0.041 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph22.onnx to ./tflite/cpusubgraph22.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph23.onnx
Checking 0/1...
Concat /up_blocks.1/Concat
Reshape /up_blocks.1/resnets.0/norm1/Reshape
input_shape: (1, 1920, 16, 16) total_elements: 491520
[ 0 32 -1] 32
final_shape: [1, 32, 15360] dynamic_dim_size: 15360
Final shape: [1, 32, 15360]
InstanceNormalization /up_blocks.1/resnets.0/norm1/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmpbzj2nxs4/assets
INFO:tensorflow:Assets written to: /tmp/tmpbzj2nxs4/assets
2024-07-29 19:39:26.776215: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:26.776266: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:26.776419: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpbzj2nxs4
2024-07-29 19:39:26.776812: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:26.776856: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpbzj2nxs4
2024-07-29 19:39:26.777778: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:26.782164: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpbzj2nxs4
2024-07-29 19:39:26.785117: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 8698 microseconds.
2024-07-29 19:39:26.801604: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.983 M  ops, equivalently 0.492 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph23.onnx to ./tflite/cpusubgraph23.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph24.onnx
Checking 0/1...
Gemm /up_blocks.1/resnets.0/time_emb_proj/Gemm
Unsqueeze /up_blocks.1/resnets.0/Unsqueeze_1
Add /up_blocks.1/resnets.0/Add
(1, 640, 16, 16)
(1, 640, 1) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 640, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_50/Add:0', description="created by layer 'tf.math.add_50'")
Reshape /up_blocks.1/resnets.0/norm2/Reshape
input_shape: (1, 640, 16, 16) total_elements: 163840
[ 0 32 -1] 32
final_shape: [1, 32, 5120] dynamic_dim_size: 5120
Final shape: [1, 32, 5120]
InstanceNormalization /up_blocks.1/resnets.0/norm2/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmpkvx9y6b8/assets
INFO:tensorflow:Assets written to: /tmp/tmpkvx9y6b8/assets
2024-07-29 19:39:27.146150: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:27.146197: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:27.146348: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpkvx9y6b8
2024-07-29 19:39:27.146757: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:27.146795: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpkvx9y6b8
2024-07-29 19:39:27.147999: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:27.157408: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpkvx9y6b8
2024-07-29 19:39:27.161199: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 14852 microseconds.
2024-07-29 19:39:27.190905: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 2.131 M  ops, equivalently 1.065 M  MACs
INFO:converter running::tflite model elements' max error is 1.2398E-05, pass, tflite saved in ./tflite/cpusubgraph24.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph24.onnx to ./tflite/cpusubgraph24.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph25.onnx
Checking 0/1...
InstanceNormalization /up_blocks.1/attentions.0/norm/InstanceNormalization
Reshape /up_blocks.1/attentions.0/norm/Reshape_1
input_shape: (1, 32, 5120) total_elements: 163840
[  1 640  16  16] 163840
Final shape: [  1 640  16  16]
INFO:tensorflow:Assets written to: /tmp/tmpi2n145ui/assets
INFO:tensorflow:Assets written to: /tmp/tmpi2n145ui/assets
2024-07-29 19:39:27.497730: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:27.497781: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:27.497946: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpi2n145ui
2024-07-29 19:39:27.498256: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:27.498291: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpi2n145ui
2024-07-29 19:39:27.499064: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:27.502851: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpi2n145ui
2024-07-29 19:39:27.505278: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 7333 microseconds.
2024-07-29 19:39:27.523035: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.328 M  ops, equivalently 0.164 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph25.onnx to ./tflite/cpusubgraph25.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph26.onnx
Checking 0/1...
Transpose /up_blocks.1/attentions.0/Transpose
Reshape /up_blocks.1/attentions.0/Reshape
input_shape: (1, 16, 16, 640) total_elements: 163840
[  1 256 640] 163840
Final shape: [  1 256 640]
ReduceMean /up_blocks.1/attentions.0/transformer_blocks.0/norm1/ReduceMean
Sub /up_blocks.1/attentions.0/transformer_blocks.0/norm1/Sub
Pow /up_blocks.1/attentions.0/transformer_blocks.0/norm1/Pow
ReduceMean /up_blocks.1/attentions.0/transformer_blocks.0/norm1/ReduceMean_1
Add /up_blocks.1/attentions.0/transformer_blocks.0/norm1/Add
(1, 256, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 1), dtype=tf.float32, name=None), name='tf.math.add_51/Add:0', description="created by layer 'tf.math.add_51'")
Sqrt /up_blocks.1/attentions.0/transformer_blocks.0/norm1/Sqrt
Div /up_blocks.1/attentions.0/transformer_blocks.0/norm1/Div
Mul /up_blocks.1/attentions.0/transformer_blocks.0/norm1/Mul
Add /up_blocks.1/attentions.0/transformer_blocks.0/norm1/Add_1
(1, 256, 640)
(640,) 1
[1, 256, 1]
1 1
1
256 1
256
640 640
1
tf.Tensor(
[[[ 0.07037923 -0.01497527  0.09506933 ...  0.01850983  0.00993056
   -0.07602566]
  [ 0.07037923 -0.01497527  0.09506933 ...  0.01850983  0.00993056
   -0.07602566]
  [ 0.07037923 -0.01497527  0.09506933 ...  0.01850983  0.00993056
   -0.07602566]
  ...
  [ 0.07037923 -0.01497527  0.09506933 ...  0.01850983  0.00993056
   -0.07602566]
  [ 0.07037923 -0.01497527  0.09506933 ...  0.01850983  0.00993056
   -0.07602566]
  [ 0.07037923 -0.01497527  0.09506933 ...  0.01850983  0.00993056
   -0.07602566]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_52/Add:0', description="created by layer 'tf.math.add_52'")
MatMul
Split
Reshape /up_blocks.1/attentions.0/transformer_blocks.0/attn1/Reshape
input_shape: (1, 256, 640) total_elements: 163840
[ 1 -1  8 80] 640
final_shape: [1, 256, 8, 80] dynamic_dim_size: 256
Final shape: [1, 256, 8, 80]
Transpose /up_blocks.1/attentions.0/transformer_blocks.0/attn1/Transpose
Reshape /up_blocks.1/attentions.0/transformer_blocks.0/attn1/Reshape_1
input_shape: (1, 256, 640) total_elements: 163840
[ 1 -1  8 80] 640
final_shape: [1, 256, 8, 80] dynamic_dim_size: 256
Final shape: [1, 256, 8, 80]
Reshape /up_blocks.1/attentions.0/transformer_blocks.0/attn1/Reshape_2
input_shape: (1, 256, 640) total_elements: 163840
[ 1 -1  8 80] 640
final_shape: [1, 256, 8, 80] dynamic_dim_size: 256
Final shape: [1, 256, 8, 80]
Transpose /up_blocks.1/attentions.0/transformer_blocks.0/attn1/Transpose_1
Transpose /up_blocks.1/attentions.0/transformer_blocks.0/attn1/Transpose_2
Mul /up_blocks.1/attentions.0/transformer_blocks.0/attn1/Mul
Mul /up_blocks.1/attentions.0/transformer_blocks.0/attn1/Mul_1
MatMul /up_blocks.1/attentions.0/transformer_blocks.0/attn1/MatMul
Softmax /up_blocks.1/attentions.0/transformer_blocks.0/attn1/Softmax
MatMul /up_blocks.1/attentions.0/transformer_blocks.0/attn1/MatMul_1
Transpose /up_blocks.1/attentions.0/transformer_blocks.0/attn1/Transpose_3
Reshape /up_blocks.1/attentions.0/transformer_blocks.0/attn1/Reshape_3
input_shape: (1, 256, 8, 80) total_elements: 163840
[  1  -1 640] 640
final_shape: [1, 256, 640] dynamic_dim_size: 256
Final shape: [1, 256, 640]
MatMul /up_blocks.1/attentions.0/transformer_blocks.0/attn1/to_out.0/MatMul
Add /up_blocks.1/attentions.0/transformer_blocks.0/attn1/to_out.0/Add
(640,)
(1, 256, 640) 3
[1, 256, 1]
tf.Tensor(
[[[ 0.0433797  -0.01103725 -0.00473097 ...  0.05648051 -0.01841973
    0.01199273]
  [ 0.0433797  -0.01103725 -0.00473097 ...  0.05648051 -0.01841973
    0.01199273]
  [ 0.0433797  -0.01103725 -0.00473097 ...  0.05648051 -0.01841973
    0.01199273]
  ...
  [ 0.0433797  -0.01103725 -0.00473097 ...  0.05648051 -0.01841973
    0.01199273]
  [ 0.0433797  -0.01103725 -0.00473097 ...  0.05648051 -0.01841973
    0.01199273]
  [ 0.0433797  -0.01103725 -0.00473097 ...  0.05648051 -0.01841973
    0.01199273]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_53/Add:0', description="created by layer 'tf.math.add_53'")
Add /up_blocks.1/attentions.0/transformer_blocks.0/Add
(1, 256, 640)
(1, 256, 640) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_54/Add:0', description="created by layer 'tf.math.add_54'")
ReduceMean /up_blocks.1/attentions.0/transformer_blocks.0/norm2/ReduceMean
Sub /up_blocks.1/attentions.0/transformer_blocks.0/norm2/Sub
Pow /up_blocks.1/attentions.0/transformer_blocks.0/norm2/Pow
ReduceMean /up_blocks.1/attentions.0/transformer_blocks.0/norm2/ReduceMean_1
Add /up_blocks.1/attentions.0/transformer_blocks.0/norm2/Add
(1, 256, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 1), dtype=tf.float32, name=None), name='tf.math.add_55/Add:0', description="created by layer 'tf.math.add_55'")
Sqrt /up_blocks.1/attentions.0/transformer_blocks.0/norm2/Sqrt
Div /up_blocks.1/attentions.0/transformer_blocks.0/norm2/Div
Mul /up_blocks.1/attentions.0/transformer_blocks.0/norm2/Mul
Add /up_blocks.1/attentions.0/transformer_blocks.0/norm2/Add_1
(1, 256, 640)
(640,) 1
[1, 256, 1]
1 1
1
256 1
256
640 640
1
tf.Tensor(
[[[-0.09000559  0.03584393 -0.22770227 ...  0.27127582  0.00161694
    0.20630191]
  [-0.09000559  0.03584393 -0.22770227 ...  0.27127582  0.00161694
    0.20630191]
  [-0.09000559  0.03584393 -0.22770227 ...  0.27127582  0.00161694
    0.20630191]
  ...
  [-0.09000559  0.03584393 -0.22770227 ...  0.27127582  0.00161694
    0.20630191]
  [-0.09000559  0.03584393 -0.22770227 ...  0.27127582  0.00161694
    0.20630191]
  [-0.09000559  0.03584393 -0.22770227 ...  0.27127582  0.00161694
    0.20630191]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_56/Add:0', description="created by layer 'tf.math.add_56'")
MatMul /up_blocks.1/attentions.0/transformer_blocks.0/attn2/to_q/MatMul
MatMul /up_blocks.1/attentions.0/transformer_blocks.0/attn2/to_k/MatMul
MatMul /up_blocks.1/attentions.0/transformer_blocks.0/attn2/to_v/MatMul
Reshape /up_blocks.1/attentions.0/transformer_blocks.0/attn2/Reshape
input_shape: (1, 256, 640) total_elements: 163840
[ 1 -1  8 80] 640
final_shape: [1, 256, 8, 80] dynamic_dim_size: 256
Final shape: [1, 256, 8, 80]
Transpose /up_blocks.1/attentions.0/transformer_blocks.0/attn2/Transpose
Reshape /up_blocks.1/attentions.0/transformer_blocks.0/attn2/Reshape_1
input_shape: (1, 77, 640) total_elements: 49280
[ 1 -1  8 80] 640
final_shape: [1, 77, 8, 80] dynamic_dim_size: 77
Final shape: [1, 77, 8, 80]
Reshape /up_blocks.1/attentions.0/transformer_blocks.0/attn2/Reshape_2
input_shape: (1, 77, 640) total_elements: 49280
[ 1 -1  8 80] 640
final_shape: [1, 77, 8, 80] dynamic_dim_size: 77
Final shape: [1, 77, 8, 80]
Transpose /up_blocks.1/attentions.0/transformer_blocks.0/attn2/Transpose_1
Transpose /up_blocks.1/attentions.0/transformer_blocks.0/attn2/Transpose_2
Mul /up_blocks.1/attentions.0/transformer_blocks.0/attn2/Mul
Mul /up_blocks.1/attentions.0/transformer_blocks.0/attn2/Mul_1
MatMul /up_blocks.1/attentions.0/transformer_blocks.0/attn2/MatMul
Softmax /up_blocks.1/attentions.0/transformer_blocks.0/attn2/Softmax
MatMul /up_blocks.1/attentions.0/transformer_blocks.0/attn2/MatMul_1
Transpose /up_blocks.1/attentions.0/transformer_blocks.0/attn2/Transpose_3
Reshape /up_blocks.1/attentions.0/transformer_blocks.0/attn2/Reshape_3
input_shape: (1, 256, 8, 80) total_elements: 163840
[  1  -1 640] 640
final_shape: [1, 256, 640] dynamic_dim_size: 256
Final shape: [1, 256, 640]
MatMul /up_blocks.1/attentions.0/transformer_blocks.0/attn2/to_out.0/MatMul
Add /up_blocks.1/attentions.0/transformer_blocks.0/attn2/to_out.0/Add
(640,)
(1, 256, 640) 3
[1, 256, 1]
tf.Tensor(
[[[ 0.05623039 -0.03583605  0.00255366 ...  0.01450208 -0.01468845
    0.00258982]
  [ 0.05623039 -0.03583605  0.00255366 ...  0.01450208 -0.01468845
    0.00258982]
  [ 0.05623039 -0.03583605  0.00255366 ...  0.01450208 -0.01468845
    0.00258982]
  ...
  [ 0.05623039 -0.03583605  0.00255366 ...  0.01450208 -0.01468845
    0.00258982]
  [ 0.05623039 -0.03583605  0.00255366 ...  0.01450208 -0.01468845
    0.00258982]
  [ 0.05623039 -0.03583605  0.00255366 ...  0.01450208 -0.01468845
    0.00258982]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_57/Add:0', description="created by layer 'tf.math.add_57'")
Add /up_blocks.1/attentions.0/transformer_blocks.0/Add_1
(1, 256, 640)
(1, 256, 640) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_58/Add:0', description="created by layer 'tf.math.add_58'")
ReduceMean /up_blocks.1/attentions.0/transformer_blocks.0/norm3/ReduceMean
Sub /up_blocks.1/attentions.0/transformer_blocks.0/norm3/Sub
Pow /up_blocks.1/attentions.0/transformer_blocks.0/norm3/Pow
ReduceMean /up_blocks.1/attentions.0/transformer_blocks.0/norm3/ReduceMean_1
Add /up_blocks.1/attentions.0/transformer_blocks.0/norm3/Add
(1, 256, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 1), dtype=tf.float32, name=None), name='tf.math.add_59/Add:0', description="created by layer 'tf.math.add_59'")
Sqrt /up_blocks.1/attentions.0/transformer_blocks.0/norm3/Sqrt
Div /up_blocks.1/attentions.0/transformer_blocks.0/norm3/Div
Mul /up_blocks.1/attentions.0/transformer_blocks.0/norm3/Mul
Add /up_blocks.1/attentions.0/transformer_blocks.0/norm3/Add_1
(1, 256, 640)
(640,) 1
[1, 256, 1]
1 1
1
256 1
256
640 640
1
tf.Tensor(
[[[-0.16468449  0.05725271  0.04191345 ...  0.12689878  0.03455805
    0.06713977]
  [-0.16468449  0.05725271  0.04191345 ...  0.12689878  0.03455805
    0.06713977]
  [-0.16468449  0.05725271  0.04191345 ...  0.12689878  0.03455805
    0.06713977]
  ...
  [-0.16468449  0.05725271  0.04191345 ...  0.12689878  0.03455805
    0.06713977]
  [-0.16468449  0.05725271  0.04191345 ...  0.12689878  0.03455805
    0.06713977]
  [-0.16468449  0.05725271  0.04191345 ...  0.12689878  0.03455805
    0.06713977]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_60/Add:0', description="created by layer 'tf.math.add_60'")
MatMul /up_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/proj/MatMul
Add /up_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/proj/Add
(5120,)
(1, 256, 5120) 3
[1, 256, 1]
tf.Tensor(
[[[ 0.00327668 -0.06928357  0.00314806 ...  0.03251294 -0.00903174
    0.0523205 ]
  [ 0.00327668 -0.06928357  0.00314806 ...  0.03251294 -0.00903174
    0.0523205 ]
  [ 0.00327668 -0.06928357  0.00314806 ...  0.03251294 -0.00903174
    0.0523205 ]
  ...
  [ 0.00327668 -0.06928357  0.00314806 ...  0.03251294 -0.00903174
    0.0523205 ]
  [ 0.00327668 -0.06928357  0.00314806 ...  0.03251294 -0.00903174
    0.0523205 ]
  [ 0.00327668 -0.06928357  0.00314806 ...  0.03251294 -0.00903174
    0.0523205 ]]], shape=(1, 256, 5120), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 5120), dtype=tf.float32, name=None), name='tf.math.add_61/Add:0', description="created by layer 'tf.math.add_61'")
Slice /up_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Slice
Slice /up_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Slice_1
Div /up_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Div_1
Erf /up_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Erf
Add /up_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Add_1
(1, 256, 2560)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 2560), dtype=tf.float32, name=None), name='tf.math.add_62/Add:0', description="created by layer 'tf.math.add_62'")
Mul /up_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Mul_2
Mul /up_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Mul_3
Mul /up_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Mul_4
MatMul /up_blocks.1/attentions.0/transformer_blocks.0/ff/net.2/MatMul
Add /up_blocks.1/attentions.0/transformer_blocks.0/ff/net.2/Add
(640,)
(1, 256, 640) 3
[1, 256, 1]
tf.Tensor(
[[[ 0.03073456  0.04109124  0.05059902 ...  0.04839407 -0.02266541
    0.03122376]
  [ 0.03073456  0.04109124  0.05059902 ...  0.04839407 -0.02266541
    0.03122376]
  [ 0.03073456  0.04109124  0.05059902 ...  0.04839407 -0.02266541
    0.03122376]
  ...
  [ 0.03073456  0.04109124  0.05059902 ...  0.04839407 -0.02266541
    0.03122376]
  [ 0.03073456  0.04109124  0.05059902 ...  0.04839407 -0.02266541
    0.03122376]
  [ 0.03073456  0.04109124  0.05059902 ...  0.04839407 -0.02266541
    0.03122376]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_63/Add:0', description="created by layer 'tf.math.add_63'")
Add /up_blocks.1/attentions.0/transformer_blocks.0/Add_2
(1, 256, 640)
(1, 256, 640) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_64/Add:0', description="created by layer 'tf.math.add_64'")
Reshape /up_blocks.1/attentions.0/Reshape_1
input_shape: (1, 256, 640) total_elements: 163840
[  1  16  16 640] 163840
Final shape: [  1  16  16 640]
Transpose /up_blocks.1/attentions.0/Transpose_1
INFO:tensorflow:Assets written to: /tmp/tmp_82x_2v4/assets
INFO:tensorflow:Assets written to: /tmp/tmp_82x_2v4/assets
2024-07-29 19:39:36.548175: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:36.548236: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:36.548425: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp_82x_2v4
2024-07-29 19:39:36.552936: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:36.552979: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp_82x_2v4
2024-07-29 19:39:36.558208: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:36.587775: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp_82x_2v4
2024-07-29 19:39:36.602292: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 53870 microseconds.
2024-07-29 19:39:36.730013: W tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2073] TFLite interpreter needs to link Flex delegate in order to run the model since it contains the following Select TFop(s):
Flex ops: FlexErf
Details:
        tf.Erf(tensor<1x256x2560xf32>) -> (tensor<1x256x2560xf32>) : {device = ""}
See instructions: https://www.tensorflow.org/lite/guide/ops_select
2024-07-29 19:39:36.730090: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 4.197 G  ops, equivalently 2.098 G  MACs
2024-07-29 19:39:37.250003: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2024-07-29 19:39:37.250053: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1960] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
INFO:converter running::tflite model elements' max error is 3.4332E-05, pass, tflite saved in ./tflite/cpusubgraph26.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph26.onnx to ./tflite/cpusubgraph26.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph27.onnx
Checking 0/1...
Add /up_blocks.1/attentions.0/Add
(1, 640, 16, 16)
(1, 640, 16, 16) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 640, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_65/Add:0', description="created by layer 'tf.math.add_65'")
Concat /up_blocks.1/Concat_1
Reshape /up_blocks.1/resnets.1/norm1/Reshape
input_shape: (1, 960, 16, 16) total_elements: 245760
[ 0 32 -1] 32
final_shape: [1, 32, 7680] dynamic_dim_size: 7680
Final shape: [1, 32, 7680]
InstanceNormalization /up_blocks.1/resnets.1/norm1/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmp3ssldg_o/assets
INFO:tensorflow:Assets written to: /tmp/tmp3ssldg_o/assets
2024-07-29 19:39:38.396455: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:38.396501: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:38.396644: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp3ssldg_o
2024-07-29 19:39:38.397061: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:38.397092: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp3ssldg_o
2024-07-29 19:39:38.397945: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:38.402675: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp3ssldg_o
2024-07-29 19:39:38.406254: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 9610 microseconds.
2024-07-29 19:39:38.422011: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.655 M  ops, equivalently 0.328 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph27.onnx to ./tflite/cpusubgraph27.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph28.onnx
Checking 0/1...
Gemm /up_blocks.1/resnets.1/time_emb_proj/Gemm
Unsqueeze /up_blocks.1/resnets.1/Unsqueeze_1
Add /up_blocks.1/resnets.1/Add
(1, 640, 16, 16)
(1, 640, 1) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 640, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_66/Add:0', description="created by layer 'tf.math.add_66'")
Reshape /up_blocks.1/resnets.1/norm2/Reshape
input_shape: (1, 640, 16, 16) total_elements: 163840
[ 0 32 -1] 32
final_shape: [1, 32, 5120] dynamic_dim_size: 5120
Final shape: [1, 32, 5120]
InstanceNormalization /up_blocks.1/resnets.1/norm2/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmpp5x2_dsp/assets
INFO:tensorflow:Assets written to: /tmp/tmpp5x2_dsp/assets
2024-07-29 19:39:38.736746: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:38.736794: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:38.736908: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpp5x2_dsp
2024-07-29 19:39:38.737375: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:38.737407: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpp5x2_dsp
2024-07-29 19:39:38.738383: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:38.748475: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpp5x2_dsp
2024-07-29 19:39:38.751833: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 14926 microseconds.
2024-07-29 19:39:38.783837: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 2.131 M  ops, equivalently 1.065 M  MACs
INFO:converter running::tflite model elements' max error is 1.1921E-05, pass, tflite saved in ./tflite/cpusubgraph28.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph28.onnx to ./tflite/cpusubgraph28.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph29.onnx
Checking 0/1...
InstanceNormalization /up_blocks.1/attentions.1/norm/InstanceNormalization
Reshape /up_blocks.1/attentions.1/norm/Reshape_1
input_shape: (1, 32, 5120) total_elements: 163840
[  1 640  16  16] 163840
Final shape: [  1 640  16  16]
INFO:tensorflow:Assets written to: /tmp/tmplu6bg1mf/assets
INFO:tensorflow:Assets written to: /tmp/tmplu6bg1mf/assets
2024-07-29 19:39:39.071022: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:39.071076: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:39.071192: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmplu6bg1mf
2024-07-29 19:39:39.071510: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:39.071537: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmplu6bg1mf
2024-07-29 19:39:39.072095: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:39.075369: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmplu6bg1mf
2024-07-29 19:39:39.079175: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 7983 microseconds.
2024-07-29 19:39:39.093005: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.328 M  ops, equivalently 0.164 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph29.onnx to ./tflite/cpusubgraph29.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph3.onnx
Checking 0/1...
Transpose /down_blocks.0/attentions.0/Transpose
Reshape /down_blocks.0/attentions.0/Reshape
input_shape: (1, 32, 32, 320) total_elements: 327680
[   1 1024  320] 327680
Final shape: [   1 1024  320]
ReduceMean /down_blocks.0/attentions.0/transformer_blocks.0/norm1/ReduceMean
Sub /down_blocks.0/attentions.0/transformer_blocks.0/norm1/Sub
Pow /down_blocks.0/attentions.0/transformer_blocks.0/norm1/Pow
ReduceMean /down_blocks.0/attentions.0/transformer_blocks.0/norm1/ReduceMean_1
Add /down_blocks.0/attentions.0/transformer_blocks.0/norm1/Add
(1, 1024, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 1), dtype=tf.float32, name=None), name='tf.math.add_67/Add:0', description="created by layer 'tf.math.add_67'")
Sqrt /down_blocks.0/attentions.0/transformer_blocks.0/norm1/Sqrt
Div /down_blocks.0/attentions.0/transformer_blocks.0/norm1/Div
Mul /down_blocks.0/attentions.0/transformer_blocks.0/norm1/Mul
Add /down_blocks.0/attentions.0/transformer_blocks.0/norm1/Add_1
(1, 1024, 320)
(320,) 1
[1, 1024, 1]
1 1
1
1024 1
1024
320 320
1
tf.Tensor(
[[[ 0.03821855 -0.10763684 -0.00216686 ... -0.20209499  0.13759118
    0.12906313]
  [ 0.03821855 -0.10763684 -0.00216686 ... -0.20209499  0.13759118
    0.12906313]
  [ 0.03821855 -0.10763684 -0.00216686 ... -0.20209499  0.13759118
    0.12906313]
  ...
  [ 0.03821855 -0.10763684 -0.00216686 ... -0.20209499  0.13759118
    0.12906313]
  [ 0.03821855 -0.10763684 -0.00216686 ... -0.20209499  0.13759118
    0.12906313]
  [ 0.03821855 -0.10763684 -0.00216686 ... -0.20209499  0.13759118
    0.12906313]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_68/Add:0', description="created by layer 'tf.math.add_68'")
MatMul
Split
Reshape /down_blocks.0/attentions.0/transformer_blocks.0/attn1/Reshape
input_shape: (1, 1024, 320) total_elements: 327680
[ 1 -1  8 40] 320
final_shape: [1, 1024, 8, 40] dynamic_dim_size: 1024
Final shape: [1, 1024, 8, 40]
Transpose /down_blocks.0/attentions.0/transformer_blocks.0/attn1/Transpose
Reshape /down_blocks.0/attentions.0/transformer_blocks.0/attn1/Reshape_1
input_shape: (1, 1024, 320) total_elements: 327680
[ 1 -1  8 40] 320
final_shape: [1, 1024, 8, 40] dynamic_dim_size: 1024
Final shape: [1, 1024, 8, 40]
Reshape /down_blocks.0/attentions.0/transformer_blocks.0/attn1/Reshape_2
input_shape: (1, 1024, 320) total_elements: 327680
[ 1 -1  8 40] 320
final_shape: [1, 1024, 8, 40] dynamic_dim_size: 1024
Final shape: [1, 1024, 8, 40]
Transpose /down_blocks.0/attentions.0/transformer_blocks.0/attn1/Transpose_1
Transpose /down_blocks.0/attentions.0/transformer_blocks.0/attn1/Transpose_2
Mul /down_blocks.0/attentions.0/transformer_blocks.0/attn1/Mul
Mul /down_blocks.0/attentions.0/transformer_blocks.0/attn1/Mul_1
MatMul /down_blocks.0/attentions.0/transformer_blocks.0/attn1/MatMul
Softmax /down_blocks.0/attentions.0/transformer_blocks.0/attn1/Softmax
MatMul /down_blocks.0/attentions.0/transformer_blocks.0/attn1/MatMul_1
Transpose /down_blocks.0/attentions.0/transformer_blocks.0/attn1/Transpose_3
Reshape /down_blocks.0/attentions.0/transformer_blocks.0/attn1/Reshape_3
input_shape: (1, 1024, 8, 40) total_elements: 327680
[  1  -1 320] 320
final_shape: [1, 1024, 320] dynamic_dim_size: 1024
Final shape: [1, 1024, 320]
MatMul /down_blocks.0/attentions.0/transformer_blocks.0/attn1/to_out.0/MatMul
Add /down_blocks.0/attentions.0/transformer_blocks.0/attn1/to_out.0/Add
(320,)
(1, 1024, 320) 3
[1, 1024, 1]
tf.Tensor(
[[[ 0.05001631  0.00739455  0.04704607 ... -0.01164129  0.00481148
   -0.03093023]
  [ 0.05001631  0.00739455  0.04704607 ... -0.01164129  0.00481148
   -0.03093023]
  [ 0.05001631  0.00739455  0.04704607 ... -0.01164129  0.00481148
   -0.03093023]
  ...
  [ 0.05001631  0.00739455  0.04704607 ... -0.01164129  0.00481148
   -0.03093023]
  [ 0.05001631  0.00739455  0.04704607 ... -0.01164129  0.00481148
   -0.03093023]
  [ 0.05001631  0.00739455  0.04704607 ... -0.01164129  0.00481148
   -0.03093023]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_69/Add:0', description="created by layer 'tf.math.add_69'")
Add /down_blocks.0/attentions.0/transformer_blocks.0/Add
(1, 1024, 320)
(1, 1024, 320) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_70/Add:0', description="created by layer 'tf.math.add_70'")
ReduceMean /down_blocks.0/attentions.0/transformer_blocks.0/norm2/ReduceMean
Sub /down_blocks.0/attentions.0/transformer_blocks.0/norm2/Sub
Pow /down_blocks.0/attentions.0/transformer_blocks.0/norm2/Pow
ReduceMean /down_blocks.0/attentions.0/transformer_blocks.0/norm2/ReduceMean_1
Add /down_blocks.0/attentions.0/transformer_blocks.0/norm2/Add
(1, 1024, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 1), dtype=tf.float32, name=None), name='tf.math.add_71/Add:0', description="created by layer 'tf.math.add_71'")
Sqrt /down_blocks.0/attentions.0/transformer_blocks.0/norm2/Sqrt
Div /down_blocks.0/attentions.0/transformer_blocks.0/norm2/Div
Mul /down_blocks.0/attentions.0/transformer_blocks.0/norm2/Mul
Add /down_blocks.0/attentions.0/transformer_blocks.0/norm2/Add_1
(1, 1024, 320)
(320,) 1
[1, 1024, 1]
1 1
1
1024 1
1024
320 320
1
tf.Tensor(
[[[-0.11508901 -0.06108128 -0.10381826 ... -0.16721657 -0.11028432
    0.07316578]
  [-0.11508901 -0.06108128 -0.10381826 ... -0.16721657 -0.11028432
    0.07316578]
  [-0.11508901 -0.06108128 -0.10381826 ... -0.16721657 -0.11028432
    0.07316578]
  ...
  [-0.11508901 -0.06108128 -0.10381826 ... -0.16721657 -0.11028432
    0.07316578]
  [-0.11508901 -0.06108128 -0.10381826 ... -0.16721657 -0.11028432
    0.07316578]
  [-0.11508901 -0.06108128 -0.10381826 ... -0.16721657 -0.11028432
    0.07316578]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_72/Add:0', description="created by layer 'tf.math.add_72'")
MatMul /down_blocks.0/attentions.0/transformer_blocks.0/attn2/to_q/MatMul
MatMul /down_blocks.0/attentions.0/transformer_blocks.0/attn2/to_k/MatMul
MatMul /down_blocks.0/attentions.0/transformer_blocks.0/attn2/to_v/MatMul
Reshape /down_blocks.0/attentions.0/transformer_blocks.0/attn2/Reshape
input_shape: (1, 1024, 320) total_elements: 327680
[ 1 -1  8 40] 320
final_shape: [1, 1024, 8, 40] dynamic_dim_size: 1024
Final shape: [1, 1024, 8, 40]
Transpose /down_blocks.0/attentions.0/transformer_blocks.0/attn2/Transpose
Reshape /down_blocks.0/attentions.0/transformer_blocks.0/attn2/Reshape_1
input_shape: (1, 77, 320) total_elements: 24640
[ 1 -1  8 40] 320
final_shape: [1, 77, 8, 40] dynamic_dim_size: 77
Final shape: [1, 77, 8, 40]
Reshape /down_blocks.0/attentions.0/transformer_blocks.0/attn2/Reshape_2
input_shape: (1, 77, 320) total_elements: 24640
[ 1 -1  8 40] 320
final_shape: [1, 77, 8, 40] dynamic_dim_size: 77
Final shape: [1, 77, 8, 40]
Transpose /down_blocks.0/attentions.0/transformer_blocks.0/attn2/Transpose_1
Transpose /down_blocks.0/attentions.0/transformer_blocks.0/attn2/Transpose_2
Mul /down_blocks.0/attentions.0/transformer_blocks.0/attn2/Mul
Mul /down_blocks.0/attentions.0/transformer_blocks.0/attn2/Mul_1
MatMul /down_blocks.0/attentions.0/transformer_blocks.0/attn2/MatMul
Softmax /down_blocks.0/attentions.0/transformer_blocks.0/attn2/Softmax
MatMul /down_blocks.0/attentions.0/transformer_blocks.0/attn2/MatMul_1
Transpose /down_blocks.0/attentions.0/transformer_blocks.0/attn2/Transpose_3
Reshape /down_blocks.0/attentions.0/transformer_blocks.0/attn2/Reshape_3
input_shape: (1, 1024, 8, 40) total_elements: 327680
[  1  -1 320] 320
final_shape: [1, 1024, 320] dynamic_dim_size: 1024
Final shape: [1, 1024, 320]
MatMul /down_blocks.0/attentions.0/transformer_blocks.0/attn2/to_out.0/MatMul
Add /down_blocks.0/attentions.0/transformer_blocks.0/attn2/to_out.0/Add
(320,)
(1, 1024, 320) 3
[1, 1024, 1]
tf.Tensor(
[[[ 0.02691638 -0.0101165  -0.000683   ...  0.01603715  0.00108193
   -0.01468844]
  [ 0.02691638 -0.0101165  -0.000683   ...  0.01603715  0.00108193
   -0.01468844]
  [ 0.02691638 -0.0101165  -0.000683   ...  0.01603715  0.00108193
   -0.01468844]
  ...
  [ 0.02691638 -0.0101165  -0.000683   ...  0.01603715  0.00108193
   -0.01468844]
  [ 0.02691638 -0.0101165  -0.000683   ...  0.01603715  0.00108193
   -0.01468844]
  [ 0.02691638 -0.0101165  -0.000683   ...  0.01603715  0.00108193
   -0.01468844]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_73/Add:0', description="created by layer 'tf.math.add_73'")
Add /down_blocks.0/attentions.0/transformer_blocks.0/Add_1
(1, 1024, 320)
(1, 1024, 320) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_74/Add:0', description="created by layer 'tf.math.add_74'")
ReduceMean /down_blocks.0/attentions.0/transformer_blocks.0/norm3/ReduceMean
Sub /down_blocks.0/attentions.0/transformer_blocks.0/norm3/Sub
Pow /down_blocks.0/attentions.0/transformer_blocks.0/norm3/Pow
ReduceMean /down_blocks.0/attentions.0/transformer_blocks.0/norm3/ReduceMean_1
Add /down_blocks.0/attentions.0/transformer_blocks.0/norm3/Add
(1, 1024, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 1), dtype=tf.float32, name=None), name='tf.math.add_75/Add:0', description="created by layer 'tf.math.add_75'")
Sqrt /down_blocks.0/attentions.0/transformer_blocks.0/norm3/Sqrt
Div /down_blocks.0/attentions.0/transformer_blocks.0/norm3/Div
Mul /down_blocks.0/attentions.0/transformer_blocks.0/norm3/Mul
Add /down_blocks.0/attentions.0/transformer_blocks.0/norm3/Add_1
(1, 1024, 320)
(320,) 1
[1, 1024, 1]
1 1
1
1024 1
1024
320 320
1
tf.Tensor(
[[[-0.14556953 -0.02427667  0.01094841 ... -0.09349435  0.01024445
    0.09174955]
  [-0.14556953 -0.02427667  0.01094841 ... -0.09349435  0.01024445
    0.09174955]
  [-0.14556953 -0.02427667  0.01094841 ... -0.09349435  0.01024445
    0.09174955]
  ...
  [-0.14556953 -0.02427667  0.01094841 ... -0.09349435  0.01024445
    0.09174955]
  [-0.14556953 -0.02427667  0.01094841 ... -0.09349435  0.01024445
    0.09174955]
  [-0.14556953 -0.02427667  0.01094841 ... -0.09349435  0.01024445
    0.09174955]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_76/Add:0', description="created by layer 'tf.math.add_76'")
MatMul /down_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/proj/MatMul
Add /down_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/proj/Add
(2560,)
(1, 1024, 2560) 3
[1, 1024, 1]
tf.Tensor(
[[[ 0.00642097  0.07633297  0.01745356 ... -0.0438595   0.02466338
    0.04188295]
  [ 0.00642097  0.07633297  0.01745356 ... -0.0438595   0.02466338
    0.04188295]
  [ 0.00642097  0.07633297  0.01745356 ... -0.0438595   0.02466338
    0.04188295]
  ...
  [ 0.00642097  0.07633297  0.01745356 ... -0.0438595   0.02466338
    0.04188295]
  [ 0.00642097  0.07633297  0.01745356 ... -0.0438595   0.02466338
    0.04188295]
  [ 0.00642097  0.07633297  0.01745356 ... -0.0438595   0.02466338
    0.04188295]]], shape=(1, 1024, 2560), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 2560), dtype=tf.float32, name=None), name='tf.math.add_77/Add:0', description="created by layer 'tf.math.add_77'")
Slice /down_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Slice
Slice /down_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Slice_1
Div /down_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Div_1
Erf /down_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Erf
Add /down_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Add_1
(1, 1024, 1280)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 1280), dtype=tf.float32, name=None), name='tf.math.add_78/Add:0', description="created by layer 'tf.math.add_78'")
Mul /down_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Mul_2
Mul /down_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Mul_3
Mul /down_blocks.0/attentions.0/transformer_blocks.0/ff/net.0/Mul_4
MatMul /down_blocks.0/attentions.0/transformer_blocks.0/ff/net.2/MatMul
Add /down_blocks.0/attentions.0/transformer_blocks.0/ff/net.2/Add
(320,)
(1, 1024, 320) 3
[1, 1024, 1]
tf.Tensor(
[[[-0.01558106  0.00408291 -0.02325306 ...  0.00208002 -0.00468494
    0.03538062]
  [-0.01558106  0.00408291 -0.02325306 ...  0.00208002 -0.00468494
    0.03538062]
  [-0.01558106  0.00408291 -0.02325306 ...  0.00208002 -0.00468494
    0.03538062]
  ...
  [-0.01558106  0.00408291 -0.02325306 ...  0.00208002 -0.00468494
    0.03538062]
  [-0.01558106  0.00408291 -0.02325306 ...  0.00208002 -0.00468494
    0.03538062]
  [-0.01558106  0.00408291 -0.02325306 ...  0.00208002 -0.00468494
    0.03538062]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_79/Add:0', description="created by layer 'tf.math.add_79'")
Add /down_blocks.0/attentions.0/transformer_blocks.0/Add_2
(1, 1024, 320)
(1, 1024, 320) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_80/Add:0', description="created by layer 'tf.math.add_80'")
Reshape /down_blocks.0/attentions.0/Reshape_1
input_shape: (1, 1024, 320) total_elements: 327680
[  1  32  32 320] 327680
Final shape: [  1  32  32 320]
Transpose /down_blocks.0/attentions.0/Transpose_1
INFO:tensorflow:Assets written to: /tmp/tmp38z234fh/assets
INFO:tensorflow:Assets written to: /tmp/tmp38z234fh/assets
2024-07-29 19:39:55.289935: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:39:55.290010: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:39:55.290162: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp38z234fh
2024-07-29 19:39:55.293946: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:39:55.293986: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp38z234fh
2024-07-29 19:39:55.301832: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:39:55.327796: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp38z234fh
2024-07-29 19:39:55.341226: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 51064 microseconds.
2024-07-29 19:39:55.445761: W tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2073] TFLite interpreter needs to link Flex delegate in order to run the model since it contains the following Select TFop(s):
Flex ops: FlexErf
Details:
        tf.Erf(tensor<1x1024x1280xf32>) -> (tensor<1x1024x1280xf32>) : {device = ""}
See instructions: https://www.tensorflow.org/lite/guide/ops_select
2024-07-29 19:39:55.445857: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 5.888 G  ops, equivalently 2.944 G  MACs
2024-07-29 19:39:55.884965: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2024-07-29 19:39:55.885024: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1960] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
INFO:converter running::tflite model elements' max error is 5.2452E-06, pass, tflite saved in ./tflite/cpusubgraph3.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph3.onnx to ./tflite/cpusubgraph3.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph30.onnx
Checking 0/1...
Transpose /up_blocks.1/attentions.1/Transpose
Reshape /up_blocks.1/attentions.1/Reshape
input_shape: (1, 16, 16, 640) total_elements: 163840
[  1 256 640] 163840
Final shape: [  1 256 640]
ReduceMean /up_blocks.1/attentions.1/transformer_blocks.0/norm1/ReduceMean
Sub /up_blocks.1/attentions.1/transformer_blocks.0/norm1/Sub
Pow /up_blocks.1/attentions.1/transformer_blocks.0/norm1/Pow
ReduceMean /up_blocks.1/attentions.1/transformer_blocks.0/norm1/ReduceMean_1
Add /up_blocks.1/attentions.1/transformer_blocks.0/norm1/Add
(1, 256, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 1), dtype=tf.float32, name=None), name='tf.math.add_81/Add:0', description="created by layer 'tf.math.add_81'")
Sqrt /up_blocks.1/attentions.1/transformer_blocks.0/norm1/Sqrt
Div /up_blocks.1/attentions.1/transformer_blocks.0/norm1/Div
Mul /up_blocks.1/attentions.1/transformer_blocks.0/norm1/Mul
Add /up_blocks.1/attentions.1/transformer_blocks.0/norm1/Add_1
(1, 256, 640)
(640,) 1
[1, 256, 1]
1 1
1
256 1
256
640 640
1
tf.Tensor(
[[[ 0.00168217 -0.03704486 -0.0262391  ...  0.02733281  0.06875263
    0.0138579 ]
  [ 0.00168217 -0.03704486 -0.0262391  ...  0.02733281  0.06875263
    0.0138579 ]
  [ 0.00168217 -0.03704486 -0.0262391  ...  0.02733281  0.06875263
    0.0138579 ]
  ...
  [ 0.00168217 -0.03704486 -0.0262391  ...  0.02733281  0.06875263
    0.0138579 ]
  [ 0.00168217 -0.03704486 -0.0262391  ...  0.02733281  0.06875263
    0.0138579 ]
  [ 0.00168217 -0.03704486 -0.0262391  ...  0.02733281  0.06875263
    0.0138579 ]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_82/Add:0', description="created by layer 'tf.math.add_82'")
MatMul
Split
Reshape /up_blocks.1/attentions.1/transformer_blocks.0/attn1/Reshape
input_shape: (1, 256, 640) total_elements: 163840
[ 1 -1  8 80] 640
final_shape: [1, 256, 8, 80] dynamic_dim_size: 256
Final shape: [1, 256, 8, 80]
Transpose /up_blocks.1/attentions.1/transformer_blocks.0/attn1/Transpose
Reshape /up_blocks.1/attentions.1/transformer_blocks.0/attn1/Reshape_1
input_shape: (1, 256, 640) total_elements: 163840
[ 1 -1  8 80] 640
final_shape: [1, 256, 8, 80] dynamic_dim_size: 256
Final shape: [1, 256, 8, 80]
Reshape /up_blocks.1/attentions.1/transformer_blocks.0/attn1/Reshape_2
input_shape: (1, 256, 640) total_elements: 163840
[ 1 -1  8 80] 640
final_shape: [1, 256, 8, 80] dynamic_dim_size: 256
Final shape: [1, 256, 8, 80]
Transpose /up_blocks.1/attentions.1/transformer_blocks.0/attn1/Transpose_1
Transpose /up_blocks.1/attentions.1/transformer_blocks.0/attn1/Transpose_2
Mul /up_blocks.1/attentions.1/transformer_blocks.0/attn1/Mul
Mul /up_blocks.1/attentions.1/transformer_blocks.0/attn1/Mul_1
MatMul /up_blocks.1/attentions.1/transformer_blocks.0/attn1/MatMul
Softmax /up_blocks.1/attentions.1/transformer_blocks.0/attn1/Softmax
MatMul /up_blocks.1/attentions.1/transformer_blocks.0/attn1/MatMul_1
Transpose /up_blocks.1/attentions.1/transformer_blocks.0/attn1/Transpose_3
Reshape /up_blocks.1/attentions.1/transformer_blocks.0/attn1/Reshape_3
input_shape: (1, 256, 8, 80) total_elements: 163840
[  1  -1 640] 640
final_shape: [1, 256, 640] dynamic_dim_size: 256
Final shape: [1, 256, 640]
MatMul /up_blocks.1/attentions.1/transformer_blocks.0/attn1/to_out.0/MatMul
Add /up_blocks.1/attentions.1/transformer_blocks.0/attn1/to_out.0/Add
(640,)
(1, 256, 640) 3
[1, 256, 1]
tf.Tensor(
[[[ 0.0020165  -0.01602387 -0.01499193 ...  0.00110798  0.00765448
    0.04912923]
  [ 0.0020165  -0.01602387 -0.01499193 ...  0.00110798  0.00765448
    0.04912923]
  [ 0.0020165  -0.01602387 -0.01499193 ...  0.00110798  0.00765448
    0.04912923]
  ...
  [ 0.0020165  -0.01602387 -0.01499193 ...  0.00110798  0.00765448
    0.04912923]
  [ 0.0020165  -0.01602387 -0.01499193 ...  0.00110798  0.00765448
    0.04912923]
  [ 0.0020165  -0.01602387 -0.01499193 ...  0.00110798  0.00765448
    0.04912923]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_83/Add:0', description="created by layer 'tf.math.add_83'")
Add /up_blocks.1/attentions.1/transformer_blocks.0/Add
(1, 256, 640)
(1, 256, 640) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_84/Add:0', description="created by layer 'tf.math.add_84'")
ReduceMean /up_blocks.1/attentions.1/transformer_blocks.0/norm2/ReduceMean
Sub /up_blocks.1/attentions.1/transformer_blocks.0/norm2/Sub
Pow /up_blocks.1/attentions.1/transformer_blocks.0/norm2/Pow
ReduceMean /up_blocks.1/attentions.1/transformer_blocks.0/norm2/ReduceMean_1
Add /up_blocks.1/attentions.1/transformer_blocks.0/norm2/Add
(1, 256, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 1), dtype=tf.float32, name=None), name='tf.math.add_85/Add:0', description="created by layer 'tf.math.add_85'")
Sqrt /up_blocks.1/attentions.1/transformer_blocks.0/norm2/Sqrt
Div /up_blocks.1/attentions.1/transformer_blocks.0/norm2/Div
Mul /up_blocks.1/attentions.1/transformer_blocks.0/norm2/Mul
Add /up_blocks.1/attentions.1/transformer_blocks.0/norm2/Add_1
(1, 256, 640)
(640,) 1
[1, 256, 1]
1 1
1
256 1
256
640 640
1
tf.Tensor(
[[[ 0.10610861 -0.02011513 -0.09035008 ...  0.02942251  0.13034923
    0.14934213]
  [ 0.10610861 -0.02011513 -0.09035008 ...  0.02942251  0.13034923
    0.14934213]
  [ 0.10610861 -0.02011513 -0.09035008 ...  0.02942251  0.13034923
    0.14934213]
  ...
  [ 0.10610861 -0.02011513 -0.09035008 ...  0.02942251  0.13034923
    0.14934213]
  [ 0.10610861 -0.02011513 -0.09035008 ...  0.02942251  0.13034923
    0.14934213]
  [ 0.10610861 -0.02011513 -0.09035008 ...  0.02942251  0.13034923
    0.14934213]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_86/Add:0', description="created by layer 'tf.math.add_86'")
MatMul /up_blocks.1/attentions.1/transformer_blocks.0/attn2/to_q/MatMul
MatMul /up_blocks.1/attentions.1/transformer_blocks.0/attn2/to_k/MatMul
MatMul /up_blocks.1/attentions.1/transformer_blocks.0/attn2/to_v/MatMul
Reshape /up_blocks.1/attentions.1/transformer_blocks.0/attn2/Reshape
input_shape: (1, 256, 640) total_elements: 163840
[ 1 -1  8 80] 640
final_shape: [1, 256, 8, 80] dynamic_dim_size: 256
Final shape: [1, 256, 8, 80]
Transpose /up_blocks.1/attentions.1/transformer_blocks.0/attn2/Transpose
Reshape /up_blocks.1/attentions.1/transformer_blocks.0/attn2/Reshape_1
input_shape: (1, 77, 640) total_elements: 49280
[ 1 -1  8 80] 640
final_shape: [1, 77, 8, 80] dynamic_dim_size: 77
Final shape: [1, 77, 8, 80]
Reshape /up_blocks.1/attentions.1/transformer_blocks.0/attn2/Reshape_2
input_shape: (1, 77, 640) total_elements: 49280
[ 1 -1  8 80] 640
final_shape: [1, 77, 8, 80] dynamic_dim_size: 77
Final shape: [1, 77, 8, 80]
Transpose /up_blocks.1/attentions.1/transformer_blocks.0/attn2/Transpose_1
Transpose /up_blocks.1/attentions.1/transformer_blocks.0/attn2/Transpose_2
Mul /up_blocks.1/attentions.1/transformer_blocks.0/attn2/Mul
Mul /up_blocks.1/attentions.1/transformer_blocks.0/attn2/Mul_1
MatMul /up_blocks.1/attentions.1/transformer_blocks.0/attn2/MatMul
Softmax /up_blocks.1/attentions.1/transformer_blocks.0/attn2/Softmax
MatMul /up_blocks.1/attentions.1/transformer_blocks.0/attn2/MatMul_1
Transpose /up_blocks.1/attentions.1/transformer_blocks.0/attn2/Transpose_3
Reshape /up_blocks.1/attentions.1/transformer_blocks.0/attn2/Reshape_3
input_shape: (1, 256, 8, 80) total_elements: 163840
[  1  -1 640] 640
final_shape: [1, 256, 640] dynamic_dim_size: 256
Final shape: [1, 256, 640]
MatMul /up_blocks.1/attentions.1/transformer_blocks.0/attn2/to_out.0/MatMul
Add /up_blocks.1/attentions.1/transformer_blocks.0/attn2/to_out.0/Add
(640,)
(1, 256, 640) 3
[1, 256, 1]
tf.Tensor(
[[[ 0.0134784  -0.02381157  0.00399636 ...  0.00642069  0.00612979
    0.0187199 ]
  [ 0.0134784  -0.02381157  0.00399636 ...  0.00642069  0.00612979
    0.0187199 ]
  [ 0.0134784  -0.02381157  0.00399636 ...  0.00642069  0.00612979
    0.0187199 ]
  ...
  [ 0.0134784  -0.02381157  0.00399636 ...  0.00642069  0.00612979
    0.0187199 ]
  [ 0.0134784  -0.02381157  0.00399636 ...  0.00642069  0.00612979
    0.0187199 ]
  [ 0.0134784  -0.02381157  0.00399636 ...  0.00642069  0.00612979
    0.0187199 ]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_87/Add:0', description="created by layer 'tf.math.add_87'")
Add /up_blocks.1/attentions.1/transformer_blocks.0/Add_1
(1, 256, 640)
(1, 256, 640) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_88/Add:0', description="created by layer 'tf.math.add_88'")
ReduceMean /up_blocks.1/attentions.1/transformer_blocks.0/norm3/ReduceMean
Sub /up_blocks.1/attentions.1/transformer_blocks.0/norm3/Sub
Pow /up_blocks.1/attentions.1/transformer_blocks.0/norm3/Pow
ReduceMean /up_blocks.1/attentions.1/transformer_blocks.0/norm3/ReduceMean_1
Add /up_blocks.1/attentions.1/transformer_blocks.0/norm3/Add
(1, 256, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 1), dtype=tf.float32, name=None), name='tf.math.add_89/Add:0', description="created by layer 'tf.math.add_89'")
Sqrt /up_blocks.1/attentions.1/transformer_blocks.0/norm3/Sqrt
Div /up_blocks.1/attentions.1/transformer_blocks.0/norm3/Div
Mul /up_blocks.1/attentions.1/transformer_blocks.0/norm3/Mul
Add /up_blocks.1/attentions.1/transformer_blocks.0/norm3/Add_1
(1, 256, 640)
(640,) 1
[1, 256, 1]
1 1
1
256 1
256
640 640
1
tf.Tensor(
[[[ 0.01036125  0.01119211 -0.00947587 ...  0.02044859  0.04659271
   -0.05586819]
  [ 0.01036125  0.01119211 -0.00947587 ...  0.02044859  0.04659271
   -0.05586819]
  [ 0.01036125  0.01119211 -0.00947587 ...  0.02044859  0.04659271
   -0.05586819]
  ...
  [ 0.01036125  0.01119211 -0.00947587 ...  0.02044859  0.04659271
   -0.05586819]
  [ 0.01036125  0.01119211 -0.00947587 ...  0.02044859  0.04659271
   -0.05586819]
  [ 0.01036125  0.01119211 -0.00947587 ...  0.02044859  0.04659271
   -0.05586819]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_90/Add:0', description="created by layer 'tf.math.add_90'")
MatMul /up_blocks.1/attentions.1/transformer_blocks.0/ff/net.0/proj/MatMul
Add /up_blocks.1/attentions.1/transformer_blocks.0/ff/net.0/proj/Add
(5120,)
(1, 256, 5120) 3
[1, 256, 1]
tf.Tensor(
[[[-0.01733442  0.00842729  0.03002361 ...  0.02361257 -0.00449806
   -0.01011283]
  [-0.01733442  0.00842729  0.03002361 ...  0.02361257 -0.00449806
   -0.01011283]
  [-0.01733442  0.00842729  0.03002361 ...  0.02361257 -0.00449806
   -0.01011283]
  ...
  [-0.01733442  0.00842729  0.03002361 ...  0.02361257 -0.00449806
   -0.01011283]
  [-0.01733442  0.00842729  0.03002361 ...  0.02361257 -0.00449806
   -0.01011283]
  [-0.01733442  0.00842729  0.03002361 ...  0.02361257 -0.00449806
   -0.01011283]]], shape=(1, 256, 5120), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 5120), dtype=tf.float32, name=None), name='tf.math.add_91/Add:0', description="created by layer 'tf.math.add_91'")
Slice /up_blocks.1/attentions.1/transformer_blocks.0/ff/net.0/Slice
Slice /up_blocks.1/attentions.1/transformer_blocks.0/ff/net.0/Slice_1
Div /up_blocks.1/attentions.1/transformer_blocks.0/ff/net.0/Div_1
Erf /up_blocks.1/attentions.1/transformer_blocks.0/ff/net.0/Erf
Add /up_blocks.1/attentions.1/transformer_blocks.0/ff/net.0/Add_1
(1, 256, 2560)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 2560), dtype=tf.float32, name=None), name='tf.math.add_92/Add:0', description="created by layer 'tf.math.add_92'")
Mul /up_blocks.1/attentions.1/transformer_blocks.0/ff/net.0/Mul_2
Mul /up_blocks.1/attentions.1/transformer_blocks.0/ff/net.0/Mul_3
Mul /up_blocks.1/attentions.1/transformer_blocks.0/ff/net.0/Mul_4
MatMul /up_blocks.1/attentions.1/transformer_blocks.0/ff/net.2/MatMul
Add /up_blocks.1/attentions.1/transformer_blocks.0/ff/net.2/Add
(640,)
(1, 256, 640) 3
[1, 256, 1]
tf.Tensor(
[[[ 0.00305659 -0.00335002  0.00523615 ... -0.00389782  0.0001622
   -0.01102754]
  [ 0.00305659 -0.00335002  0.00523615 ... -0.00389782  0.0001622
   -0.01102754]
  [ 0.00305659 -0.00335002  0.00523615 ... -0.00389782  0.0001622
   -0.01102754]
  ...
  [ 0.00305659 -0.00335002  0.00523615 ... -0.00389782  0.0001622
   -0.01102754]
  [ 0.00305659 -0.00335002  0.00523615 ... -0.00389782  0.0001622
   -0.01102754]
  [ 0.00305659 -0.00335002  0.00523615 ... -0.00389782  0.0001622
   -0.01102754]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_93/Add:0', description="created by layer 'tf.math.add_93'")
Add /up_blocks.1/attentions.1/transformer_blocks.0/Add_2
(1, 256, 640)
(1, 256, 640) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_94/Add:0', description="created by layer 'tf.math.add_94'")
Reshape /up_blocks.1/attentions.1/Reshape_1
input_shape: (1, 256, 640) total_elements: 163840
[  1  16  16 640] 163840
Final shape: [  1  16  16 640]
Transpose /up_blocks.1/attentions.1/Transpose_1
INFO:tensorflow:Assets written to: /tmp/tmpy7ihgfua/assets
INFO:tensorflow:Assets written to: /tmp/tmpy7ihgfua/assets
2024-07-29 19:40:05.466640: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:05.466702: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:05.466854: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpy7ihgfua
2024-07-29 19:40:05.469813: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:05.469855: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpy7ihgfua
2024-07-29 19:40:05.476869: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:05.508400: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpy7ihgfua
2024-07-29 19:40:05.521403: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 54550 microseconds.
2024-07-29 19:40:05.667281: W tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2073] TFLite interpreter needs to link Flex delegate in order to run the model since it contains the following Select TFop(s):
Flex ops: FlexErf
Details:
        tf.Erf(tensor<1x256x2560xf32>) -> (tensor<1x256x2560xf32>) : {device = ""}
See instructions: https://www.tensorflow.org/lite/guide/ops_select
2024-07-29 19:40:05.667364: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 4.197 G  ops, equivalently 2.098 G  MACs
2024-07-29 19:40:06.143021: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2024-07-29 19:40:06.143070: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1960] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
INFO:converter running::tflite model elements' max error is 4.5776E-05, pass, tflite saved in ./tflite/cpusubgraph30.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph30.onnx to ./tflite/cpusubgraph30.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph31.onnx
Checking 0/1...
Add /up_blocks.1/attentions.1/Add
(1, 640, 16, 16)
(1, 640, 16, 16) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 640, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_95/Add:0', description="created by layer 'tf.math.add_95'")
Resize /up_blocks.1/upsamplers.0/Resize
1.0 1.0 2.0 2.0
KerasTensor(type_spec=TensorSpec(shape=(1, 16, 16, 640), dtype=tf.float32, name=None), name='tf.compat.v1.transpose_61/transpose:0', description="created by layer 'tf.compat.v1.transpose_61'")
(32, 32)
nearest
INFO:tensorflow:Assets written to: /tmp/tmpnu26umju/assets
INFO:tensorflow:Assets written to: /tmp/tmpnu26umju/assets
2024-07-29 19:40:07.378487: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:07.378691: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:07.379116: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpnu26umju
2024-07-29 19:40:07.379794: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:07.379838: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpnu26umju
2024-07-29 19:40:07.380624: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:07.385967: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpnu26umju
2024-07-29 19:40:07.388983: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 9869 microseconds.
2024-07-29 19:40:07.403081: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.164 M  ops, equivalently 0.082 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph31.onnx to ./tflite/cpusubgraph31.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph32.onnx
Checking 0/1...
Concat /up_blocks.2/Concat
Reshape /up_blocks.2/resnets.0/norm1/Reshape
input_shape: (1, 960, 32, 32) total_elements: 983040
[ 0 32 -1] 32
final_shape: [1, 32, 30720] dynamic_dim_size: 30720
Final shape: [1, 32, 30720]
InstanceNormalization /up_blocks.2/resnets.0/norm1/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmpd_wdh80k/assets
INFO:tensorflow:Assets written to: /tmp/tmpd_wdh80k/assets
2024-07-29 19:40:07.621618: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:07.621664: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:07.621797: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpd_wdh80k
2024-07-29 19:40:07.622104: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:07.622128: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpd_wdh80k
2024-07-29 19:40:07.622793: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:07.626359: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpd_wdh80k
2024-07-29 19:40:07.629250: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 7453 microseconds.
2024-07-29 19:40:07.644661: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 1.966 M  ops, equivalently 0.983 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph32.onnx to ./tflite/cpusubgraph32.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph33.onnx
Checking 0/1...
Gemm /up_blocks.2/resnets.0/time_emb_proj/Gemm
Unsqueeze /up_blocks.2/resnets.0/Unsqueeze_1
Add /up_blocks.2/resnets.0/Add
(1, 320, 32, 32)
(1, 320, 1) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_96/Add:0', description="created by layer 'tf.math.add_96'")
Reshape /up_blocks.2/resnets.0/norm2/Reshape
input_shape: (1, 320, 32, 32) total_elements: 327680
[ 0 32 -1] 32
final_shape: [1, 32, 10240] dynamic_dim_size: 10240
Final shape: [1, 32, 10240]
InstanceNormalization /up_blocks.2/resnets.0/norm2/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmpemju_eme/assets
INFO:tensorflow:Assets written to: /tmp/tmpemju_eme/assets
2024-07-29 19:40:07.948673: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:07.948720: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:07.948833: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpemju_eme
2024-07-29 19:40:07.949345: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:07.949405: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpemju_eme
2024-07-29 19:40:07.950645: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:07.958581: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpemju_eme
2024-07-29 19:40:07.962457: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 13624 microseconds.
2024-07-29 19:40:07.993443: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 1.803 M  ops, equivalently 0.901 M  MACs
INFO:converter running::tflite model elements' max error is 2.5272E-05, pass, tflite saved in ./tflite/cpusubgraph33.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph33.onnx to ./tflite/cpusubgraph33.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph34.onnx
Checking 0/1...
InstanceNormalization /up_blocks.2/attentions.0/norm/InstanceNormalization
Reshape /up_blocks.2/attentions.0/norm/Reshape_1
input_shape: (1, 32, 10240) total_elements: 327680
[  1 320  32  32] 327680
Final shape: [  1 320  32  32]
INFO:tensorflow:Assets written to: /tmp/tmpuztreep4/assets
INFO:tensorflow:Assets written to: /tmp/tmpuztreep4/assets
2024-07-29 19:40:08.235481: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:08.235540: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:08.235774: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpuztreep4
2024-07-29 19:40:08.236115: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:08.236187: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpuztreep4
2024-07-29 19:40:08.237070: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:08.240755: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpuztreep4
2024-07-29 19:40:08.243251: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 7483 microseconds.
2024-07-29 19:40:08.257233: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.655 M  ops, equivalently 0.328 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph34.onnx to ./tflite/cpusubgraph34.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph35.onnx
Checking 0/1...
Transpose /up_blocks.2/attentions.0/Transpose
Reshape /up_blocks.2/attentions.0/Reshape
input_shape: (1, 32, 32, 320) total_elements: 327680
[   1 1024  320] 327680
Final shape: [   1 1024  320]
ReduceMean /up_blocks.2/attentions.0/transformer_blocks.0/norm1/ReduceMean
Sub /up_blocks.2/attentions.0/transformer_blocks.0/norm1/Sub
Pow /up_blocks.2/attentions.0/transformer_blocks.0/norm1/Pow
ReduceMean /up_blocks.2/attentions.0/transformer_blocks.0/norm1/ReduceMean_1
Add /up_blocks.2/attentions.0/transformer_blocks.0/norm1/Add
(1, 1024, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 1), dtype=tf.float32, name=None), name='tf.math.add_97/Add:0', description="created by layer 'tf.math.add_97'")
Sqrt /up_blocks.2/attentions.0/transformer_blocks.0/norm1/Sqrt
Div /up_blocks.2/attentions.0/transformer_blocks.0/norm1/Div
Mul /up_blocks.2/attentions.0/transformer_blocks.0/norm1/Mul
Add /up_blocks.2/attentions.0/transformer_blocks.0/norm1/Add_1
(1, 1024, 320)
(320,) 1
[1, 1024, 1]
1 1
1
1024 1
1024
320 320
1
tf.Tensor(
[[[ 0.05957783  0.23439053 -0.10327069 ... -0.15037745 -0.03274311
   -0.37230957]
  [ 0.05957783  0.23439053 -0.10327069 ... -0.15037745 -0.03274311
   -0.37230957]
  [ 0.05957783  0.23439053 -0.10327069 ... -0.15037745 -0.03274311
   -0.37230957]
  ...
  [ 0.05957783  0.23439053 -0.10327069 ... -0.15037745 -0.03274311
   -0.37230957]
  [ 0.05957783  0.23439053 -0.10327069 ... -0.15037745 -0.03274311
   -0.37230957]
  [ 0.05957783  0.23439053 -0.10327069 ... -0.15037745 -0.03274311
   -0.37230957]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_98/Add:0', description="created by layer 'tf.math.add_98'")
MatMul
Split
Reshape /up_blocks.2/attentions.0/transformer_blocks.0/attn1/Reshape
input_shape: (1, 1024, 320) total_elements: 327680
[ 1 -1  8 40] 320
final_shape: [1, 1024, 8, 40] dynamic_dim_size: 1024
Final shape: [1, 1024, 8, 40]
Transpose /up_blocks.2/attentions.0/transformer_blocks.0/attn1/Transpose
Reshape /up_blocks.2/attentions.0/transformer_blocks.0/attn1/Reshape_1
input_shape: (1, 1024, 320) total_elements: 327680
[ 1 -1  8 40] 320
final_shape: [1, 1024, 8, 40] dynamic_dim_size: 1024
Final shape: [1, 1024, 8, 40]
Reshape /up_blocks.2/attentions.0/transformer_blocks.0/attn1/Reshape_2
input_shape: (1, 1024, 320) total_elements: 327680
[ 1 -1  8 40] 320
final_shape: [1, 1024, 8, 40] dynamic_dim_size: 1024
Final shape: [1, 1024, 8, 40]
Transpose /up_blocks.2/attentions.0/transformer_blocks.0/attn1/Transpose_1
Transpose /up_blocks.2/attentions.0/transformer_blocks.0/attn1/Transpose_2
Mul /up_blocks.2/attentions.0/transformer_blocks.0/attn1/Mul
Mul /up_blocks.2/attentions.0/transformer_blocks.0/attn1/Mul_1
MatMul /up_blocks.2/attentions.0/transformer_blocks.0/attn1/MatMul
Softmax /up_blocks.2/attentions.0/transformer_blocks.0/attn1/Softmax
MatMul /up_blocks.2/attentions.0/transformer_blocks.0/attn1/MatMul_1
Transpose /up_blocks.2/attentions.0/transformer_blocks.0/attn1/Transpose_3
Reshape /up_blocks.2/attentions.0/transformer_blocks.0/attn1/Reshape_3
input_shape: (1, 1024, 8, 40) total_elements: 327680
[  1  -1 320] 320
final_shape: [1, 1024, 320] dynamic_dim_size: 1024
Final shape: [1, 1024, 320]
MatMul /up_blocks.2/attentions.0/transformer_blocks.0/attn1/to_out.0/MatMul
Add /up_blocks.2/attentions.0/transformer_blocks.0/attn1/to_out.0/Add
(320,)
(1, 1024, 320) 3
[1, 1024, 1]
tf.Tensor(
[[[ 0.00554397  0.04556188 -0.0044032  ... -0.00346269  0.04891079
   -0.02152147]
  [ 0.00554397  0.04556188 -0.0044032  ... -0.00346269  0.04891079
   -0.02152147]
  [ 0.00554397  0.04556188 -0.0044032  ... -0.00346269  0.04891079
   -0.02152147]
  ...
  [ 0.00554397  0.04556188 -0.0044032  ... -0.00346269  0.04891079
   -0.02152147]
  [ 0.00554397  0.04556188 -0.0044032  ... -0.00346269  0.04891079
   -0.02152147]
  [ 0.00554397  0.04556188 -0.0044032  ... -0.00346269  0.04891079
   -0.02152147]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_99/Add:0', description="created by layer 'tf.math.add_99'")
Add /up_blocks.2/attentions.0/transformer_blocks.0/Add
(1, 1024, 320)
(1, 1024, 320) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_100/Add:0', description="created by layer 'tf.math.add_100'")
ReduceMean /up_blocks.2/attentions.0/transformer_blocks.0/norm2/ReduceMean
Sub /up_blocks.2/attentions.0/transformer_blocks.0/norm2/Sub
Pow /up_blocks.2/attentions.0/transformer_blocks.0/norm2/Pow
ReduceMean /up_blocks.2/attentions.0/transformer_blocks.0/norm2/ReduceMean_1
Add /up_blocks.2/attentions.0/transformer_blocks.0/norm2/Add
(1, 1024, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 1), dtype=tf.float32, name=None), name='tf.math.add_101/Add:0', description="created by layer 'tf.math.add_101'")
Sqrt /up_blocks.2/attentions.0/transformer_blocks.0/norm2/Sqrt
Div /up_blocks.2/attentions.0/transformer_blocks.0/norm2/Div
Mul /up_blocks.2/attentions.0/transformer_blocks.0/norm2/Mul
Add /up_blocks.2/attentions.0/transformer_blocks.0/norm2/Add_1
(1, 1024, 320)
(320,) 1
[1, 1024, 1]
1 1
1
1024 1
1024
320 320
1
tf.Tensor(
[[[-0.07698958 -0.03926161 -0.1943055  ...  0.0641379   0.12587705
    0.23375665]
  [-0.07698958 -0.03926161 -0.1943055  ...  0.0641379   0.12587705
    0.23375665]
  [-0.07698958 -0.03926161 -0.1943055  ...  0.0641379   0.12587705
    0.23375665]
  ...
  [-0.07698958 -0.03926161 -0.1943055  ...  0.0641379   0.12587705
    0.23375665]
  [-0.07698958 -0.03926161 -0.1943055  ...  0.0641379   0.12587705
    0.23375665]
  [-0.07698958 -0.03926161 -0.1943055  ...  0.0641379   0.12587705
    0.23375665]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_102/Add:0', description="created by layer 'tf.math.add_102'")
MatMul /up_blocks.2/attentions.0/transformer_blocks.0/attn2/to_q/MatMul
MatMul /up_blocks.2/attentions.0/transformer_blocks.0/attn2/to_k/MatMul
MatMul /up_blocks.2/attentions.0/transformer_blocks.0/attn2/to_v/MatMul
Reshape /up_blocks.2/attentions.0/transformer_blocks.0/attn2/Reshape
input_shape: (1, 1024, 320) total_elements: 327680
[ 1 -1  8 40] 320
final_shape: [1, 1024, 8, 40] dynamic_dim_size: 1024
Final shape: [1, 1024, 8, 40]
Transpose /up_blocks.2/attentions.0/transformer_blocks.0/attn2/Transpose
Reshape /up_blocks.2/attentions.0/transformer_blocks.0/attn2/Reshape_1
input_shape: (1, 77, 320) total_elements: 24640
[ 1 -1  8 40] 320
final_shape: [1, 77, 8, 40] dynamic_dim_size: 77
Final shape: [1, 77, 8, 40]
Reshape /up_blocks.2/attentions.0/transformer_blocks.0/attn2/Reshape_2
input_shape: (1, 77, 320) total_elements: 24640
[ 1 -1  8 40] 320
final_shape: [1, 77, 8, 40] dynamic_dim_size: 77
Final shape: [1, 77, 8, 40]
Transpose /up_blocks.2/attentions.0/transformer_blocks.0/attn2/Transpose_1
Transpose /up_blocks.2/attentions.0/transformer_blocks.0/attn2/Transpose_2
Mul /up_blocks.2/attentions.0/transformer_blocks.0/attn2/Mul
Mul /up_blocks.2/attentions.0/transformer_blocks.0/attn2/Mul_1
MatMul /up_blocks.2/attentions.0/transformer_blocks.0/attn2/MatMul
Softmax /up_blocks.2/attentions.0/transformer_blocks.0/attn2/Softmax
MatMul /up_blocks.2/attentions.0/transformer_blocks.0/attn2/MatMul_1
Transpose /up_blocks.2/attentions.0/transformer_blocks.0/attn2/Transpose_3
Reshape /up_blocks.2/attentions.0/transformer_blocks.0/attn2/Reshape_3
input_shape: (1, 1024, 8, 40) total_elements: 327680
[  1  -1 320] 320
final_shape: [1, 1024, 320] dynamic_dim_size: 1024
Final shape: [1, 1024, 320]
MatMul /up_blocks.2/attentions.0/transformer_blocks.0/attn2/to_out.0/MatMul
Add /up_blocks.2/attentions.0/transformer_blocks.0/attn2/to_out.0/Add
(320,)
(1, 1024, 320) 3
[1, 1024, 1]
tf.Tensor(
[[[-0.03090352 -0.01039026 -0.02942642 ...  0.00424326  0.02199197
   -0.04092293]
  [-0.03090352 -0.01039026 -0.02942642 ...  0.00424326  0.02199197
   -0.04092293]
  [-0.03090352 -0.01039026 -0.02942642 ...  0.00424326  0.02199197
   -0.04092293]
  ...
  [-0.03090352 -0.01039026 -0.02942642 ...  0.00424326  0.02199197
   -0.04092293]
  [-0.03090352 -0.01039026 -0.02942642 ...  0.00424326  0.02199197
   -0.04092293]
  [-0.03090352 -0.01039026 -0.02942642 ...  0.00424326  0.02199197
   -0.04092293]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_103/Add:0', description="created by layer 'tf.math.add_103'")
Add /up_blocks.2/attentions.0/transformer_blocks.0/Add_1
(1, 1024, 320)
(1, 1024, 320) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_104/Add:0', description="created by layer 'tf.math.add_104'")
ReduceMean /up_blocks.2/attentions.0/transformer_blocks.0/norm3/ReduceMean
Sub /up_blocks.2/attentions.0/transformer_blocks.0/norm3/Sub
Pow /up_blocks.2/attentions.0/transformer_blocks.0/norm3/Pow
ReduceMean /up_blocks.2/attentions.0/transformer_blocks.0/norm3/ReduceMean_1
Add /up_blocks.2/attentions.0/transformer_blocks.0/norm3/Add
(1, 1024, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 1), dtype=tf.float32, name=None), name='tf.math.add_105/Add:0', description="created by layer 'tf.math.add_105'")
Sqrt /up_blocks.2/attentions.0/transformer_blocks.0/norm3/Sqrt
Div /up_blocks.2/attentions.0/transformer_blocks.0/norm3/Div
Mul /up_blocks.2/attentions.0/transformer_blocks.0/norm3/Mul
Add /up_blocks.2/attentions.0/transformer_blocks.0/norm3/Add_1
(1, 1024, 320)
(320,) 1
[1, 1024, 1]
1 1
1
1024 1
1024
320 320
1
tf.Tensor(
[[[ 0.14507793 -0.04280508 -0.10138035 ... -0.02956516 -0.04975516
   -0.03410911]
  [ 0.14507793 -0.04280508 -0.10138035 ... -0.02956516 -0.04975516
   -0.03410911]
  [ 0.14507793 -0.04280508 -0.10138035 ... -0.02956516 -0.04975516
   -0.03410911]
  ...
  [ 0.14507793 -0.04280508 -0.10138035 ... -0.02956516 -0.04975516
   -0.03410911]
  [ 0.14507793 -0.04280508 -0.10138035 ... -0.02956516 -0.04975516
   -0.03410911]
  [ 0.14507793 -0.04280508 -0.10138035 ... -0.02956516 -0.04975516
   -0.03410911]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_106/Add:0', description="created by layer 'tf.math.add_106'")
MatMul /up_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/proj/MatMul
Add /up_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/proj/Add
(2560,)
(1, 1024, 2560) 3
[1, 1024, 1]
tf.Tensor(
[[[-0.09217572  0.01519654  0.04834925 ...  0.11411817  0.08881044
    0.08658919]
  [-0.09217572  0.01519654  0.04834925 ...  0.11411817  0.08881044
    0.08658919]
  [-0.09217572  0.01519654  0.04834925 ...  0.11411817  0.08881044
    0.08658919]
  ...
  [-0.09217572  0.01519654  0.04834925 ...  0.11411817  0.08881044
    0.08658919]
  [-0.09217572  0.01519654  0.04834925 ...  0.11411817  0.08881044
    0.08658919]
  [-0.09217572  0.01519654  0.04834925 ...  0.11411817  0.08881044
    0.08658919]]], shape=(1, 1024, 2560), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 2560), dtype=tf.float32, name=None), name='tf.math.add_107/Add:0', description="created by layer 'tf.math.add_107'")
Slice /up_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Slice
Slice /up_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Slice_1
Div /up_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Div_1
Erf /up_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Erf
Add /up_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Add_1
(1, 1024, 1280)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 1280), dtype=tf.float32, name=None), name='tf.math.add_108/Add:0', description="created by layer 'tf.math.add_108'")
Mul /up_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Mul_2
Mul /up_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Mul_3
Mul /up_blocks.2/attentions.0/transformer_blocks.0/ff/net.0/Mul_4
MatMul /up_blocks.2/attentions.0/transformer_blocks.0/ff/net.2/MatMul
Add /up_blocks.2/attentions.0/transformer_blocks.0/ff/net.2/Add
(320,)
(1, 1024, 320) 3
[1, 1024, 1]
tf.Tensor(
[[[-0.01563979 -0.00537979  0.01776004 ... -0.00946468 -0.03408454
   -0.01439532]
  [-0.01563979 -0.00537979  0.01776004 ... -0.00946468 -0.03408454
   -0.01439532]
  [-0.01563979 -0.00537979  0.01776004 ... -0.00946468 -0.03408454
   -0.01439532]
  ...
  [-0.01563979 -0.00537979  0.01776004 ... -0.00946468 -0.03408454
   -0.01439532]
  [-0.01563979 -0.00537979  0.01776004 ... -0.00946468 -0.03408454
   -0.01439532]
  [-0.01563979 -0.00537979  0.01776004 ... -0.00946468 -0.03408454
   -0.01439532]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_109/Add:0', description="created by layer 'tf.math.add_109'")
Add /up_blocks.2/attentions.0/transformer_blocks.0/Add_2
(1, 1024, 320)
(1, 1024, 320) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_110/Add:0', description="created by layer 'tf.math.add_110'")
Reshape /up_blocks.2/attentions.0/Reshape_1
input_shape: (1, 1024, 320) total_elements: 327680
[  1  32  32 320] 327680
Final shape: [  1  32  32 320]
Transpose /up_blocks.2/attentions.0/Transpose_1
INFO:tensorflow:Assets written to: /tmp/tmp9x16g5pp/assets
INFO:tensorflow:Assets written to: /tmp/tmp9x16g5pp/assets
2024-07-29 19:40:23.590679: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:23.590743: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:23.590957: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp9x16g5pp
2024-07-29 19:40:23.596359: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:23.596408: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp9x16g5pp
2024-07-29 19:40:23.604433: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:23.629291: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp9x16g5pp
2024-07-29 19:40:23.642875: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 51940 microseconds.
2024-07-29 19:40:23.744966: W tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2073] TFLite interpreter needs to link Flex delegate in order to run the model since it contains the following Select TFop(s):
Flex ops: FlexErf
Details:
        tf.Erf(tensor<1x1024x1280xf32>) -> (tensor<1x1024x1280xf32>) : {device = ""}
See instructions: https://www.tensorflow.org/lite/guide/ops_select
2024-07-29 19:40:23.745048: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 5.888 G  ops, equivalently 2.944 G  MACs
2024-07-29 19:40:24.169489: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2024-07-29 19:40:24.169553: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1960] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
INFO:converter running::tflite model elements' max error is 8.1062E-06, pass, tflite saved in ./tflite/cpusubgraph35.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph35.onnx to ./tflite/cpusubgraph35.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph36.onnx
Checking 0/1...
Add /up_blocks.2/attentions.0/Add
(1, 320, 32, 32)
(1, 320, 32, 32) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_111/Add:0', description="created by layer 'tf.math.add_111'")
Concat /up_blocks.2/Concat_1
Reshape /up_blocks.2/resnets.1/norm1/Reshape
input_shape: (1, 640, 32, 32) total_elements: 655360
[ 0 32 -1] 32
final_shape: [1, 32, 20480] dynamic_dim_size: 20480
Final shape: [1, 32, 20480]
InstanceNormalization /up_blocks.2/resnets.1/norm1/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmpp11nepet/assets
INFO:tensorflow:Assets written to: /tmp/tmpp11nepet/assets
2024-07-29 19:40:25.231570: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:25.231632: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:25.232014: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpp11nepet
2024-07-29 19:40:25.232379: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:25.232411: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpp11nepet
2024-07-29 19:40:25.233247: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:25.237075: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpp11nepet
2024-07-29 19:40:25.239888: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 7880 microseconds.
2024-07-29 19:40:25.255063: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 1.638 M  ops, equivalently 0.819 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph36.onnx to ./tflite/cpusubgraph36.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph37.onnx
Checking 0/1...
Gemm /up_blocks.2/resnets.1/time_emb_proj/Gemm
Unsqueeze /up_blocks.2/resnets.1/Unsqueeze_1
Add /up_blocks.2/resnets.1/Add
(1, 320, 32, 32)
(1, 320, 1) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_112/Add:0', description="created by layer 'tf.math.add_112'")
Reshape /up_blocks.2/resnets.1/norm2/Reshape
input_shape: (1, 320, 32, 32) total_elements: 327680
[ 0 32 -1] 32
final_shape: [1, 32, 10240] dynamic_dim_size: 10240
Final shape: [1, 32, 10240]
InstanceNormalization /up_blocks.2/resnets.1/norm2/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmpxcxx2n1n/assets
INFO:tensorflow:Assets written to: /tmp/tmpxcxx2n1n/assets
2024-07-29 19:40:25.577642: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:25.577694: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:25.577820: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpxcxx2n1n
2024-07-29 19:40:25.578245: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:25.578276: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpxcxx2n1n
2024-07-29 19:40:25.579245: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:25.587404: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpxcxx2n1n
2024-07-29 19:40:25.591097: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 13277 microseconds.
2024-07-29 19:40:25.620282: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 1.803 M  ops, equivalently 0.901 M  MACs
INFO:converter running::tflite model elements' max error is 4.4942E-05, pass, tflite saved in ./tflite/cpusubgraph37.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph37.onnx to ./tflite/cpusubgraph37.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph38.onnx
Checking 0/1...
InstanceNormalization /up_blocks.2/attentions.1/norm/InstanceNormalization
Reshape /up_blocks.2/attentions.1/norm/Reshape_1
input_shape: (1, 32, 10240) total_elements: 327680
[  1 320  32  32] 327680
Final shape: [  1 320  32  32]
INFO:tensorflow:Assets written to: /tmp/tmpnp6q2web/assets
INFO:tensorflow:Assets written to: /tmp/tmpnp6q2web/assets
2024-07-29 19:40:25.865565: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:25.865621: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:25.865861: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpnp6q2web
2024-07-29 19:40:25.866119: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:25.866145: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpnp6q2web
2024-07-29 19:40:25.866819: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:25.870904: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpnp6q2web
2024-07-29 19:40:25.873839: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 7983 microseconds.
2024-07-29 19:40:25.891730: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.655 M  ops, equivalently 0.328 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph38.onnx to ./tflite/cpusubgraph38.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph39.onnx
Checking 0/1...
Transpose /up_blocks.2/attentions.1/Transpose
Reshape /up_blocks.2/attentions.1/Reshape
input_shape: (1, 32, 32, 320) total_elements: 327680
[   1 1024  320] 327680
Final shape: [   1 1024  320]
ReduceMean /up_blocks.2/attentions.1/transformer_blocks.0/norm1/ReduceMean
Sub /up_blocks.2/attentions.1/transformer_blocks.0/norm1/Sub
Pow /up_blocks.2/attentions.1/transformer_blocks.0/norm1/Pow
ReduceMean /up_blocks.2/attentions.1/transformer_blocks.0/norm1/ReduceMean_1
Add /up_blocks.2/attentions.1/transformer_blocks.0/norm1/Add
(1, 1024, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 1), dtype=tf.float32, name=None), name='tf.math.add_113/Add:0', description="created by layer 'tf.math.add_113'")
Sqrt /up_blocks.2/attentions.1/transformer_blocks.0/norm1/Sqrt
Div /up_blocks.2/attentions.1/transformer_blocks.0/norm1/Div
Mul /up_blocks.2/attentions.1/transformer_blocks.0/norm1/Mul
Add /up_blocks.2/attentions.1/transformer_blocks.0/norm1/Add_1
(1, 1024, 320)
(320,) 1
[1, 1024, 1]
1 1
1
1024 1
1024
320 320
1
tf.Tensor(
[[[ 0.03483211  0.367303   -0.15514672 ... -0.21441509  0.26189205
    0.13203675]
  [ 0.03483211  0.367303   -0.15514672 ... -0.21441509  0.26189205
    0.13203675]
  [ 0.03483211  0.367303   -0.15514672 ... -0.21441509  0.26189205
    0.13203675]
  ...
  [ 0.03483211  0.367303   -0.15514672 ... -0.21441509  0.26189205
    0.13203675]
  [ 0.03483211  0.367303   -0.15514672 ... -0.21441509  0.26189205
    0.13203675]
  [ 0.03483211  0.367303   -0.15514672 ... -0.21441509  0.26189205
    0.13203675]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_114/Add:0', description="created by layer 'tf.math.add_114'")
MatMul
Split
Reshape /up_blocks.2/attentions.1/transformer_blocks.0/attn1/Reshape
input_shape: (1, 1024, 320) total_elements: 327680
[ 1 -1  8 40] 320
final_shape: [1, 1024, 8, 40] dynamic_dim_size: 1024
Final shape: [1, 1024, 8, 40]
Transpose /up_blocks.2/attentions.1/transformer_blocks.0/attn1/Transpose
Reshape /up_blocks.2/attentions.1/transformer_blocks.0/attn1/Reshape_1
input_shape: (1, 1024, 320) total_elements: 327680
[ 1 -1  8 40] 320
final_shape: [1, 1024, 8, 40] dynamic_dim_size: 1024
Final shape: [1, 1024, 8, 40]
Reshape /up_blocks.2/attentions.1/transformer_blocks.0/attn1/Reshape_2
input_shape: (1, 1024, 320) total_elements: 327680
[ 1 -1  8 40] 320
final_shape: [1, 1024, 8, 40] dynamic_dim_size: 1024
Final shape: [1, 1024, 8, 40]
Transpose /up_blocks.2/attentions.1/transformer_blocks.0/attn1/Transpose_1
Transpose /up_blocks.2/attentions.1/transformer_blocks.0/attn1/Transpose_2
Mul /up_blocks.2/attentions.1/transformer_blocks.0/attn1/Mul
Mul /up_blocks.2/attentions.1/transformer_blocks.0/attn1/Mul_1
MatMul /up_blocks.2/attentions.1/transformer_blocks.0/attn1/MatMul
Softmax /up_blocks.2/attentions.1/transformer_blocks.0/attn1/Softmax
MatMul /up_blocks.2/attentions.1/transformer_blocks.0/attn1/MatMul_1
Transpose /up_blocks.2/attentions.1/transformer_blocks.0/attn1/Transpose_3
Reshape /up_blocks.2/attentions.1/transformer_blocks.0/attn1/Reshape_3
input_shape: (1, 1024, 8, 40) total_elements: 327680
[  1  -1 320] 320
final_shape: [1, 1024, 320] dynamic_dim_size: 1024
Final shape: [1, 1024, 320]
MatMul /up_blocks.2/attentions.1/transformer_blocks.0/attn1/to_out.0/MatMul
Add /up_blocks.2/attentions.1/transformer_blocks.0/attn1/to_out.0/Add
(320,)
(1, 1024, 320) 3
[1, 1024, 1]
tf.Tensor(
[[[-0.03225149 -0.02421222  0.03464032 ...  0.03310942  0.05766421
    0.00735338]
  [-0.03225149 -0.02421222  0.03464032 ...  0.03310942  0.05766421
    0.00735338]
  [-0.03225149 -0.02421222  0.03464032 ...  0.03310942  0.05766421
    0.00735338]
  ...
  [-0.03225149 -0.02421222  0.03464032 ...  0.03310942  0.05766421
    0.00735338]
  [-0.03225149 -0.02421222  0.03464032 ...  0.03310942  0.05766421
    0.00735338]
  [-0.03225149 -0.02421222  0.03464032 ...  0.03310942  0.05766421
    0.00735338]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_115/Add:0', description="created by layer 'tf.math.add_115'")
Add /up_blocks.2/attentions.1/transformer_blocks.0/Add
(1, 1024, 320)
(1, 1024, 320) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_116/Add:0', description="created by layer 'tf.math.add_116'")
ReduceMean /up_blocks.2/attentions.1/transformer_blocks.0/norm2/ReduceMean
Sub /up_blocks.2/attentions.1/transformer_blocks.0/norm2/Sub
Pow /up_blocks.2/attentions.1/transformer_blocks.0/norm2/Pow
ReduceMean /up_blocks.2/attentions.1/transformer_blocks.0/norm2/ReduceMean_1
Add /up_blocks.2/attentions.1/transformer_blocks.0/norm2/Add
(1, 1024, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 1), dtype=tf.float32, name=None), name='tf.math.add_117/Add:0', description="created by layer 'tf.math.add_117'")
Sqrt /up_blocks.2/attentions.1/transformer_blocks.0/norm2/Sqrt
Div /up_blocks.2/attentions.1/transformer_blocks.0/norm2/Div
Mul /up_blocks.2/attentions.1/transformer_blocks.0/norm2/Mul
Add /up_blocks.2/attentions.1/transformer_blocks.0/norm2/Add_1
(1, 1024, 320)
(320,) 1
[1, 1024, 1]
1 1
1
1024 1
1024
320 320
1
tf.Tensor(
[[[ 0.04068817 -0.05143813  0.02096736 ...  0.05507475  0.05101725
   -0.08723392]
  [ 0.04068817 -0.05143813  0.02096736 ...  0.05507475  0.05101725
   -0.08723392]
  [ 0.04068817 -0.05143813  0.02096736 ...  0.05507475  0.05101725
   -0.08723392]
  ...
  [ 0.04068817 -0.05143813  0.02096736 ...  0.05507475  0.05101725
   -0.08723392]
  [ 0.04068817 -0.05143813  0.02096736 ...  0.05507475  0.05101725
   -0.08723392]
  [ 0.04068817 -0.05143813  0.02096736 ...  0.05507475  0.05101725
   -0.08723392]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_118/Add:0', description="created by layer 'tf.math.add_118'")
MatMul /up_blocks.2/attentions.1/transformer_blocks.0/attn2/to_q/MatMul
MatMul /up_blocks.2/attentions.1/transformer_blocks.0/attn2/to_k/MatMul
MatMul /up_blocks.2/attentions.1/transformer_blocks.0/attn2/to_v/MatMul
Reshape /up_blocks.2/attentions.1/transformer_blocks.0/attn2/Reshape
input_shape: (1, 1024, 320) total_elements: 327680
[ 1 -1  8 40] 320
final_shape: [1, 1024, 8, 40] dynamic_dim_size: 1024
Final shape: [1, 1024, 8, 40]
Transpose /up_blocks.2/attentions.1/transformer_blocks.0/attn2/Transpose
Reshape /up_blocks.2/attentions.1/transformer_blocks.0/attn2/Reshape_1
input_shape: (1, 77, 320) total_elements: 24640
[ 1 -1  8 40] 320
final_shape: [1, 77, 8, 40] dynamic_dim_size: 77
Final shape: [1, 77, 8, 40]
Reshape /up_blocks.2/attentions.1/transformer_blocks.0/attn2/Reshape_2
input_shape: (1, 77, 320) total_elements: 24640
[ 1 -1  8 40] 320
final_shape: [1, 77, 8, 40] dynamic_dim_size: 77
Final shape: [1, 77, 8, 40]
Transpose /up_blocks.2/attentions.1/transformer_blocks.0/attn2/Transpose_1
Transpose /up_blocks.2/attentions.1/transformer_blocks.0/attn2/Transpose_2
Mul /up_blocks.2/attentions.1/transformer_blocks.0/attn2/Mul
Mul /up_blocks.2/attentions.1/transformer_blocks.0/attn2/Mul_1
MatMul /up_blocks.2/attentions.1/transformer_blocks.0/attn2/MatMul
Softmax /up_blocks.2/attentions.1/transformer_blocks.0/attn2/Softmax
MatMul /up_blocks.2/attentions.1/transformer_blocks.0/attn2/MatMul_1
Transpose /up_blocks.2/attentions.1/transformer_blocks.0/attn2/Transpose_3
Reshape /up_blocks.2/attentions.1/transformer_blocks.0/attn2/Reshape_3
input_shape: (1, 1024, 8, 40) total_elements: 327680
[  1  -1 320] 320
final_shape: [1, 1024, 320] dynamic_dim_size: 1024
Final shape: [1, 1024, 320]
MatMul /up_blocks.2/attentions.1/transformer_blocks.0/attn2/to_out.0/MatMul
Add /up_blocks.2/attentions.1/transformer_blocks.0/attn2/to_out.0/Add
(320,)
(1, 1024, 320) 3
[1, 1024, 1]
tf.Tensor(
[[[ 0.00061604  0.01532227 -0.01247322 ... -0.03623499  0.00200868
    0.0208666 ]
  [ 0.00061604  0.01532227 -0.01247322 ... -0.03623499  0.00200868
    0.0208666 ]
  [ 0.00061604  0.01532227 -0.01247322 ... -0.03623499  0.00200868
    0.0208666 ]
  ...
  [ 0.00061604  0.01532227 -0.01247322 ... -0.03623499  0.00200868
    0.0208666 ]
  [ 0.00061604  0.01532227 -0.01247322 ... -0.03623499  0.00200868
    0.0208666 ]
  [ 0.00061604  0.01532227 -0.01247322 ... -0.03623499  0.00200868
    0.0208666 ]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_119/Add:0', description="created by layer 'tf.math.add_119'")
Add /up_blocks.2/attentions.1/transformer_blocks.0/Add_1
(1, 1024, 320)
(1, 1024, 320) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_120/Add:0', description="created by layer 'tf.math.add_120'")
ReduceMean /up_blocks.2/attentions.1/transformer_blocks.0/norm3/ReduceMean
Sub /up_blocks.2/attentions.1/transformer_blocks.0/norm3/Sub
Pow /up_blocks.2/attentions.1/transformer_blocks.0/norm3/Pow
ReduceMean /up_blocks.2/attentions.1/transformer_blocks.0/norm3/ReduceMean_1
Add /up_blocks.2/attentions.1/transformer_blocks.0/norm3/Add
(1, 1024, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 1), dtype=tf.float32, name=None), name='tf.math.add_121/Add:0', description="created by layer 'tf.math.add_121'")
Sqrt /up_blocks.2/attentions.1/transformer_blocks.0/norm3/Sqrt
Div /up_blocks.2/attentions.1/transformer_blocks.0/norm3/Div
Mul /up_blocks.2/attentions.1/transformer_blocks.0/norm3/Mul
Add /up_blocks.2/attentions.1/transformer_blocks.0/norm3/Add_1
(1, 1024, 320)
(320,) 1
[1, 1024, 1]
1 1
1
1024 1
1024
320 320
1
tf.Tensor(
[[[ 0.07284144 -0.05503877  0.03703197 ...  0.04843457 -0.08998735
   -0.02013828]
  [ 0.07284144 -0.05503877  0.03703197 ...  0.04843457 -0.08998735
   -0.02013828]
  [ 0.07284144 -0.05503877  0.03703197 ...  0.04843457 -0.08998735
   -0.02013828]
  ...
  [ 0.07284144 -0.05503877  0.03703197 ...  0.04843457 -0.08998735
   -0.02013828]
  [ 0.07284144 -0.05503877  0.03703197 ...  0.04843457 -0.08998735
   -0.02013828]
  [ 0.07284144 -0.05503877  0.03703197 ...  0.04843457 -0.08998735
   -0.02013828]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_122/Add:0', description="created by layer 'tf.math.add_122'")
MatMul /up_blocks.2/attentions.1/transformer_blocks.0/ff/net.0/proj/MatMul
Add /up_blocks.2/attentions.1/transformer_blocks.0/ff/net.0/proj/Add
(2560,)
(1, 1024, 2560) 3
[1, 1024, 1]
tf.Tensor(
[[[ 0.03604867 -0.03861176 -0.00510641 ...  0.01628526 -0.02086037
    0.0235582 ]
  [ 0.03604867 -0.03861176 -0.00510641 ...  0.01628526 -0.02086037
    0.0235582 ]
  [ 0.03604867 -0.03861176 -0.00510641 ...  0.01628526 -0.02086037
    0.0235582 ]
  ...
  [ 0.03604867 -0.03861176 -0.00510641 ...  0.01628526 -0.02086037
    0.0235582 ]
  [ 0.03604867 -0.03861176 -0.00510641 ...  0.01628526 -0.02086037
    0.0235582 ]
  [ 0.03604867 -0.03861176 -0.00510641 ...  0.01628526 -0.02086037
    0.0235582 ]]], shape=(1, 1024, 2560), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 2560), dtype=tf.float32, name=None), name='tf.math.add_123/Add:0', description="created by layer 'tf.math.add_123'")
Slice /up_blocks.2/attentions.1/transformer_blocks.0/ff/net.0/Slice
Slice /up_blocks.2/attentions.1/transformer_blocks.0/ff/net.0/Slice_1
Div /up_blocks.2/attentions.1/transformer_blocks.0/ff/net.0/Div_1
Erf /up_blocks.2/attentions.1/transformer_blocks.0/ff/net.0/Erf
Add /up_blocks.2/attentions.1/transformer_blocks.0/ff/net.0/Add_1
(1, 1024, 1280)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 1280), dtype=tf.float32, name=None), name='tf.math.add_124/Add:0', description="created by layer 'tf.math.add_124'")
Mul /up_blocks.2/attentions.1/transformer_blocks.0/ff/net.0/Mul_2
Mul /up_blocks.2/attentions.1/transformer_blocks.0/ff/net.0/Mul_3
Mul /up_blocks.2/attentions.1/transformer_blocks.0/ff/net.0/Mul_4
MatMul /up_blocks.2/attentions.1/transformer_blocks.0/ff/net.2/MatMul
Add /up_blocks.2/attentions.1/transformer_blocks.0/ff/net.2/Add
(320,)
(1, 1024, 320) 3
[1, 1024, 1]
tf.Tensor(
[[[-0.00033    -0.03709292  0.04618708 ... -0.01912203  0.10676934
    0.05673046]
  [-0.00033    -0.03709292  0.04618708 ... -0.01912203  0.10676934
    0.05673046]
  [-0.00033    -0.03709292  0.04618708 ... -0.01912203  0.10676934
    0.05673046]
  ...
  [-0.00033    -0.03709292  0.04618708 ... -0.01912203  0.10676934
    0.05673046]
  [-0.00033    -0.03709292  0.04618708 ... -0.01912203  0.10676934
    0.05673046]
  [-0.00033    -0.03709292  0.04618708 ... -0.01912203  0.10676934
    0.05673046]]], shape=(1, 1024, 320), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_125/Add:0', description="created by layer 'tf.math.add_125'")
Add /up_blocks.2/attentions.1/transformer_blocks.0/Add_2
(1, 1024, 320)
(1, 1024, 320) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 1024, 320), dtype=tf.float32, name=None), name='tf.math.add_126/Add:0', description="created by layer 'tf.math.add_126'")
Reshape /up_blocks.2/attentions.1/Reshape_1
input_shape: (1, 1024, 320) total_elements: 327680
[  1  32  32 320] 327680
Final shape: [  1  32  32 320]
Transpose /up_blocks.2/attentions.1/Transpose_1
INFO:tensorflow:Assets written to: /tmp/tmpdb0ek71j/assets
INFO:tensorflow:Assets written to: /tmp/tmpdb0ek71j/assets
2024-07-29 19:40:42.658180: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:42.658235: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:42.658371: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpdb0ek71j
2024-07-29 19:40:42.662734: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:42.662778: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpdb0ek71j
2024-07-29 19:40:42.670234: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:42.694221: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpdb0ek71j
2024-07-29 19:40:42.707049: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 48678 microseconds.
2024-07-29 19:40:42.806499: W tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2073] TFLite interpreter needs to link Flex delegate in order to run the model since it contains the following Select TFop(s):
Flex ops: FlexErf
Details:
        tf.Erf(tensor<1x1024x1280xf32>) -> (tensor<1x1024x1280xf32>) : {device = ""}
See instructions: https://www.tensorflow.org/lite/guide/ops_select
2024-07-29 19:40:42.806588: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 5.888 G  ops, equivalently 2.944 G  MACs
2024-07-29 19:40:43.202285: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2024-07-29 19:40:43.202338: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1960] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
INFO:converter running::tflite model elements' max error is 2.3842E-06, pass, tflite saved in ./tflite/cpusubgraph39.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph39.onnx to ./tflite/cpusubgraph39.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph4.onnx
Checking 0/1...
Add /down_blocks.0/attentions.0/Add
(1, 320, 32, 32)
(1, 320, 32, 32) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_127/Add:0', description="created by layer 'tf.math.add_127'")
INFO:tensorflow:Assets written to: /tmp/tmpvfvtdnq1/assets
INFO:tensorflow:Assets written to: /tmp/tmpvfvtdnq1/assets
2024-07-29 19:40:44.049226: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:44.049277: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:44.049650: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpvfvtdnq1
2024-07-29 19:40:44.049897: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:44.049933: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpvfvtdnq1
2024-07-29 19:40:44.050463: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:44.054461: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpvfvtdnq1
2024-07-29 19:40:44.056964: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 7320 microseconds.
2024-07-29 19:40:44.068690: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.328 M  ops, equivalently 0.164 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph4.onnx to ./tflite/cpusubgraph4.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph40.onnx
Checking 0/1...
Add /up_blocks.2/attentions.1/Add
(1, 320, 32, 32)
(1, 320, 32, 32) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_128/Add:0', description="created by layer 'tf.math.add_128'")
Reshape /conv_norm_out/Reshape
input_shape: (1, 320, 32, 32) total_elements: 327680
[ 0 32 -1] 32
final_shape: [1, 32, 10240] dynamic_dim_size: 10240
Final shape: [1, 32, 10240]
InstanceNormalization /conv_norm_out/InstanceNormalization
Reshape /conv_norm_out/Reshape_1
input_shape: (1, 32, 10240) total_elements: 327680
[  1 320  32  32] 327680
Final shape: [  1 320  32  32]
Mul /conv_norm_out/Mul
Add /conv_norm_out/Add
(1, 320, 32, 32)
(320, 1, 1) 3
(320, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_129/Add:0', description="created by layer 'tf.math.add_129'")
Sigmoid /act/Sigmoid
Mul /act/Mul
Conv /conv_out/Conv
INFO:tensorflow:Assets written to: /tmp/tmp4ytcnhfs/assets
INFO:tensorflow:Assets written to: /tmp/tmp4ytcnhfs/assets
2024-07-29 19:40:45.361096: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:45.361142: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:45.361275: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp4ytcnhfs
2024-07-29 19:40:45.361920: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:45.361960: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp4ytcnhfs
2024-07-29 19:40:45.363162: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:45.372983: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp4ytcnhfs
2024-07-29 19:40:45.376867: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 15593 microseconds.
2024-07-29 19:40:45.403978: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 46.535 M  ops, equivalently 23.267 M  MACs
INFO:converter running::tflite model elements' max error is 1.2666E-07, pass, tflite saved in ./tflite/cpusubgraph40.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph40.onnx to ./tflite/cpusubgraph40.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph5.onnx
Checking 0/1...
InstanceNormalization /down_blocks.1/resnets.0/norm1/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmpe7212iid/assets
INFO:tensorflow:Assets written to: /tmp/tmpe7212iid/assets
2024-07-29 19:40:45.610846: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:45.610898: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:45.611081: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpe7212iid
2024-07-29 19:40:45.611509: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:45.611547: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpe7212iid
2024-07-29 19:40:45.612248: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:45.615978: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpe7212iid
2024-07-29 19:40:45.619441: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 8362 microseconds.
2024-07-29 19:40:45.636412: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.164 M  ops, equivalently 0.082 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph5.onnx to ./tflite/cpusubgraph5.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph6.onnx
Checking 0/1...
Gemm /down_blocks.1/resnets.0/time_emb_proj/Gemm
Unsqueeze /down_blocks.1/resnets.0/Unsqueeze_1
Add /down_blocks.1/resnets.0/Add
(1, 640, 16, 16)
(1, 640, 1) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 640, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_130/Add:0', description="created by layer 'tf.math.add_130'")
Reshape /down_blocks.1/resnets.0/norm2/Reshape
input_shape: (1, 640, 16, 16) total_elements: 163840
[ 0 32 -1] 32
final_shape: [1, 32, 5120] dynamic_dim_size: 5120
Final shape: [1, 32, 5120]
InstanceNormalization /down_blocks.1/resnets.0/norm2/InstanceNormalization
INFO:tensorflow:Assets written to: /tmp/tmp1jwio34r/assets
INFO:tensorflow:Assets written to: /tmp/tmp1jwio34r/assets
2024-07-29 19:40:45.937409: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:45.937463: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:45.937598: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp1jwio34r
2024-07-29 19:40:45.937961: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:45.937988: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp1jwio34r
2024-07-29 19:40:45.938856: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:45.946810: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp1jwio34r
2024-07-29 19:40:45.950770: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 13173 microseconds.
2024-07-29 19:40:45.978021: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 2.131 M  ops, equivalently 1.065 M  MACs
INFO:converter running::tflite model elements' max error is 1.9312E-05, pass, tflite saved in ./tflite/cpusubgraph6.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph6.onnx to ./tflite/cpusubgraph6.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph7.onnx
Checking 0/1...
InstanceNormalization /down_blocks.1/attentions.0/norm/InstanceNormalization
Reshape /down_blocks.1/attentions.0/norm/Reshape_1
input_shape: (1, 32, 5120) total_elements: 163840
[  1 640  16  16] 163840
Final shape: [  1 640  16  16]
INFO:tensorflow:Assets written to: /tmp/tmp_6zetpu0/assets
INFO:tensorflow:Assets written to: /tmp/tmp_6zetpu0/assets
2024-07-29 19:40:46.251565: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:46.251622: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:46.251779: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp_6zetpu0
2024-07-29 19:40:46.252161: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:46.252195: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp_6zetpu0
2024-07-29 19:40:46.252895: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:46.256756: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp_6zetpu0
2024-07-29 19:40:46.259882: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 8103 microseconds.
2024-07-29 19:40:46.275530: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.328 M  ops, equivalently 0.164 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph7.onnx to ./tflite/cpusubgraph7.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph8.onnx
Checking 0/1...
Transpose /down_blocks.1/attentions.0/Transpose
Reshape /down_blocks.1/attentions.0/Reshape
input_shape: (1, 16, 16, 640) total_elements: 163840
[  1 256 640] 163840
Final shape: [  1 256 640]
ReduceMean /down_blocks.1/attentions.0/transformer_blocks.0/norm1/ReduceMean
Sub /down_blocks.1/attentions.0/transformer_blocks.0/norm1/Sub
Pow /down_blocks.1/attentions.0/transformer_blocks.0/norm1/Pow
ReduceMean /down_blocks.1/attentions.0/transformer_blocks.0/norm1/ReduceMean_1
Add /down_blocks.1/attentions.0/transformer_blocks.0/norm1/Add
(1, 256, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 1), dtype=tf.float32, name=None), name='tf.math.add_131/Add:0', description="created by layer 'tf.math.add_131'")
Sqrt /down_blocks.1/attentions.0/transformer_blocks.0/norm1/Sqrt
Div /down_blocks.1/attentions.0/transformer_blocks.0/norm1/Div
Mul /down_blocks.1/attentions.0/transformer_blocks.0/norm1/Mul
Add /down_blocks.1/attentions.0/transformer_blocks.0/norm1/Add_1
(1, 256, 640)
(640,) 1
[1, 256, 1]
1 1
1
256 1
256
640 640
1
tf.Tensor(
[[[-0.05228714  0.033129   -0.03415129 ... -0.04373334  0.00491952
   -0.0132064 ]
  [-0.05228714  0.033129   -0.03415129 ... -0.04373334  0.00491952
   -0.0132064 ]
  [-0.05228714  0.033129   -0.03415129 ... -0.04373334  0.00491952
   -0.0132064 ]
  ...
  [-0.05228714  0.033129   -0.03415129 ... -0.04373334  0.00491952
   -0.0132064 ]
  [-0.05228714  0.033129   -0.03415129 ... -0.04373334  0.00491952
   -0.0132064 ]
  [-0.05228714  0.033129   -0.03415129 ... -0.04373334  0.00491952
   -0.0132064 ]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_132/Add:0', description="created by layer 'tf.math.add_132'")
MatMul
Split
Reshape /down_blocks.1/attentions.0/transformer_blocks.0/attn1/Reshape
input_shape: (1, 256, 640) total_elements: 163840
[ 1 -1  8 80] 640
final_shape: [1, 256, 8, 80] dynamic_dim_size: 256
Final shape: [1, 256, 8, 80]
Transpose /down_blocks.1/attentions.0/transformer_blocks.0/attn1/Transpose
Reshape /down_blocks.1/attentions.0/transformer_blocks.0/attn1/Reshape_1
input_shape: (1, 256, 640) total_elements: 163840
[ 1 -1  8 80] 640
final_shape: [1, 256, 8, 80] dynamic_dim_size: 256
Final shape: [1, 256, 8, 80]
Reshape /down_blocks.1/attentions.0/transformer_blocks.0/attn1/Reshape_2
input_shape: (1, 256, 640) total_elements: 163840
[ 1 -1  8 80] 640
final_shape: [1, 256, 8, 80] dynamic_dim_size: 256
Final shape: [1, 256, 8, 80]
Transpose /down_blocks.1/attentions.0/transformer_blocks.0/attn1/Transpose_1
Transpose /down_blocks.1/attentions.0/transformer_blocks.0/attn1/Transpose_2
Mul /down_blocks.1/attentions.0/transformer_blocks.0/attn1/Mul
Mul /down_blocks.1/attentions.0/transformer_blocks.0/attn1/Mul_1
MatMul /down_blocks.1/attentions.0/transformer_blocks.0/attn1/MatMul
Softmax /down_blocks.1/attentions.0/transformer_blocks.0/attn1/Softmax
MatMul /down_blocks.1/attentions.0/transformer_blocks.0/attn1/MatMul_1
Transpose /down_blocks.1/attentions.0/transformer_blocks.0/attn1/Transpose_3
Reshape /down_blocks.1/attentions.0/transformer_blocks.0/attn1/Reshape_3
input_shape: (1, 256, 8, 80) total_elements: 163840
[  1  -1 640] 640
final_shape: [1, 256, 640] dynamic_dim_size: 256
Final shape: [1, 256, 640]
MatMul /down_blocks.1/attentions.0/transformer_blocks.0/attn1/to_out.0/MatMul
Add /down_blocks.1/attentions.0/transformer_blocks.0/attn1/to_out.0/Add
(640,)
(1, 256, 640) 3
[1, 256, 1]
tf.Tensor(
[[[-0.00189137  0.00397263 -0.04272177 ...  0.05390953  0.08406179
   -0.00875048]
  [-0.00189137  0.00397263 -0.04272177 ...  0.05390953  0.08406179
   -0.00875048]
  [-0.00189137  0.00397263 -0.04272177 ...  0.05390953  0.08406179
   -0.00875048]
  ...
  [-0.00189137  0.00397263 -0.04272177 ...  0.05390953  0.08406179
   -0.00875048]
  [-0.00189137  0.00397263 -0.04272177 ...  0.05390953  0.08406179
   -0.00875048]
  [-0.00189137  0.00397263 -0.04272177 ...  0.05390953  0.08406179
   -0.00875048]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_133/Add:0', description="created by layer 'tf.math.add_133'")
Add /down_blocks.1/attentions.0/transformer_blocks.0/Add
(1, 256, 640)
(1, 256, 640) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_134/Add:0', description="created by layer 'tf.math.add_134'")
ReduceMean /down_blocks.1/attentions.0/transformer_blocks.0/norm2/ReduceMean
Sub /down_blocks.1/attentions.0/transformer_blocks.0/norm2/Sub
Pow /down_blocks.1/attentions.0/transformer_blocks.0/norm2/Pow
ReduceMean /down_blocks.1/attentions.0/transformer_blocks.0/norm2/ReduceMean_1
Add /down_blocks.1/attentions.0/transformer_blocks.0/norm2/Add
(1, 256, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 1), dtype=tf.float32, name=None), name='tf.math.add_135/Add:0', description="created by layer 'tf.math.add_135'")
Sqrt /down_blocks.1/attentions.0/transformer_blocks.0/norm2/Sqrt
Div /down_blocks.1/attentions.0/transformer_blocks.0/norm2/Div
Mul /down_blocks.1/attentions.0/transformer_blocks.0/norm2/Mul
Add /down_blocks.1/attentions.0/transformer_blocks.0/norm2/Add_1
(1, 256, 640)
(640,) 1
[1, 256, 1]
1 1
1
256 1
256
640 640
1
tf.Tensor(
[[[ 0.03407499 -0.09620389 -0.04436909 ...  0.05160974  0.01970594
   -0.0239818 ]
  [ 0.03407499 -0.09620389 -0.04436909 ...  0.05160974  0.01970594
   -0.0239818 ]
  [ 0.03407499 -0.09620389 -0.04436909 ...  0.05160974  0.01970594
   -0.0239818 ]
  ...
  [ 0.03407499 -0.09620389 -0.04436909 ...  0.05160974  0.01970594
   -0.0239818 ]
  [ 0.03407499 -0.09620389 -0.04436909 ...  0.05160974  0.01970594
   -0.0239818 ]
  [ 0.03407499 -0.09620389 -0.04436909 ...  0.05160974  0.01970594
   -0.0239818 ]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_136/Add:0', description="created by layer 'tf.math.add_136'")
MatMul /down_blocks.1/attentions.0/transformer_blocks.0/attn2/to_q/MatMul
MatMul /down_blocks.1/attentions.0/transformer_blocks.0/attn2/to_k/MatMul
MatMul /down_blocks.1/attentions.0/transformer_blocks.0/attn2/to_v/MatMul
Reshape /down_blocks.1/attentions.0/transformer_blocks.0/attn2/Reshape
input_shape: (1, 256, 640) total_elements: 163840
[ 1 -1  8 80] 640
final_shape: [1, 256, 8, 80] dynamic_dim_size: 256
Final shape: [1, 256, 8, 80]
Transpose /down_blocks.1/attentions.0/transformer_blocks.0/attn2/Transpose
Reshape /down_blocks.1/attentions.0/transformer_blocks.0/attn2/Reshape_1
input_shape: (1, 77, 640) total_elements: 49280
[ 1 -1  8 80] 640
final_shape: [1, 77, 8, 80] dynamic_dim_size: 77
Final shape: [1, 77, 8, 80]
Reshape /down_blocks.1/attentions.0/transformer_blocks.0/attn2/Reshape_2
input_shape: (1, 77, 640) total_elements: 49280
[ 1 -1  8 80] 640
final_shape: [1, 77, 8, 80] dynamic_dim_size: 77
Final shape: [1, 77, 8, 80]
Transpose /down_blocks.1/attentions.0/transformer_blocks.0/attn2/Transpose_1
Transpose /down_blocks.1/attentions.0/transformer_blocks.0/attn2/Transpose_2
Mul /down_blocks.1/attentions.0/transformer_blocks.0/attn2/Mul
Mul /down_blocks.1/attentions.0/transformer_blocks.0/attn2/Mul_1
MatMul /down_blocks.1/attentions.0/transformer_blocks.0/attn2/MatMul
Softmax /down_blocks.1/attentions.0/transformer_blocks.0/attn2/Softmax
MatMul /down_blocks.1/attentions.0/transformer_blocks.0/attn2/MatMul_1
Transpose /down_blocks.1/attentions.0/transformer_blocks.0/attn2/Transpose_3
Reshape /down_blocks.1/attentions.0/transformer_blocks.0/attn2/Reshape_3
input_shape: (1, 256, 8, 80) total_elements: 163840
[  1  -1 640] 640
final_shape: [1, 256, 640] dynamic_dim_size: 256
Final shape: [1, 256, 640]
MatMul /down_blocks.1/attentions.0/transformer_blocks.0/attn2/to_out.0/MatMul
Add /down_blocks.1/attentions.0/transformer_blocks.0/attn2/to_out.0/Add
(640,)
(1, 256, 640) 3
[1, 256, 1]
tf.Tensor(
[[[-0.01751149  0.01395797 -0.07166293 ...  0.03818983  0.06787971
   -0.00264349]
  [-0.01751149  0.01395797 -0.07166293 ...  0.03818983  0.06787971
   -0.00264349]
  [-0.01751149  0.01395797 -0.07166293 ...  0.03818983  0.06787971
   -0.00264349]
  ...
  [-0.01751149  0.01395797 -0.07166293 ...  0.03818983  0.06787971
   -0.00264349]
  [-0.01751149  0.01395797 -0.07166293 ...  0.03818983  0.06787971
   -0.00264349]
  [-0.01751149  0.01395797 -0.07166293 ...  0.03818983  0.06787971
   -0.00264349]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_137/Add:0', description="created by layer 'tf.math.add_137'")
Add /down_blocks.1/attentions.0/transformer_blocks.0/Add_1
(1, 256, 640)
(1, 256, 640) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_138/Add:0', description="created by layer 'tf.math.add_138'")
ReduceMean /down_blocks.1/attentions.0/transformer_blocks.0/norm3/ReduceMean
Sub /down_blocks.1/attentions.0/transformer_blocks.0/norm3/Sub
Pow /down_blocks.1/attentions.0/transformer_blocks.0/norm3/Pow
ReduceMean /down_blocks.1/attentions.0/transformer_blocks.0/norm3/ReduceMean_1
Add /down_blocks.1/attentions.0/transformer_blocks.0/norm3/Add
(1, 256, 1)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 1), dtype=tf.float32, name=None), name='tf.math.add_139/Add:0', description="created by layer 'tf.math.add_139'")
Sqrt /down_blocks.1/attentions.0/transformer_blocks.0/norm3/Sqrt
Div /down_blocks.1/attentions.0/transformer_blocks.0/norm3/Div
Mul /down_blocks.1/attentions.0/transformer_blocks.0/norm3/Mul
Add /down_blocks.1/attentions.0/transformer_blocks.0/norm3/Add_1
(1, 256, 640)
(640,) 1
[1, 256, 1]
1 1
1
256 1
256
640 640
1
tf.Tensor(
[[[ 0.01159148 -0.05234969  0.05057145 ... -0.0680223  -0.10851382
   -0.01433946]
  [ 0.01159148 -0.05234969  0.05057145 ... -0.0680223  -0.10851382
   -0.01433946]
  [ 0.01159148 -0.05234969  0.05057145 ... -0.0680223  -0.10851382
   -0.01433946]
  ...
  [ 0.01159148 -0.05234969  0.05057145 ... -0.0680223  -0.10851382
   -0.01433946]
  [ 0.01159148 -0.05234969  0.05057145 ... -0.0680223  -0.10851382
   -0.01433946]
  [ 0.01159148 -0.05234969  0.05057145 ... -0.0680223  -0.10851382
   -0.01433946]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_140/Add:0', description="created by layer 'tf.math.add_140'")
MatMul /down_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/proj/MatMul
Add /down_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/proj/Add
(5120,)
(1, 256, 5120) 3
[1, 256, 1]
tf.Tensor(
[[[-0.09035259  0.02924731 -0.05960021 ... -0.06654941  0.04740324
    0.0132081 ]
  [-0.09035259  0.02924731 -0.05960021 ... -0.06654941  0.04740324
    0.0132081 ]
  [-0.09035259  0.02924731 -0.05960021 ... -0.06654941  0.04740324
    0.0132081 ]
  ...
  [-0.09035259  0.02924731 -0.05960021 ... -0.06654941  0.04740324
    0.0132081 ]
  [-0.09035259  0.02924731 -0.05960021 ... -0.06654941  0.04740324
    0.0132081 ]
  [-0.09035259  0.02924731 -0.05960021 ... -0.06654941  0.04740324
    0.0132081 ]]], shape=(1, 256, 5120), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 5120), dtype=tf.float32, name=None), name='tf.math.add_141/Add:0', description="created by layer 'tf.math.add_141'")
Slice /down_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Slice
Slice /down_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Slice_1
Div /down_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Div_1
Erf /down_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Erf
Add /down_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Add_1
(1, 256, 2560)
() 0
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 2560), dtype=tf.float32, name=None), name='tf.math.add_142/Add:0', description="created by layer 'tf.math.add_142'")
Mul /down_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Mul_2
Mul /down_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Mul_3
Mul /down_blocks.1/attentions.0/transformer_blocks.0/ff/net.0/Mul_4
MatMul /down_blocks.1/attentions.0/transformer_blocks.0/ff/net.2/MatMul
Add /down_blocks.1/attentions.0/transformer_blocks.0/ff/net.2/Add
(640,)
(1, 256, 640) 3
[1, 256, 1]
tf.Tensor(
[[[ 0.00270554  0.00583615  0.00052963 ...  0.00913089  0.02834412
   -0.00514166]
  [ 0.00270554  0.00583615  0.00052963 ...  0.00913089  0.02834412
   -0.00514166]
  [ 0.00270554  0.00583615  0.00052963 ...  0.00913089  0.02834412
   -0.00514166]
  ...
  [ 0.00270554  0.00583615  0.00052963 ...  0.00913089  0.02834412
   -0.00514166]
  [ 0.00270554  0.00583615  0.00052963 ...  0.00913089  0.02834412
   -0.00514166]
  [ 0.00270554  0.00583615  0.00052963 ...  0.00913089  0.02834412
   -0.00514166]]], shape=(1, 256, 640), dtype=float32)
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_143/Add:0', description="created by layer 'tf.math.add_143'")
Add /down_blocks.1/attentions.0/transformer_blocks.0/Add_2
(1, 256, 640)
(1, 256, 640) 3
KerasTensor(type_spec=TensorSpec(shape=(1, 256, 640), dtype=tf.float32, name=None), name='tf.math.add_144/Add:0', description="created by layer 'tf.math.add_144'")
Reshape /down_blocks.1/attentions.0/Reshape_1
input_shape: (1, 256, 640) total_elements: 163840
[  1  16  16 640] 163840
Final shape: [  1  16  16 640]
Transpose /down_blocks.1/attentions.0/Transpose_1
INFO:tensorflow:Assets written to: /tmp/tmpzvn8__98/assets
INFO:tensorflow:Assets written to: /tmp/tmpzvn8__98/assets
2024-07-29 19:40:54.852072: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:54.852137: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:54.852301: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpzvn8__98
2024-07-29 19:40:54.855033: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:54.855084: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpzvn8__98
2024-07-29 19:40:54.860133: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:54.889752: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpzvn8__98
2024-07-29 19:40:54.901770: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 49470 microseconds.
2024-07-29 19:40:55.038256: W tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2073] TFLite interpreter needs to link Flex delegate in order to run the model since it contains the following Select TFop(s):
Flex ops: FlexErf
Details:
        tf.Erf(tensor<1x256x2560xf32>) -> (tensor<1x256x2560xf32>) : {device = ""}
See instructions: https://www.tensorflow.org/lite/guide/ops_select
2024-07-29 19:40:55.038329: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 4.197 G  ops, equivalently 2.098 G  MACs
2024-07-29 19:40:55.562162: I tensorflow/compiler/xla/stream_executor/cuda/cuda_gpu_executor.cc:981] could not open file to read NUMA node: /sys/bus/pci/devices/0000:01:00.0/numa_node
Your kernel may have been built without NUMA support.
2024-07-29 19:40:55.562211: W tensorflow/core/common_runtime/gpu/gpu_device.cc:1960] Cannot dlopen some GPU libraries. Please make sure the missing libraries mentioned above are installed properly if you would like to use GPU. Follow the guide at https://www.tensorflow.org/install/gpu for how to download and setup the required libraries for your platform.
Skipping registering GPU devices...
INFO:converter running::tflite model elements' max error is 1.1683E-05, pass, tflite saved in ./tflite/cpusubgraph8.tflite
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph8.onnx to ./tflite/cpusubgraph8.tflite
../Compiler/sg/subgraphs_cpu/cpusubgraph9.onnx
Checking 0/1...
Add /down_blocks.1/attentions.0/Add
(1, 640, 16, 16)
(1, 640, 16, 16) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 640, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_145/Add:0', description="created by layer 'tf.math.add_145'")
INFO:tensorflow:Assets written to: /tmp/tmpfcv3d4tn/assets
INFO:tensorflow:Assets written to: /tmp/tmpfcv3d4tn/assets
2024-07-29 19:40:56.550997: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:56.551043: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:56.551169: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpfcv3d4tn
2024-07-29 19:40:56.551394: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:56.551418: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpfcv3d4tn
2024-07-29 19:40:56.551979: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:56.554831: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpfcv3d4tn
2024-07-29 19:40:56.557118: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 5950 microseconds.
2024-07-29 19:40:56.568070: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 0.164 M  ops, equivalently 0.082 M  MACs
Converted ../Compiler/sg/subgraphs_cpu/cpusubgraph9.onnx to ./tflite/cpusubgraph9.tflite
../Compiler/sg/subgraphs_npu/npusubgraph0.onnx
Checking 0/1...
Conv /conv_in/Conv
Reshape /down_blocks.0/resnets.0/norm1/Reshape
input_shape: (1, 320, 32, 32) total_elements: 327680
[ 0 32 -1] 32
final_shape: [1, 32, 10240] dynamic_dim_size: 10240
Final shape: [1, 32, 10240]
INFO:tensorflow:Assets written to: /tmp/tmpcs2bw6vv/assets
INFO:tensorflow:Assets written to: /tmp/tmpcs2bw6vv/assets
2024-07-29 19:40:56.763862: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:56.763920: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:56.764065: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpcs2bw6vv
2024-07-29 19:40:56.764441: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:56.764472: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpcs2bw6vv
2024-07-29 19:40:56.765233: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:56.772856: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpcs2bw6vv
2024-07-29 19:40:56.775914: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 11851 microseconds.
2024-07-29 19:40:56.795266: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 23.921 M  ops, equivalently 11.960 M  MACs
ERROR:converter running::tflite model elements' max error has reached 1.0000E+03, but convert is done, please check ./tflite/npusubgraph0.tflite carefully!
Converted ../Compiler/sg/subgraphs_npu/npusubgraph0.onnx to ./tflite/npusubgraph0.tflite
../Compiler/sg/subgraphs_npu/npusubgraph1.onnx
Checking 0/1...
Reshape /down_blocks.0/resnets.0/norm1/Reshape_1
input_shape: (1, 32, 10240) total_elements: 327680
[  1 320  32  32] 327680
Final shape: [  1 320  32  32]
Mul /down_blocks.0/resnets.0/norm1/Mul
Add /down_blocks.0/resnets.0/norm1/Add
(1, 320, 32, 32)
(320, 1, 1) 3
(320, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_146/Add:0', description="created by layer 'tf.math.add_146'")
Sigmoid /down_blocks.0/resnets.0/act/Sigmoid
Mul /down_blocks.0/resnets.0/act/Mul
Conv /down_blocks.0/resnets.0/conv1/Conv
INFO:tensorflow:Assets written to: /tmp/tmp68gjrmjb/assets
INFO:tensorflow:Assets written to: /tmp/tmp68gjrmjb/assets
2024-07-29 19:40:57.996163: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:57.996236: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:57.996439: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp68gjrmjb
2024-07-29 19:40:57.997235: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:57.997289: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp68gjrmjb
2024-07-29 19:40:57.998784: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:58.009017: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp68gjrmjb
2024-07-29 19:40:58.013596: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 17159 microseconds.
2024-07-29 19:40:58.044086: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 1.910 G  ops, equivalently 0.955 G  MACs
INFO:converter running::tflite model elements' max error is 1.0967E-05, pass, tflite saved in ./tflite/npusubgraph1.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph1.onnx to ./tflite/npusubgraph1.tflite
../Compiler/sg/subgraphs_npu/npusubgraph10.onnx
Checking 0/1...
Conv /down_blocks.1/downsamplers.0/conv/Conv
Reshape /down_blocks.2/resnets.0/norm1/Reshape
input_shape: (1, 640, 8, 8) total_elements: 40960
[ 0 32 -1] 32
final_shape: [1, 32, 1280] dynamic_dim_size: 1280
Final shape: [1, 32, 1280]
INFO:tensorflow:Assets written to: /tmp/tmpgqjm15tl/assets
INFO:tensorflow:Assets written to: /tmp/tmpgqjm15tl/assets
2024-07-29 19:40:58.598339: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:58.598383: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:58.598499: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpgqjm15tl
2024-07-29 19:40:58.598890: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:58.598915: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpgqjm15tl
2024-07-29 19:40:58.600192: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:58.611260: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpgqjm15tl
2024-07-29 19:40:58.614383: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 15885 microseconds.
2024-07-29 19:40:58.658394: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 471.900 M  ops, equivalently 235.950 M  MACs
ERROR:converter running::tflite model elements' max error has reached 1.0000E+03, but convert is done, please check ./tflite/npusubgraph10.tflite carefully!
Converted ../Compiler/sg/subgraphs_npu/npusubgraph10.onnx to ./tflite/npusubgraph10.tflite
../Compiler/sg/subgraphs_npu/npusubgraph11.onnx
Checking 0/1...
Reshape /down_blocks.2/resnets.0/norm1/Reshape_1
input_shape: (1, 32, 1280) total_elements: 40960
[  1 640   8   8] 40960
Final shape: [  1 640   8   8]
Mul /down_blocks.2/resnets.0/norm1/Mul
Add /down_blocks.2/resnets.0/norm1/Add
(1, 640, 8, 8)
(640, 1, 1) 3
(640, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 640, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_147/Add:0', description="created by layer 'tf.math.add_147'")
Sigmoid /down_blocks.2/resnets.0/act/Sigmoid
Mul /down_blocks.2/resnets.0/act/Mul
Conv /down_blocks.2/resnets.0/conv1/Conv
INFO:tensorflow:Assets written to: /tmp/tmp1uq9y7iv/assets
INFO:tensorflow:Assets written to: /tmp/tmp1uq9y7iv/assets
2024-07-29 19:40:59.835102: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:40:59.835158: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:40:59.835350: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp1uq9y7iv
2024-07-29 19:40:59.836080: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:40:59.836123: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp1uq9y7iv
2024-07-29 19:40:59.837451: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:40:59.852995: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp1uq9y7iv
2024-07-29 19:40:59.856557: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 21211 microseconds.
2024-07-29 19:40:59.926909: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 946.545 M  ops, equivalently 473.272 M  MACs
WARNING:converter running::tflite model elements' max error is 1.4496E-04, pass, tflite saved in ./tflite/npusubgraph11.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph11.onnx to ./tflite/npusubgraph11.tflite
../Compiler/sg/subgraphs_npu/npusubgraph12.onnx
Checking 0/1...
Reshape /down_blocks.2/resnets.0/norm2/Reshape_1
input_shape: (1, 32, 2560) total_elements: 81920
[   1 1280    8    8] 81920
Final shape: [   1 1280    8    8]
Mul /down_blocks.2/resnets.0/norm2/Mul
Add /down_blocks.2/resnets.0/norm2/Add
(1, 1280, 8, 8)
(1280, 1, 1) 3
(1280, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 1280, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_148/Add:0', description="created by layer 'tf.math.add_148'")
Sigmoid /down_blocks.2/resnets.0/act_1/Sigmoid
Mul /down_blocks.2/resnets.0/act_1/Mul
Conv /down_blocks.2/resnets.0/conv2/Conv
Conv /down_blocks.2/resnets.0/conv_shortcut/Conv
Add /down_blocks.2/resnets.0/Add_1
(1, 8, 8, 1280)
(1, 8, 8, 1280) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 8, 8, 1280), dtype=tf.float32, name=None), name='tf.math.add_149/Add:0', description="created by layer 'tf.math.add_149'")
Reshape /down_blocks.2/attentions.0/norm/Reshape
input_shape: (1, 1280, 8, 8) total_elements: 81920
[ 0 32 -1] 32
final_shape: [1, 32, 2560] dynamic_dim_size: 2560
Final shape: [1, 32, 2560]
INFO:tensorflow:Assets written to: /tmp/tmpj5v8dbxl/assets
INFO:tensorflow:Assets written to: /tmp/tmpj5v8dbxl/assets
2024-07-29 19:41:02.304732: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:02.304826: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:02.305069: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpj5v8dbxl
2024-07-29 19:41:02.305964: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:02.306049: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpj5v8dbxl
2024-07-29 19:41:02.308307: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:02.405296: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpj5v8dbxl
2024-07-29 19:41:02.412691: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 107624 microseconds.
2024-07-29 19:41:02.779059: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 1.998 G  ops, equivalently 0.999 G  MACs
INFO:converter running::tflite model elements' max error is 1.6689E-05, pass, tflite saved in ./tflite/npusubgraph12.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph12.onnx to ./tflite/npusubgraph12.tflite
../Compiler/sg/subgraphs_npu/npusubgraph13.onnx
Checking 0/1...
Mul /down_blocks.2/attentions.0/norm/Mul
Add /down_blocks.2/attentions.0/norm/Add
(1, 1280, 8, 8)
(1280, 1, 1) 3
(1280, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 1280, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_150/Add:0', description="created by layer 'tf.math.add_150'")
Conv /down_blocks.2/attentions.0/proj_in/Conv
INFO:tensorflow:Assets written to: /tmp/tmp8uqjnoi7/assets
INFO:tensorflow:Assets written to: /tmp/tmp8uqjnoi7/assets
2024-07-29 19:41:05.395436: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:05.395494: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:05.395658: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp8uqjnoi7
2024-07-29 19:41:05.396083: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:05.396116: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp8uqjnoi7
2024-07-29 19:41:05.397179: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:05.407234: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp8uqjnoi7
2024-07-29 19:41:05.411176: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 15519 microseconds.
2024-07-29 19:41:05.448181: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 209.961 M  ops, equivalently 104.980 M  MACs
INFO:converter running::tflite model elements' max error is 1.3351E-05, pass, tflite saved in ./tflite/npusubgraph13.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph13.onnx to ./tflite/npusubgraph13.tflite
../Compiler/sg/subgraphs_npu/npusubgraph14.onnx
Checking 0/1...
Conv /down_blocks.2/attentions.0/proj_out/Conv
INFO:tensorflow:Assets written to: /tmp/tmpc7228t4e/assets
INFO:tensorflow:Assets written to: /tmp/tmpc7228t4e/assets
2024-07-29 19:41:06.262420: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:06.262514: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:06.262768: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpc7228t4e
2024-07-29 19:41:06.263919: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:06.263979: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpc7228t4e
2024-07-29 19:41:06.266078: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:06.313754: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpc7228t4e
2024-07-29 19:41:06.328633: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 65868 microseconds.
2024-07-29 19:41:06.429478: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 209.797 M  ops, equivalently 104.899 M  MACs
INFO:converter running::tflite model elements' max error is 4.8876E-06, pass, tflite saved in ./tflite/npusubgraph14.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph14.onnx to ./tflite/npusubgraph14.tflite
../Compiler/sg/subgraphs_npu/npusubgraph15.onnx
Checking 0/1...
Reshape /up_blocks.0/resnets.0/norm1/Reshape_1
input_shape: (1, 32, 5120) total_elements: 163840
[   1 2560    8    8] 163840
Final shape: [   1 2560    8    8]
Mul /up_blocks.0/resnets.0/norm1/Mul
Add /up_blocks.0/resnets.0/norm1/Add
(1, 2560, 8, 8)
(2560, 1, 1) 3
(2560, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 2560, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_151/Add:0', description="created by layer 'tf.math.add_151'")
Sigmoid /up_blocks.0/resnets.0/act/Sigmoid
Mul /up_blocks.0/resnets.0/act/Mul
Conv /up_blocks.0/resnets.0/conv1/Conv
INFO:tensorflow:Assets written to: /tmp/tmpzxm12jqo/assets
INFO:tensorflow:Assets written to: /tmp/tmpzxm12jqo/assets
2024-07-29 19:41:09.660721: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:09.660765: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:09.660917: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpzxm12jqo
2024-07-29 19:41:09.661414: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:09.661450: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpzxm12jqo
2024-07-29 19:41:09.662404: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:09.704893: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpzxm12jqo
2024-07-29 19:41:09.710632: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 49713 microseconds.
2024-07-29 19:41:09.968584: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 3.786 G  ops, equivalently 1.893 G  MACs
WARNING:converter running::tflite model elements' max error is 2.5177E-04, pass, tflite saved in ./tflite/npusubgraph15.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph15.onnx to ./tflite/npusubgraph15.tflite
../Compiler/sg/subgraphs_npu/npusubgraph16.onnx
Checking 0/1...
Reshape /up_blocks.0/resnets.0/norm2/Reshape_1
input_shape: (1, 32, 2560) total_elements: 81920
[   1 1280    8    8] 81920
Final shape: [   1 1280    8    8]
Mul /up_blocks.0/resnets.0/norm2/Mul
Add /up_blocks.0/resnets.0/norm2/Add
(1, 1280, 8, 8)
(1280, 1, 1) 3
(1280, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 1280, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_152/Add:0', description="created by layer 'tf.math.add_152'")
Sigmoid /up_blocks.0/resnets.0/act_1/Sigmoid
Mul /up_blocks.0/resnets.0/act_1/Mul
Conv /up_blocks.0/resnets.0/conv2/Conv
Conv /up_blocks.0/resnets.0/conv_shortcut/Conv
Add /up_blocks.0/resnets.0/Add_1
(1, 8, 8, 1280)
(1, 8, 8, 1280) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 8, 8, 1280), dtype=tf.float32, name=None), name='tf.math.add_153/Add:0', description="created by layer 'tf.math.add_153'")
Reshape /up_blocks.0/attentions.0/norm/Reshape
input_shape: (1, 1280, 8, 8) total_elements: 81920
[ 0 32 -1] 32
final_shape: [1, 32, 2560] dynamic_dim_size: 2560
Final shape: [1, 32, 2560]
INFO:tensorflow:Assets written to: /tmp/tmpzv2sjqqj/assets
INFO:tensorflow:Assets written to: /tmp/tmpzv2sjqqj/assets
2024-07-29 19:41:15.294133: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:15.294186: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:15.294351: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpzv2sjqqj
2024-07-29 19:41:15.294898: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:15.294932: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpzv2sjqqj
2024-07-29 19:41:15.296202: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:15.326148: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpzv2sjqqj
2024-07-29 19:41:15.330469: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 36120 microseconds.
2024-07-29 19:41:15.464800: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 2.313 G  ops, equivalently 1.156 G  MACs
ERROR:converter running::tflite model elements' max error has reached 1.0000E+03, but convert is done, please check ./tflite/npusubgraph16.tflite carefully!
Converted ../Compiler/sg/subgraphs_npu/npusubgraph16.onnx to ./tflite/npusubgraph16.tflite
../Compiler/sg/subgraphs_npu/npusubgraph17.onnx
Checking 0/1...
Mul /up_blocks.0/attentions.0/norm/Mul
Add /up_blocks.0/attentions.0/norm/Add
(1, 1280, 8, 8)
(1280, 1, 1) 3
(1280, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 1280, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_154/Add:0', description="created by layer 'tf.math.add_154'")
Conv /up_blocks.0/attentions.0/proj_in/Conv
INFO:tensorflow:Assets written to: /tmp/tmpxmr38ron/assets
INFO:tensorflow:Assets written to: /tmp/tmpxmr38ron/assets
2024-07-29 19:41:17.926172: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:17.926215: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:17.926340: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpxmr38ron
2024-07-29 19:41:17.926773: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:17.926812: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpxmr38ron
2024-07-29 19:41:17.927654: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:17.936300: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpxmr38ron
2024-07-29 19:41:17.939779: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 13439 microseconds.
2024-07-29 19:41:17.972169: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 209.961 M  ops, equivalently 104.980 M  MACs
INFO:converter running::tflite model elements' max error is 1.7166E-05, pass, tflite saved in ./tflite/npusubgraph17.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph17.onnx to ./tflite/npusubgraph17.tflite
../Compiler/sg/subgraphs_npu/npusubgraph18.onnx
Checking 0/1...
Conv /up_blocks.0/attentions.0/proj_out/Conv
INFO:tensorflow:Assets written to: /tmp/tmpq0q_wkr1/assets
INFO:tensorflow:Assets written to: /tmp/tmpq0q_wkr1/assets
2024-07-29 19:41:18.401825: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:18.401876: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:18.402017: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpq0q_wkr1
2024-07-29 19:41:18.402526: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:18.402558: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpq0q_wkr1
2024-07-29 19:41:18.403531: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:18.411960: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpq0q_wkr1
2024-07-29 19:41:18.414841: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 12826 microseconds.
2024-07-29 19:41:18.443805: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 209.797 M  ops, equivalently 104.899 M  MACs
INFO:converter running::tflite model elements' max error is 8.5831E-06, pass, tflite saved in ./tflite/npusubgraph18.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph18.onnx to ./tflite/npusubgraph18.tflite
../Compiler/sg/subgraphs_npu/npusubgraph19.onnx
Checking 0/1...
Reshape /up_blocks.0/resnets.1/norm1/Reshape_1
input_shape: (1, 32, 3840) total_elements: 122880
[   1 1920    8    8] 122880
Final shape: [   1 1920    8    8]
Mul /up_blocks.0/resnets.1/norm1/Mul
Add /up_blocks.0/resnets.1/norm1/Add
(1, 1920, 8, 8)
(1920, 1, 1) 3
(1920, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 1920, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_155/Add:0', description="created by layer 'tf.math.add_155'")
Sigmoid /up_blocks.0/resnets.1/act/Sigmoid
Mul /up_blocks.0/resnets.1/act/Mul
Conv /up_blocks.0/resnets.1/conv1/Conv
INFO:tensorflow:Assets written to: /tmp/tmpqd5f9mep/assets
INFO:tensorflow:Assets written to: /tmp/tmpqd5f9mep/assets
2024-07-29 19:41:20.563373: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:20.563426: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:20.563599: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpqd5f9mep
2024-07-29 19:41:20.564313: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:20.564362: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpqd5f9mep
2024-07-29 19:41:20.565642: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:20.600220: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpqd5f9mep
2024-07-29 19:41:20.604722: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 41124 microseconds.
2024-07-29 19:41:20.785505: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 2.839 G  ops, equivalently 1.420 G  MACs
WARNING:converter running::tflite model elements' max error is 3.2806E-04, pass, tflite saved in ./tflite/npusubgraph19.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph19.onnx to ./tflite/npusubgraph19.tflite
../Compiler/sg/subgraphs_npu/npusubgraph2.onnx
Checking 0/1...
Reshape /down_blocks.0/resnets.0/norm2/Reshape_1
input_shape: (1, 32, 10240) total_elements: 327680
[  1 320  32  32] 327680
Final shape: [  1 320  32  32]
Mul /down_blocks.0/resnets.0/norm2/Mul
Add /down_blocks.0/resnets.0/norm2/Add
(1, 320, 32, 32)
(320, 1, 1) 3
(320, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_156/Add:0', description="created by layer 'tf.math.add_156'")
Sigmoid /down_blocks.0/resnets.0/act_2/Sigmoid
Mul /down_blocks.0/resnets.0/act_2/Mul
Conv /down_blocks.0/resnets.0/conv2/Conv
INFO:tensorflow:Assets written to: /tmp/tmpdtimpbp9/assets
INFO:tensorflow:Assets written to: /tmp/tmpdtimpbp9/assets
2024-07-29 19:41:24.699114: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:24.699186: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:24.699366: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpdtimpbp9
2024-07-29 19:41:24.700135: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:24.700181: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpdtimpbp9
2024-07-29 19:41:24.701532: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:24.711795: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpdtimpbp9
2024-07-29 19:41:24.715807: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 16443 microseconds.
2024-07-29 19:41:24.745369: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 1.910 G  ops, equivalently 0.955 G  MACs
INFO:converter running::tflite model elements' max error is 4.5300E-06, pass, tflite saved in ./tflite/npusubgraph2.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph2.onnx to ./tflite/npusubgraph2.tflite
../Compiler/sg/subgraphs_npu/npusubgraph20.onnx
Checking 0/1...
Reshape /up_blocks.0/resnets.1/norm2/Reshape_1
input_shape: (1, 32, 2560) total_elements: 81920
[   1 1280    8    8] 81920
Final shape: [   1 1280    8    8]
Mul /up_blocks.0/resnets.1/norm2/Mul
Add /up_blocks.0/resnets.1/norm2/Add
(1, 1280, 8, 8)
(1280, 1, 1) 3
(1280, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 1280, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_157/Add:0', description="created by layer 'tf.math.add_157'")
Sigmoid /up_blocks.0/resnets.1/act_1/Sigmoid
Mul /up_blocks.0/resnets.1/act_1/Mul
Conv /up_blocks.0/resnets.1/conv2/Conv
Conv /up_blocks.0/resnets.1/conv_shortcut/Conv
Add /up_blocks.0/resnets.1/Add_1
(1, 8, 8, 1280)
(1, 8, 8, 1280) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 8, 8, 1280), dtype=tf.float32, name=None), name='tf.math.add_158/Add:0', description="created by layer 'tf.math.add_158'")
Reshape /up_blocks.0/attentions.1/norm/Reshape
input_shape: (1, 1280, 8, 8) total_elements: 81920
[ 0 32 -1] 32
final_shape: [1, 32, 2560] dynamic_dim_size: 2560
Final shape: [1, 32, 2560]
INFO:tensorflow:Assets written to: /tmp/tmpncngdhki/assets
INFO:tensorflow:Assets written to: /tmp/tmpncngdhki/assets
2024-07-29 19:41:26.351675: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:26.351735: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:26.351908: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpncngdhki
2024-07-29 19:41:26.352628: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:26.352666: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpncngdhki
2024-07-29 19:41:26.353871: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:26.380628: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpncngdhki
2024-07-29 19:41:26.385184: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 33279 microseconds.
2024-07-29 19:41:26.516416: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 2.208 G  ops, equivalently 1.104 G  MACs
ERROR:converter running::tflite model elements' max error has reached 1.0000E+03, but convert is done, please check ./tflite/npusubgraph20.tflite carefully!
Converted ../Compiler/sg/subgraphs_npu/npusubgraph20.onnx to ./tflite/npusubgraph20.tflite
../Compiler/sg/subgraphs_npu/npusubgraph21.onnx
Checking 0/1...
Mul /up_blocks.0/attentions.1/norm/Mul
Add /up_blocks.0/attentions.1/norm/Add
(1, 1280, 8, 8)
(1280, 1, 1) 3
(1280, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 1280, 8, 8), dtype=tf.float32, name=None), name='tf.math.add_159/Add:0', description="created by layer 'tf.math.add_159'")
Conv /up_blocks.0/attentions.1/proj_in/Conv
INFO:tensorflow:Assets written to: /tmp/tmp6g6b51_2/assets
INFO:tensorflow:Assets written to: /tmp/tmp6g6b51_2/assets
2024-07-29 19:41:29.339369: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:29.339425: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:29.339651: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp6g6b51_2
2024-07-29 19:41:29.340904: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:29.340972: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp6g6b51_2
2024-07-29 19:41:29.342475: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:29.351635: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp6g6b51_2
2024-07-29 19:41:29.355632: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 15984 microseconds.
2024-07-29 19:41:29.388895: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 209.961 M  ops, equivalently 104.980 M  MACs
INFO:converter running::tflite model elements' max error is 7.6294E-06, pass, tflite saved in ./tflite/npusubgraph21.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph21.onnx to ./tflite/npusubgraph21.tflite
../Compiler/sg/subgraphs_npu/npusubgraph22.onnx
Checking 0/1...
Conv /up_blocks.0/attentions.1/proj_out/Conv
INFO:tensorflow:Assets written to: /tmp/tmpolj71ic5/assets
INFO:tensorflow:Assets written to: /tmp/tmpolj71ic5/assets
2024-07-29 19:41:29.807970: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:29.808021: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:29.808136: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpolj71ic5
2024-07-29 19:41:29.808452: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:29.808479: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpolj71ic5
2024-07-29 19:41:29.809147: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:29.817147: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpolj71ic5
2024-07-29 19:41:29.820796: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 12660 microseconds.
2024-07-29 19:41:29.847409: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 209.797 M  ops, equivalently 104.899 M  MACs
INFO:converter running::tflite model elements' max error is 7.1526E-06, pass, tflite saved in ./tflite/npusubgraph22.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph22.onnx to ./tflite/npusubgraph22.tflite
../Compiler/sg/subgraphs_npu/npusubgraph23.onnx
Checking 0/1...
Conv /up_blocks.0/upsamplers.0/conv/Conv
INFO:tensorflow:Assets written to: /tmp/tmp1ek8w6cg/assets
INFO:tensorflow:Assets written to: /tmp/tmp1ek8w6cg/assets
2024-07-29 19:41:30.959517: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:30.959566: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:30.959700: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp1ek8w6cg
2024-07-29 19:41:30.959966: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:30.959995: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp1ek8w6cg
2024-07-29 19:41:30.960735: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:30.982812: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp1ek8w6cg
2024-07-29 19:41:30.986033: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 26334 microseconds.
2024-07-29 19:41:31.092586: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 7.550 G  ops, equivalently 3.775 G  MACs
INFO:converter running::tflite model elements' max error is 2.5749E-05, pass, tflite saved in ./tflite/npusubgraph23.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph23.onnx to ./tflite/npusubgraph23.tflite
../Compiler/sg/subgraphs_npu/npusubgraph24.onnx
Checking 0/1...
Reshape /up_blocks.1/resnets.0/norm1/Reshape_1
input_shape: (1, 32, 15360) total_elements: 491520
[   1 1920   16   16] 491520
Final shape: [   1 1920   16   16]
Mul /up_blocks.1/resnets.0/norm1/Mul
Add /up_blocks.1/resnets.0/norm1/Add
(1, 1920, 16, 16)
(1920, 1, 1) 3
(1920, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 1920, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_160/Add:0', description="created by layer 'tf.math.add_160'")
Sigmoid /up_blocks.1/resnets.0/act/Sigmoid
Mul /up_blocks.1/resnets.0/act/Mul
Conv /up_blocks.1/resnets.0/conv1/Conv
INFO:tensorflow:Assets written to: /tmp/tmp6vz0_hgk/assets
INFO:tensorflow:Assets written to: /tmp/tmp6vz0_hgk/assets
2024-07-29 19:41:35.157077: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:35.157121: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:35.157260: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp6vz0_hgk
2024-07-29 19:41:35.157913: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:35.157949: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp6vz0_hgk
2024-07-29 19:41:35.159008: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:35.179213: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp6vz0_hgk
2024-07-29 19:41:35.183464: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 26204 microseconds.
2024-07-29 19:41:35.282129: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 5.695 G  ops, equivalently 2.848 G  MACs
INFO:converter running::tflite model elements' max error is 6.3896E-05, pass, tflite saved in ./tflite/npusubgraph24.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph24.onnx to ./tflite/npusubgraph24.tflite
../Compiler/sg/subgraphs_npu/npusubgraph25.onnx
Checking 0/1...
Reshape /up_blocks.1/resnets.0/norm2/Reshape_1
input_shape: (1, 32, 5120) total_elements: 163840
[  1 640  16  16] 163840
Final shape: [  1 640  16  16]
Mul /up_blocks.1/resnets.0/norm2/Mul
Add /up_blocks.1/resnets.0/norm2/Add
(1, 640, 16, 16)
(640, 1, 1) 3
(640, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 640, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_161/Add:0', description="created by layer 'tf.math.add_161'")
Sigmoid /up_blocks.1/resnets.0/act_1/Sigmoid
Mul /up_blocks.1/resnets.0/act_1/Mul
Conv /up_blocks.1/resnets.0/conv2/Conv
Conv /up_blocks.1/resnets.0/conv_shortcut/Conv
Add /up_blocks.1/resnets.0/Add_1
(1, 16, 16, 640)
(1, 16, 16, 640) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 16, 16, 640), dtype=tf.float32, name=None), name='tf.math.add_162/Add:0', description="created by layer 'tf.math.add_162'")
Reshape /up_blocks.1/attentions.0/norm/Reshape
input_shape: (1, 640, 16, 16) total_elements: 163840
[ 0 32 -1] 32
final_shape: [1, 32, 5120] dynamic_dim_size: 5120
Final shape: [1, 32, 5120]
INFO:tensorflow:Assets written to: /tmp/tmp7yftztup/assets
INFO:tensorflow:Assets written to: /tmp/tmp7yftztup/assets
2024-07-29 19:41:37.774849: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:37.774916: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:37.775100: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp7yftztup
2024-07-29 19:41:37.775874: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:37.775911: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp7yftztup
2024-07-29 19:41:37.777307: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:37.792983: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp7yftztup
2024-07-29 19:41:37.797327: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 22229 microseconds.
2024-07-29 19:41:37.858134: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 2.528 G  ops, equivalently 1.264 G  MACs
ERROR:converter running::tflite model elements' max error has reached 1.0000E+03, but convert is done, please check ./tflite/npusubgraph25.tflite carefully!
Converted ../Compiler/sg/subgraphs_npu/npusubgraph25.onnx to ./tflite/npusubgraph25.tflite
../Compiler/sg/subgraphs_npu/npusubgraph26.onnx
Checking 0/1...
Mul /up_blocks.1/attentions.0/norm/Mul
Add /up_blocks.1/attentions.0/norm/Add
(1, 640, 16, 16)
(640, 1, 1) 3
(640, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 640, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_163/Add:0', description="created by layer 'tf.math.add_163'")
Conv /up_blocks.1/attentions.0/proj_in/Conv
INFO:tensorflow:Assets written to: /tmp/tmp0owrwlg6/assets
INFO:tensorflow:Assets written to: /tmp/tmp0owrwlg6/assets
2024-07-29 19:41:39.281131: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:39.281184: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:39.281310: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp0owrwlg6
2024-07-29 19:41:39.281868: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:39.281903: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp0owrwlg6
2024-07-29 19:41:39.282787: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:39.291394: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp0owrwlg6
2024-07-29 19:41:39.296307: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 14998 microseconds.
2024-07-29 19:41:39.324748: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 210.207 M  ops, equivalently 105.103 M  MACs
INFO:converter running::tflite model elements' max error is 9.5367E-06, pass, tflite saved in ./tflite/npusubgraph26.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph26.onnx to ./tflite/npusubgraph26.tflite
../Compiler/sg/subgraphs_npu/npusubgraph27.onnx
Checking 0/1...
Conv /up_blocks.1/attentions.0/proj_out/Conv
INFO:tensorflow:Assets written to: /tmp/tmp_oo199uk/assets
INFO:tensorflow:Assets written to: /tmp/tmp_oo199uk/assets
2024-07-29 19:41:39.587810: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:39.587869: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:39.588123: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp_oo199uk
2024-07-29 19:41:39.588534: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:39.588568: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp_oo199uk
2024-07-29 19:41:39.589616: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:39.599765: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp_oo199uk
2024-07-29 19:41:39.602833: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 14714 microseconds.
2024-07-29 19:41:39.628373: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 209.879 M  ops, equivalently 104.940 M  MACs
INFO:converter running::tflite model elements' max error is 5.2452E-06, pass, tflite saved in ./tflite/npusubgraph27.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph27.onnx to ./tflite/npusubgraph27.tflite
../Compiler/sg/subgraphs_npu/npusubgraph28.onnx
Checking 0/1...
Reshape /up_blocks.1/resnets.1/norm1/Reshape_1
input_shape: (1, 32, 7680) total_elements: 245760
[  1 960  16  16] 245760
Final shape: [  1 960  16  16]
Mul /up_blocks.1/resnets.1/norm1/Mul
Add /up_blocks.1/resnets.1/norm1/Add
(1, 960, 16, 16)
(960, 1, 1) 3
(960, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 960, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_164/Add:0', description="created by layer 'tf.math.add_164'")
Sigmoid /up_blocks.1/resnets.1/act/Sigmoid
Mul /up_blocks.1/resnets.1/act/Mul
Conv /up_blocks.1/resnets.1/conv1/Conv
INFO:tensorflow:Assets written to: /tmp/tmplv6shiah/assets
INFO:tensorflow:Assets written to: /tmp/tmplv6shiah/assets
2024-07-29 19:41:40.946731: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:40.946781: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:40.946916: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmplv6shiah
2024-07-29 19:41:40.947467: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:40.947497: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmplv6shiah
2024-07-29 19:41:40.948475: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:40.962837: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmplv6shiah
2024-07-29 19:41:40.966515: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 19599 microseconds.
2024-07-29 19:41:41.028891: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 2.848 G  ops, equivalently 1.424 G  MACs
INFO:converter running::tflite model elements' max error is 2.9564E-05, pass, tflite saved in ./tflite/npusubgraph28.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph28.onnx to ./tflite/npusubgraph28.tflite
../Compiler/sg/subgraphs_npu/npusubgraph29.onnx
Checking 0/1...
Reshape /up_blocks.1/resnets.1/norm2/Reshape_1
input_shape: (1, 32, 5120) total_elements: 163840
[  1 640  16  16] 163840
Final shape: [  1 640  16  16]
Mul /up_blocks.1/resnets.1/norm2/Mul
Add /up_blocks.1/resnets.1/norm2/Add
(1, 640, 16, 16)
(640, 1, 1) 3
(640, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 640, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_165/Add:0', description="created by layer 'tf.math.add_165'")
Sigmoid /up_blocks.1/resnets.1/act_1/Sigmoid
Mul /up_blocks.1/resnets.1/act_1/Mul
Conv /up_blocks.1/resnets.1/conv2/Conv
Conv /up_blocks.1/resnets.1/conv_shortcut/Conv
Add /up_blocks.1/resnets.1/Add_1
(1, 16, 16, 640)
(1, 16, 16, 640) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 16, 16, 640), dtype=tf.float32, name=None), name='tf.math.add_166/Add:0', description="created by layer 'tf.math.add_166'")
Reshape /up_blocks.1/attentions.1/norm/Reshape
input_shape: (1, 640, 16, 16) total_elements: 163840
[ 0 32 -1] 32
final_shape: [1, 32, 5120] dynamic_dim_size: 5120
Final shape: [1, 32, 5120]
INFO:tensorflow:Assets written to: /tmp/tmpvxqr2chz/assets
INFO:tensorflow:Assets written to: /tmp/tmpvxqr2chz/assets
2024-07-29 19:41:42.849515: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:42.849563: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:42.849786: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpvxqr2chz
2024-07-29 19:41:42.850716: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:42.850759: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpvxqr2chz
2024-07-29 19:41:42.852737: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:42.867495: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpvxqr2chz
2024-07-29 19:41:42.872685: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 22902 microseconds.
2024-07-29 19:41:42.930505: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 2.213 G  ops, equivalently 1.107 G  MACs
INFO:converter running::tflite model elements' max error is 1.2636E-05, pass, tflite saved in ./tflite/npusubgraph29.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph29.onnx to ./tflite/npusubgraph29.tflite
../Compiler/sg/subgraphs_npu/npusubgraph3.onnx
Checking 0/1...
Mul /down_blocks.0/attentions.0/norm/Mul
Add /down_blocks.0/attentions.0/norm/Add
(1, 320, 32, 32)
(320, 1, 1) 3
(320, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_167/Add:0', description="created by layer 'tf.math.add_167'")
Conv /down_blocks.0/attentions.0/proj_in/Conv
INFO:tensorflow:Assets written to: /tmp/tmpr6_wxkkq/assets
INFO:tensorflow:Assets written to: /tmp/tmpr6_wxkkq/assets
2024-07-29 19:41:44.622210: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:44.622259: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:44.622400: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpr6_wxkkq
2024-07-29 19:41:44.623007: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:44.623039: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpr6_wxkkq
2024-07-29 19:41:44.624099: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:44.631659: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpr6_wxkkq
2024-07-29 19:41:44.634986: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 12586 microseconds.
2024-07-29 19:41:44.663584: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 210.698 M  ops, equivalently 105.349 M  MACs
INFO:converter running::tflite model elements' max error is 4.7684E-07, pass, tflite saved in ./tflite/npusubgraph3.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph3.onnx to ./tflite/npusubgraph3.tflite
../Compiler/sg/subgraphs_npu/npusubgraph30.onnx
Checking 0/1...
Mul /up_blocks.1/attentions.1/norm/Mul
Add /up_blocks.1/attentions.1/norm/Add
(1, 640, 16, 16)
(640, 1, 1) 3
(640, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 640, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_168/Add:0', description="created by layer 'tf.math.add_168'")
Conv /up_blocks.1/attentions.1/proj_in/Conv
INFO:tensorflow:Assets written to: /tmp/tmpb5cqwaj0/assets
INFO:tensorflow:Assets written to: /tmp/tmpb5cqwaj0/assets
2024-07-29 19:41:45.442174: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:45.442227: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:45.442389: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpb5cqwaj0
2024-07-29 19:41:45.443134: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:45.443177: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpb5cqwaj0
2024-07-29 19:41:45.444339: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:45.452156: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpb5cqwaj0
2024-07-29 19:41:45.456794: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 14407 microseconds.
2024-07-29 19:41:45.483622: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 210.207 M  ops, equivalently 105.103 M  MACs
INFO:converter running::tflite model elements' max error is 2.0266E-06, pass, tflite saved in ./tflite/npusubgraph30.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph30.onnx to ./tflite/npusubgraph30.tflite
../Compiler/sg/subgraphs_npu/npusubgraph31.onnx
Checking 0/1...
Conv /up_blocks.1/attentions.1/proj_out/Conv
INFO:tensorflow:Assets written to: /tmp/tmp9ltdc2jl/assets
INFO:tensorflow:Assets written to: /tmp/tmp9ltdc2jl/assets
2024-07-29 19:41:45.712570: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:45.712617: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:45.712755: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp9ltdc2jl
2024-07-29 19:41:45.713185: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:45.713215: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp9ltdc2jl
2024-07-29 19:41:45.714171: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:45.722482: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp9ltdc2jl
2024-07-29 19:41:45.726328: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 13574 microseconds.
2024-07-29 19:41:45.748595: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 209.879 M  ops, equivalently 104.940 M  MACs
INFO:converter running::tflite model elements' max error is 3.5763E-06, pass, tflite saved in ./tflite/npusubgraph31.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph31.onnx to ./tflite/npusubgraph31.tflite
../Compiler/sg/subgraphs_npu/npusubgraph32.onnx
Checking 0/1...
Conv /up_blocks.1/upsamplers.0/conv/Conv
INFO:tensorflow:Assets written to: /tmp/tmpjenc0nfz/assets
INFO:tensorflow:Assets written to: /tmp/tmpjenc0nfz/assets
2024-07-29 19:41:46.171832: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:46.171889: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:46.172037: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpjenc0nfz
2024-07-29 19:41:46.172393: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:46.172537: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpjenc0nfz
2024-07-29 19:41:46.173430: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:46.183685: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpjenc0nfz
2024-07-29 19:41:46.186936: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 14899 microseconds.
2024-07-29 19:41:46.226652: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 7.550 G  ops, equivalently 3.775 G  MACs
INFO:converter running::tflite model elements' max error is 1.6689E-05, pass, tflite saved in ./tflite/npusubgraph32.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph32.onnx to ./tflite/npusubgraph32.tflite
../Compiler/sg/subgraphs_npu/npusubgraph33.onnx
Checking 0/1...
Reshape /up_blocks.2/resnets.0/norm1/Reshape_1
input_shape: (1, 32, 30720) total_elements: 983040
[  1 960  32  32] 983040
Final shape: [  1 960  32  32]
Mul /up_blocks.2/resnets.0/norm1/Mul
Add /up_blocks.2/resnets.0/norm1/Add
(1, 960, 32, 32)
(960, 1, 1) 3
(960, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 960, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_169/Add:0', description="created by layer 'tf.math.add_169'")
Sigmoid /up_blocks.2/resnets.0/act/Sigmoid
Mul /up_blocks.2/resnets.0/act/Mul
Conv /up_blocks.2/resnets.0/conv1/Conv
INFO:tensorflow:Assets written to: /tmp/tmpls_penve/assets
INFO:tensorflow:Assets written to: /tmp/tmpls_penve/assets
2024-07-29 19:41:49.788834: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:49.788891: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:49.789013: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpls_penve
2024-07-29 19:41:49.789940: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:49.789979: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpls_penve
2024-07-29 19:41:49.791411: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:49.801741: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpls_penve
2024-07-29 19:41:49.806408: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 17396 microseconds.
2024-07-29 19:41:49.843978: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 5.729 G  ops, equivalently 2.864 G  MACs
INFO:converter running::tflite model elements' max error is 3.3379E-05, pass, tflite saved in ./tflite/npusubgraph33.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph33.onnx to ./tflite/npusubgraph33.tflite
../Compiler/sg/subgraphs_npu/npusubgraph34.onnx
Checking 0/1...
Reshape /up_blocks.2/resnets.0/norm2/Reshape_1
input_shape: (1, 32, 10240) total_elements: 327680
[  1 320  32  32] 327680
Final shape: [  1 320  32  32]
Mul /up_blocks.2/resnets.0/norm2/Mul
Add /up_blocks.2/resnets.0/norm2/Add
(1, 320, 32, 32)
(320, 1, 1) 3
(320, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_170/Add:0', description="created by layer 'tf.math.add_170'")
Sigmoid /up_blocks.2/resnets.0/act_1/Sigmoid
Mul /up_blocks.2/resnets.0/act_1/Mul
Conv /up_blocks.2/resnets.0/conv2/Conv
Conv /up_blocks.2/resnets.0/conv_shortcut/Conv
Add /up_blocks.2/resnets.0/Add_1
(1, 32, 32, 320)
(1, 32, 32, 320) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 32, 32, 320), dtype=tf.float32, name=None), name='tf.math.add_171/Add:0', description="created by layer 'tf.math.add_171'")
Reshape /up_blocks.2/attentions.0/norm/Reshape
input_shape: (1, 320, 32, 32) total_elements: 327680
[ 0 32 -1] 32
final_shape: [1, 32, 10240] dynamic_dim_size: 10240
Final shape: [1, 32, 10240]
INFO:tensorflow:Assets written to: /tmp/tmpi9n7qwkc/assets
INFO:tensorflow:Assets written to: /tmp/tmpi9n7qwkc/assets
2024-07-29 19:41:51.563423: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:51.563478: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:51.563621: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpi9n7qwkc
2024-07-29 19:41:51.564499: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:51.564535: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpi9n7qwkc
2024-07-29 19:41:51.566433: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:51.578290: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpi9n7qwkc
2024-07-29 19:41:51.582911: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 19290 microseconds.
2024-07-29 19:41:51.616340: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 2.540 G  ops, equivalently 1.270 G  MACs
ERROR:converter running::tflite model elements' max error has reached 1.0000E+03, but convert is done, please check ./tflite/npusubgraph34.tflite carefully!
Converted ../Compiler/sg/subgraphs_npu/npusubgraph34.onnx to ./tflite/npusubgraph34.tflite
../Compiler/sg/subgraphs_npu/npusubgraph35.onnx
Checking 0/1...
Mul /up_blocks.2/attentions.0/norm/Mul
Add /up_blocks.2/attentions.0/norm/Add
(1, 320, 32, 32)
(320, 1, 1) 3
(320, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_172/Add:0', description="created by layer 'tf.math.add_172'")
Conv /up_blocks.2/attentions.0/proj_in/Conv
INFO:tensorflow:Assets written to: /tmp/tmplconev5a/assets
INFO:tensorflow:Assets written to: /tmp/tmplconev5a/assets
2024-07-29 19:41:52.858590: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:52.858644: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:52.858786: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmplconev5a
2024-07-29 19:41:52.859406: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:52.859443: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmplconev5a
2024-07-29 19:41:52.860451: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:52.868264: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmplconev5a
2024-07-29 19:41:52.872464: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 13680 microseconds.
2024-07-29 19:41:52.896948: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 210.698 M  ops, equivalently 105.349 M  MACs
INFO:converter running::tflite model elements' max error is 1.9073E-06, pass, tflite saved in ./tflite/npusubgraph35.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph35.onnx to ./tflite/npusubgraph35.tflite
../Compiler/sg/subgraphs_npu/npusubgraph36.onnx
Checking 0/1...
Conv /up_blocks.2/attentions.0/proj_out/Conv
INFO:tensorflow:Assets written to: /tmp/tmp0wgysu_b/assets
INFO:tensorflow:Assets written to: /tmp/tmp0wgysu_b/assets
2024-07-29 19:41:53.120412: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:53.120465: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:53.120667: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmp0wgysu_b
2024-07-29 19:41:53.121110: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:53.121145: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmp0wgysu_b
2024-07-29 19:41:53.121927: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:53.128467: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmp0wgysu_b
2024-07-29 19:41:53.131252: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 10590 microseconds.
2024-07-29 19:41:53.150750: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 210.043 M  ops, equivalently 105.021 M  MACs
INFO:converter running::tflite model elements' max error is 2.6226E-06, pass, tflite saved in ./tflite/npusubgraph36.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph36.onnx to ./tflite/npusubgraph36.tflite
../Compiler/sg/subgraphs_npu/npusubgraph37.onnx
Checking 0/1...
Reshape /up_blocks.2/resnets.1/norm1/Reshape_1
input_shape: (1, 32, 20480) total_elements: 655360
[  1 640  32  32] 655360
Final shape: [  1 640  32  32]
Mul /up_blocks.2/resnets.1/norm1/Mul
Add /up_blocks.2/resnets.1/norm1/Add
(1, 640, 32, 32)
(640, 1, 1) 3
(640, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 640, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_173/Add:0', description="created by layer 'tf.math.add_173'")
Sigmoid /up_blocks.2/resnets.1/act/Sigmoid
Mul /up_blocks.2/resnets.1/act/Mul
Conv /up_blocks.2/resnets.1/conv1/Conv
INFO:tensorflow:Assets written to: /tmp/tmpm96x0yag/assets
INFO:tensorflow:Assets written to: /tmp/tmpm96x0yag/assets
2024-07-29 19:41:55.296518: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:55.296570: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:55.296689: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpm96x0yag
2024-07-29 19:41:55.297630: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:55.297665: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpm96x0yag
2024-07-29 19:41:55.298795: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:55.310534: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpm96x0yag
2024-07-29 19:41:55.314150: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 17461 microseconds.
2024-07-29 19:41:55.354790: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 3.819 G  ops, equivalently 1.910 G  MACs
INFO:converter running::tflite model elements' max error is 4.5300E-06, pass, tflite saved in ./tflite/npusubgraph37.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph37.onnx to ./tflite/npusubgraph37.tflite
../Compiler/sg/subgraphs_npu/npusubgraph38.onnx
Checking 0/1...
Reshape /up_blocks.2/resnets.1/norm2/Reshape_1
input_shape: (1, 32, 10240) total_elements: 327680
[  1 320  32  32] 327680
Final shape: [  1 320  32  32]
Mul /up_blocks.2/resnets.1/norm2/Mul
Add /up_blocks.2/resnets.1/norm2/Add
(1, 320, 32, 32)
(320, 1, 1) 3
(320, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_174/Add:0', description="created by layer 'tf.math.add_174'")
Sigmoid /up_blocks.2/resnets.1/act_1/Sigmoid
Mul /up_blocks.2/resnets.1/act_1/Mul
Conv /up_blocks.2/resnets.1/conv2/Conv
Conv /up_blocks.2/resnets.1/conv_shortcut/Conv
Add /up_blocks.2/resnets.1/Add_1
(1, 32, 32, 320)
(1, 32, 32, 320) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 32, 32, 320), dtype=tf.float32, name=None), name='tf.math.add_175/Add:0', description="created by layer 'tf.math.add_175'")
Reshape /up_blocks.2/attentions.1/norm/Reshape
input_shape: (1, 320, 32, 32) total_elements: 327680
[ 0 32 -1] 32
final_shape: [1, 32, 10240] dynamic_dim_size: 10240
Final shape: [1, 32, 10240]
INFO:tensorflow:Assets written to: /tmp/tmpcwdp3fzj/assets
INFO:tensorflow:Assets written to: /tmp/tmpcwdp3fzj/assets
2024-07-29 19:41:56.987987: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:56.988035: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:56.988185: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpcwdp3fzj
2024-07-29 19:41:56.989012: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:56.989050: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpcwdp3fzj
2024-07-29 19:41:56.990525: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:57.001599: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpcwdp3fzj
2024-07-29 19:41:57.006083: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 17899 microseconds.
2024-07-29 19:41:57.049371: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 2.330 G  ops, equivalently 1.165 G  MACs
ERROR:converter running::tflite model elements' max error has reached 1.0000E+03, but convert is done, please check ./tflite/npusubgraph38.tflite carefully!
Converted ../Compiler/sg/subgraphs_npu/npusubgraph38.onnx to ./tflite/npusubgraph38.tflite
../Compiler/sg/subgraphs_npu/npusubgraph39.onnx
Checking 0/1...
Mul /up_blocks.2/attentions.1/norm/Mul
Add /up_blocks.2/attentions.1/norm/Add
(1, 320, 32, 32)
(320, 1, 1) 3
(320, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 32, 32), dtype=tf.float32, name=None), name='tf.math.add_176/Add:0', description="created by layer 'tf.math.add_176'")
Conv /up_blocks.2/attentions.1/proj_in/Conv
INFO:tensorflow:Assets written to: /tmp/tmpsyys4nm2/assets
INFO:tensorflow:Assets written to: /tmp/tmpsyys4nm2/assets
2024-07-29 19:41:58.333879: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:58.333940: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:58.334077: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpsyys4nm2
2024-07-29 19:41:58.334617: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:58.334654: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpsyys4nm2
2024-07-29 19:41:58.335668: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:58.343986: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpsyys4nm2
2024-07-29 19:41:58.347734: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 13657 microseconds.
2024-07-29 19:41:58.371547: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 210.698 M  ops, equivalently 105.349 M  MACs
INFO:converter running::tflite model elements' max error is 1.0729E-06, pass, tflite saved in ./tflite/npusubgraph39.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph39.onnx to ./tflite/npusubgraph39.tflite
../Compiler/sg/subgraphs_npu/npusubgraph4.onnx
Checking 0/1...
Conv /down_blocks.0/attentions.0/proj_out/Conv
INFO:tensorflow:Assets written to: /tmp/tmpfwixww4y/assets
INFO:tensorflow:Assets written to: /tmp/tmpfwixww4y/assets
2024-07-29 19:41:58.603297: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:58.603349: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:58.603491: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpfwixww4y
2024-07-29 19:41:58.604033: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:58.604075: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpfwixww4y
2024-07-29 19:41:58.605008: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:58.612611: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpfwixww4y
2024-07-29 19:41:58.615723: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 12233 microseconds.
2024-07-29 19:41:58.635806: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 210.043 M  ops, equivalently 105.021 M  MACs
INFO:converter running::tflite model elements' max error is 1.9073E-06, pass, tflite saved in ./tflite/npusubgraph4.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph4.onnx to ./tflite/npusubgraph4.tflite
../Compiler/sg/subgraphs_npu/npusubgraph40.onnx
Checking 0/1...
Conv /up_blocks.2/attentions.1/proj_out/Conv
INFO:tensorflow:Assets written to: /tmp/tmpqheeynre/assets
INFO:tensorflow:Assets written to: /tmp/tmpqheeynre/assets
2024-07-29 19:41:58.819831: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:58.819889: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:58.820061: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpqheeynre
2024-07-29 19:41:58.820406: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:58.820444: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpqheeynre
2024-07-29 19:41:58.821270: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:58.828831: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpqheeynre
2024-07-29 19:41:58.831733: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 11674 microseconds.
2024-07-29 19:41:58.851143: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 210.043 M  ops, equivalently 105.021 M  MACs
INFO:converter running::tflite model elements' max error is 7.6294E-06, pass, tflite saved in ./tflite/npusubgraph40.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph40.onnx to ./tflite/npusubgraph40.tflite
../Compiler/sg/subgraphs_npu/npusubgraph5.onnx
Checking 0/1...
Conv /down_blocks.0/downsamplers.0/conv/Conv
Reshape /down_blocks.1/resnets.0/norm1/Reshape
input_shape: (1, 320, 16, 16) total_elements: 81920
[ 0 32 -1] 32
final_shape: [1, 32, 2560] dynamic_dim_size: 2560
Final shape: [1, 32, 2560]
INFO:tensorflow:Assets written to: /tmp/tmpyi9yfgb9/assets
INFO:tensorflow:Assets written to: /tmp/tmpyi9yfgb9/assets
2024-07-29 19:41:59.139057: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:59.139105: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:59.139260: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpyi9yfgb9
2024-07-29 19:41:59.139746: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:59.139790: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpyi9yfgb9
2024-07-29 19:41:59.140782: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:59.148429: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpyi9yfgb9
2024-07-29 19:41:59.151924: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 12666 microseconds.
2024-07-29 19:41:59.182149: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 471.941 M  ops, equivalently 235.971 M  MACs
INFO:converter running::tflite model elements' max error is 1.2875E-05, pass, tflite saved in ./tflite/npusubgraph5.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph5.onnx to ./tflite/npusubgraph5.tflite
../Compiler/sg/subgraphs_npu/npusubgraph6.onnx
Checking 0/1...
Reshape /down_blocks.1/resnets.0/norm1/Reshape_1
input_shape: (1, 32, 2560) total_elements: 81920
[  1 320  16  16] 81920
Final shape: [  1 320  16  16]
Mul /down_blocks.1/resnets.0/norm1/Mul
Add /down_blocks.1/resnets.0/norm1/Add
(1, 320, 16, 16)
(320, 1, 1) 3
(320, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 320, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_177/Add:0', description="created by layer 'tf.math.add_177'")
Sigmoid /down_blocks.1/resnets.0/act/Sigmoid
Mul /down_blocks.1/resnets.0/act/Mul
Conv /down_blocks.1/resnets.0/conv1/Conv
INFO:tensorflow:Assets written to: /tmp/tmpvdn7yxhe/assets
INFO:tensorflow:Assets written to: /tmp/tmpvdn7yxhe/assets
2024-07-29 19:41:59.818971: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:41:59.819017: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:41:59.819132: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpvdn7yxhe
2024-07-29 19:41:59.819657: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:41:59.819694: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpvdn7yxhe
2024-07-29 19:41:59.820846: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:41:59.829892: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpvdn7yxhe
2024-07-29 19:41:59.833011: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 13880 microseconds.
2024-07-29 19:41:59.865783: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 949.371 M  ops, equivalently 474.685 M  MACs
INFO:converter running::tflite model elements' max error is 5.9128E-05, pass, tflite saved in ./tflite/npusubgraph6.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph6.onnx to ./tflite/npusubgraph6.tflite
../Compiler/sg/subgraphs_npu/npusubgraph7.onnx
Checking 0/1...
Reshape /down_blocks.1/resnets.0/norm2/Reshape_1
input_shape: (1, 32, 5120) total_elements: 163840
[  1 640  16  16] 163840
Final shape: [  1 640  16  16]
Mul /down_blocks.1/resnets.0/norm2/Mul
Add /down_blocks.1/resnets.0/norm2/Add
(1, 640, 16, 16)
(640, 1, 1) 3
(640, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 640, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_178/Add:0', description="created by layer 'tf.math.add_178'")
Sigmoid /down_blocks.1/resnets.0/act_1/Sigmoid
Mul /down_blocks.1/resnets.0/act_1/Mul
Conv /down_blocks.1/resnets.0/conv2/Conv
Conv /down_blocks.1/resnets.0/conv_shortcut/Conv
Add /down_blocks.1/resnets.0/Add_1
(1, 16, 16, 640)
(1, 16, 16, 640) 4
KerasTensor(type_spec=TensorSpec(shape=(1, 16, 16, 640), dtype=tf.float32, name=None), name='tf.math.add_179/Add:0', description="created by layer 'tf.math.add_179'")
Reshape /down_blocks.1/attentions.0/norm/Reshape
input_shape: (1, 640, 16, 16) total_elements: 163840
[ 0 32 -1] 32
final_shape: [1, 32, 5120] dynamic_dim_size: 5120
Final shape: [1, 32, 5120]
INFO:tensorflow:Assets written to: /tmp/tmpfcfem_0a/assets
INFO:tensorflow:Assets written to: /tmp/tmpfcfem_0a/assets
2024-07-29 19:42:01.104419: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:42:01.104477: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:42:01.104612: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpfcfem_0a
2024-07-29 19:42:01.105185: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:42:01.105241: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpfcfem_0a
2024-07-29 19:42:01.106789: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:42:01.121930: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpfcfem_0a
2024-07-29 19:42:01.126291: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 21679 microseconds.
2024-07-29 19:42:01.174576: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 2.004 G  ops, equivalently 1.002 G  MACs
ERROR:converter running::tflite model elements' max error has reached 1.0000E+03, but convert is done, please check ./tflite/npusubgraph7.tflite carefully!
Converted ../Compiler/sg/subgraphs_npu/npusubgraph7.onnx to ./tflite/npusubgraph7.tflite
../Compiler/sg/subgraphs_npu/npusubgraph8.onnx
Checking 0/1...
Mul /down_blocks.1/attentions.0/norm/Mul
Add /down_blocks.1/attentions.0/norm/Add
(1, 640, 16, 16)
(640, 1, 1) 3
(640, 1, 1)
KerasTensor(type_spec=TensorSpec(shape=(1, 640, 16, 16), dtype=tf.float32, name=None), name='tf.math.add_180/Add:0', description="created by layer 'tf.math.add_180'")
Conv /down_blocks.1/attentions.0/proj_in/Conv
INFO:tensorflow:Assets written to: /tmp/tmpvb_pzqxf/assets
INFO:tensorflow:Assets written to: /tmp/tmpvb_pzqxf/assets
2024-07-29 19:42:02.385235: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:42:02.385282: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:42:02.385426: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpvb_pzqxf
2024-07-29 19:42:02.386075: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:42:02.386108: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpvb_pzqxf
2024-07-29 19:42:02.387271: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:42:02.394783: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpvb_pzqxf
2024-07-29 19:42:02.398083: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 12657 microseconds.
2024-07-29 19:42:02.423236: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 210.207 M  ops, equivalently 105.103 M  MACs
INFO:converter running::tflite model elements' max error is 2.1458E-06, pass, tflite saved in ./tflite/npusubgraph8.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph8.onnx to ./tflite/npusubgraph8.tflite
../Compiler/sg/subgraphs_npu/npusubgraph9.onnx
Checking 0/1...
Conv /down_blocks.1/attentions.0/proj_out/Conv
INFO:tensorflow:Assets written to: /tmp/tmpa49j4lt3/assets
INFO:tensorflow:Assets written to: /tmp/tmpa49j4lt3/assets
2024-07-29 19:42:02.668798: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:364] Ignored output_format.
2024-07-29 19:42:02.668859: W tensorflow/compiler/mlir/lite/python/tf_tfl_flatbuffer_helpers.cc:367] Ignored drop_control_dependency.
2024-07-29 19:42:02.668987: I tensorflow/cc/saved_model/reader.cc:45] Reading SavedModel from: /tmp/tmpa49j4lt3
2024-07-29 19:42:02.669480: I tensorflow/cc/saved_model/reader.cc:91] Reading meta graph with tags { serve }
2024-07-29 19:42:02.669514: I tensorflow/cc/saved_model/reader.cc:132] Reading SavedModel debug info (if present) from: /tmp/tmpa49j4lt3
2024-07-29 19:42:02.670495: I tensorflow/cc/saved_model/loader.cc:231] Restoring SavedModel bundle.
2024-07-29 19:42:02.677586: I tensorflow/cc/saved_model/loader.cc:215] Running initialization op on SavedModel bundle at path: /tmp/tmpa49j4lt3
2024-07-29 19:42:02.680518: I tensorflow/cc/saved_model/loader.cc:314] SavedModel load for tags { serve }; Status: success: OK. Took 11531 microseconds.
2024-07-29 19:42:02.703926: I tensorflow/compiler/mlir/lite/flatbuffer_export.cc:2138] Estimated count of arithmetic ops: 209.879 M  ops, equivalently 104.940 M  MACs
INFO:converter running::tflite model elements' max error is 2.8610E-06, pass, tflite saved in ./tflite/npusubgraph9.tflite
Converted ../Compiler/sg/subgraphs_npu/npusubgraph9.onnx to ./tflite/npusubgraph9.tflite